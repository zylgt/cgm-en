{"ast":null,"code":"import { formatDate } from '@/utils/formatTime';\nimport { TIRUtils } from \"@/utils/algorithm/TIR\";\n// 监听主线程传来的消息\nself.addEventListener('message', e => {\n  // heavyCalculation(e.data)\n  self.postMessage(heavyCalculation(e.data));\n});\n// 处理数据\nfunction heavyCalculation(data) {\n  let array = data;\n  // 将数组按天分割\n  let dayMap = new Map();\n  array.forEach((item, index) => {\n    if (index <= 14) {\n      item.day = formatDate(item.DataTs * 1000, 'mm.dd');\n      item.week = formatDate(item.DataTs * 1000, 'WW');\n      item.moment = Number(formatDate(item.DataTs * 1000, 'HH')) * 60 + Number(formatDate(item.DataTs * 1000, 'MM'));\n      item.dayArray = new Array(24 * 60);\n      item.dayArray[item.moment] = item.Value;\n      dayMap.has(item.day) ? dayMap.get(item.day).value[item.moment] = item.Value : dayMap.set(item.day, {\n        value: item.dayArray,\n        week: item.week,\n        tir: TIRUtils.getTIRResult(item.dayArray) ? TIRUtils.getTIRResult(item.dayArray).normalRate : 0\n      });\n    }\n  });\n  return dayMap;\n}","map":{"version":3,"names":["formatDate","TIRUtils","self","addEventListener","e","postMessage","heavyCalculation","data","array","dayMap","Map","forEach","item","index","day","DataTs","week","moment","Number","dayArray","Array","Value","has","get","value","set","tir","getTIRResult","normalRate"],"sources":["/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/src/workers/day_worker.js"],"sourcesContent":["import {formatDate} from '@/utils/formatTime'\nimport { TIRUtils } from \"@/utils/algorithm/TIR\";\n// 监听主线程传来的消息\nself.addEventListener('message',(e)=>{\n    // heavyCalculation(e.data)\n    self.postMessage(heavyCalculation(e.data))\n})\n// 处理数据\nfunction heavyCalculation(data){\n    let array = data\n     // 将数组按天分割\n     let dayMap = new Map()\n     array.forEach((item,index)=>{\n        if(index<=14){\n            item.day = formatDate(item.DataTs*1000,'mm.dd')\n            item.week = formatDate(item.DataTs*1000,'WW')\n            item.moment = Number(formatDate(item.DataTs*1000,'HH'))*60+Number(formatDate(item.DataTs*1000,'MM'))\n            item.dayArray = new Array(24*60)\n            item.dayArray[item.moment] = item.Value\n            dayMap.has(item.day) ? dayMap.get(item.day).value[item.moment]=item.Value: dayMap.set(item.day, {value:item.dayArray,week:item.week,tir:TIRUtils.getTIRResult(item.dayArray)?TIRUtils.getTIRResult(item.dayArray).normalRate:0});\n        }\n    })\n    return dayMap\n}"],"mappings":"AAAA,SAAQA,UAAU,QAAO,oBAAoB;AAC7C,SAASC,QAAQ,QAAQ,uBAAuB;AAChD;AACAC,IAAI,CAACC,gBAAgB,CAAC,SAAS,EAAEC,CAAC,IAAG;EACjC;EACAF,IAAI,CAACG,WAAW,CAACC,gBAAgB,CAACF,CAAC,CAACG,IAAI,CAAC,CAAC;AAC9C,CAAC,CAAC;AACF;AACA,SAASD,gBAAgBA,CAACC,IAAI,EAAC;EAC3B,IAAIC,KAAK,GAAGD,IAAI;EACf;EACA,IAAIE,MAAM,GAAG,IAAIC,GAAG,CAAC,CAAC;EACtBF,KAAK,CAACG,OAAO,CAAC,CAACC,IAAI,EAACC,KAAK,KAAG;IACzB,IAAGA,KAAK,IAAE,EAAE,EAAC;MACTD,IAAI,CAACE,GAAG,GAAGd,UAAU,CAACY,IAAI,CAACG,MAAM,GAAC,IAAI,EAAC,OAAO,CAAC;MAC/CH,IAAI,CAACI,IAAI,GAAGhB,UAAU,CAACY,IAAI,CAACG,MAAM,GAAC,IAAI,EAAC,IAAI,CAAC;MAC7CH,IAAI,CAACK,MAAM,GAAGC,MAAM,CAAClB,UAAU,CAACY,IAAI,CAACG,MAAM,GAAC,IAAI,EAAC,IAAI,CAAC,CAAC,GAAC,EAAE,GAACG,MAAM,CAAClB,UAAU,CAACY,IAAI,CAACG,MAAM,GAAC,IAAI,EAAC,IAAI,CAAC,CAAC;MACpGH,IAAI,CAACO,QAAQ,GAAG,IAAIC,KAAK,CAAC,EAAE,GAAC,EAAE,CAAC;MAChCR,IAAI,CAACO,QAAQ,CAACP,IAAI,CAACK,MAAM,CAAC,GAAGL,IAAI,CAACS,KAAK;MACvCZ,MAAM,CAACa,GAAG,CAACV,IAAI,CAACE,GAAG,CAAC,GAAGL,MAAM,CAACc,GAAG,CAACX,IAAI,CAACE,GAAG,CAAC,CAACU,KAAK,CAACZ,IAAI,CAACK,MAAM,CAAC,GAACL,IAAI,CAACS,KAAK,GAAEZ,MAAM,CAACgB,GAAG,CAACb,IAAI,CAACE,GAAG,EAAE;QAACU,KAAK,EAACZ,IAAI,CAACO,QAAQ;QAACH,IAAI,EAACJ,IAAI,CAACI,IAAI;QAACU,GAAG,EAACzB,QAAQ,CAAC0B,YAAY,CAACf,IAAI,CAACO,QAAQ,CAAC,GAAClB,QAAQ,CAAC0B,YAAY,CAACf,IAAI,CAACO,QAAQ,CAAC,CAACS,UAAU,GAAC;MAAC,CAAC,CAAC;IACpO;EACJ,CAAC,CAAC;EACF,OAAOnB,MAAM;AACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}