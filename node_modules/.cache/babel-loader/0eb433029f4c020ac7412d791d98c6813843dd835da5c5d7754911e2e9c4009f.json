{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getConfiguration = void 0;\nconst os_1 = require(\"os\");\nconst path_1 = require(\"path\");\nconst cosmiconfig_1 = require(\"cosmiconfig\");\nfunction getBooleanEnvVar(name) {\n  const env = process.env[name];\n  if (env === undefined) {\n    return;\n  }\n  switch (env.toLowerCase()) {\n    case '':\n    case '0':\n    case 'false':\n    case 'off':\n      return false;\n    default:\n      return true;\n  }\n}\n/**\n * @internal\n */\nfunction isSupportedProduct(product) {\n  switch (product) {\n    case 'chrome':\n    case 'firefox':\n      return true;\n    default:\n      return false;\n  }\n}\n/**\n * @internal\n */\nconst getConfiguration = () => {\n  const result = (0, cosmiconfig_1.cosmiconfigSync)('puppeteer', {\n    searchStrategy: 'global'\n  }).search();\n  const configuration = result ? result.config : {};\n  configuration.logLevel = process.env['PUPPETEER_LOGLEVEL'] ?? process.env['npm_config_LOGLEVEL'] ?? process.env['npm_package_config_LOGLEVEL'] ?? configuration.logLevel ?? 'warn';\n  // Merging environment variables.\n  configuration.defaultProduct = process.env['PUPPETEER_PRODUCT'] ?? process.env['npm_config_puppeteer_product'] ?? process.env['npm_package_config_puppeteer_product'] ?? configuration.defaultProduct ?? 'chrome';\n  configuration.executablePath = process.env['PUPPETEER_EXECUTABLE_PATH'] ?? process.env['npm_config_puppeteer_executable_path'] ?? process.env['npm_package_config_puppeteer_executable_path'] ?? configuration.executablePath;\n  // Default to skipDownload if executablePath is set\n  if (configuration.executablePath) {\n    configuration.skipDownload = true;\n  }\n  // Set skipDownload explicitly or from default\n  configuration.skipDownload = Boolean(getBooleanEnvVar('PUPPETEER_SKIP_DOWNLOAD') ?? getBooleanEnvVar('npm_config_puppeteer_skip_download') ?? getBooleanEnvVar('npm_package_config_puppeteer_skip_download') ?? configuration.skipDownload);\n  // Set skipChromeDownload explicitly or from default\n  configuration.skipChromeDownload = Boolean(getBooleanEnvVar('PUPPETEER_SKIP_CHROME_DOWNLOAD') ?? getBooleanEnvVar('npm_config_puppeteer_skip_chrome_download') ?? getBooleanEnvVar('npm_package_config_puppeteer_skip_chrome_download') ?? configuration.skipChromeDownload);\n  // Set skipChromeDownload explicitly or from default\n  configuration.skipChromeHeadlessShellDownload = Boolean(getBooleanEnvVar('PUPPETEER_SKIP_CHROME_HEADLESS_SHELL_DOWNLOAD') ?? getBooleanEnvVar('npm_config_puppeteer_skip_chrome_headless_shell_download') ?? getBooleanEnvVar('npm_package_config_puppeteer_skip_chrome_headless_shell_download') ?? configuration.skipChromeHeadlessShellDownload);\n  // Prepare variables used in browser downloading\n  if (!configuration.skipDownload) {\n    configuration.browserRevision = process.env['PUPPETEER_BROWSER_REVISION'] ?? process.env['npm_config_puppeteer_browser_revision'] ?? process.env['npm_package_config_puppeteer_browser_revision'] ?? configuration.browserRevision;\n    const downloadHost = process.env['PUPPETEER_DOWNLOAD_HOST'] ?? process.env['npm_config_puppeteer_download_host'] ?? process.env['npm_package_config_puppeteer_download_host'];\n    if (downloadHost && configuration.logLevel === 'warn') {\n      console.warn(`PUPPETEER_DOWNLOAD_HOST is deprecated. Use PUPPETEER_DOWNLOAD_BASE_URL instead.`);\n    }\n    configuration.downloadBaseUrl = process.env['PUPPETEER_DOWNLOAD_BASE_URL'] ?? process.env['npm_config_puppeteer_download_base_url'] ?? process.env['npm_package_config_puppeteer_download_base_url'] ?? configuration.downloadBaseUrl ?? downloadHost;\n  }\n  if (Object.keys(process.env).some(key => {\n    return key.startsWith('npm_package_config_puppeteer_');\n  }) && configuration.logLevel === 'warn') {\n    console.warn(`Configuring Puppeteer via npm/package.json is deprecated. Use https://pptr.dev/guides/configuration instead.`);\n  }\n  configuration.cacheDirectory = process.env['PUPPETEER_CACHE_DIR'] ?? process.env['npm_config_puppeteer_cache_dir'] ?? process.env['npm_package_config_puppeteer_cache_dir'] ?? configuration.cacheDirectory ?? (0, path_1.join)((0, os_1.homedir)(), '.cache', 'puppeteer');\n  configuration.temporaryDirectory = process.env['PUPPETEER_TMP_DIR'] ?? process.env['npm_config_puppeteer_tmp_dir'] ?? process.env['npm_package_config_puppeteer_tmp_dir'] ?? configuration.temporaryDirectory;\n  configuration.experiments ??= {};\n  // Validate configuration.\n  if (!isSupportedProduct(configuration.defaultProduct)) {\n    throw new Error(`Unsupported product ${configuration.defaultProduct}`);\n  }\n  return configuration;\n};\nexports.getConfiguration = getConfiguration;","map":{"version":3,"names":["os_1","require","path_1","cosmiconfig_1","getBooleanEnvVar","name","env","process","undefined","toLowerCase","isSupportedProduct","product","getConfiguration","result","cosmiconfigSync","searchStrategy","search","configuration","config","logLevel","defaultProduct","executablePath","skipDownload","Boolean","skipChromeDownload","skipChromeHeadlessShellDownload","browserRevision","downloadHost","console","warn","downloadBaseUrl","Object","keys","some","key","startsWith","cacheDirectory","join","homedir","temporaryDirectory","experiments","Error","exports"],"sources":["../../../src/getConfiguration.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}