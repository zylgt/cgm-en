{"ast":null,"code":"import _defineProperty from \"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _classPrivateFieldInitSpec from \"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/esm/classPrivateFieldInitSpec.js\";\nimport _classPrivateFieldGet from \"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet2.js\";\nimport _classPrivateFieldSet from \"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/esm/classPrivateFieldSet2.js\";\nimport \"core-js/modules/web.immediate.js\";\n/**\n * @license\n * Copyright 2018 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport NodeWebSocket from 'ws';\nimport { packageVersion } from '../generated/version.js';\n/**\n * @internal\n */\nvar _ws = /*#__PURE__*/new WeakMap();\nexport class NodeWebSocketTransport {\n  static create(url, headers) {\n    return new Promise((resolve, reject) => {\n      const ws = new NodeWebSocket(url, [], {\n        followRedirects: true,\n        perMessageDeflate: false,\n        maxPayload: 256 * 1024 * 1024,\n        // 256Mb\n        headers: {\n          'User-Agent': `Puppeteer ${packageVersion}`,\n          ...headers\n        }\n      });\n      ws.addEventListener('open', () => {\n        return resolve(new NodeWebSocketTransport(ws));\n      });\n      ws.addEventListener('error', reject);\n    });\n  }\n  constructor(ws) {\n    _classPrivateFieldInitSpec(this, _ws, void 0);\n    _defineProperty(this, \"onmessage\", void 0);\n    _defineProperty(this, \"onclose\", void 0);\n    _classPrivateFieldSet(_ws, this, ws);\n    _classPrivateFieldGet(_ws, this).addEventListener('message', event => {\n      setImmediate(() => {\n        if (this.onmessage) {\n          this.onmessage.call(null, event.data);\n        }\n      });\n    });\n    _classPrivateFieldGet(_ws, this).addEventListener('close', () => {\n      setImmediate(() => {\n        if (this.onclose) {\n          this.onclose.call(null);\n        }\n      });\n    });\n    // Silently ignore all errors - we don't know what to do with them.\n    _classPrivateFieldGet(_ws, this).addEventListener('error', () => {});\n  }\n  send(message) {\n    _classPrivateFieldGet(_ws, this).send(message);\n  }\n  close() {\n    _classPrivateFieldGet(_ws, this).close();\n  }\n}","map":{"version":3,"names":["NodeWebSocket","packageVersion","_ws","WeakMap","NodeWebSocketTransport","create","url","headers","Promise","resolve","reject","ws","followRedirects","perMessageDeflate","maxPayload","addEventListener","constructor","_classPrivateFieldInitSpec","_defineProperty","_classPrivateFieldSet","_classPrivateFieldGet","event","setImmediate","onmessage","call","data","onclose","send","message","close"],"sources":["../../../../src/node/NodeWebSocketTransport.ts"],"sourcesContent":[null],"mappings":";;;;;AAAA;;;;;AAKA,OAAOA,aAAa,MAAM,IAAI;AAG9B,SAAQC,cAAc,QAAO,yBAAyB;AAEtD;;;AAAA,IAAAC,GAAA,oBAAAC,OAAA;AAGA,OAAM,MAAOC,sBAAsB;EACjC,OAAOC,MAAMA,CACXC,GAAW,EACXC,OAAgC;IAEhC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;MACrC,MAAMC,EAAE,GAAG,IAAIX,aAAa,CAACM,GAAG,EAAE,EAAE,EAAE;QACpCM,eAAe,EAAE,IAAI;QACrBC,iBAAiB,EAAE,KAAK;QACxBC,UAAU,EAAE,GAAG,GAAG,IAAI,GAAG,IAAI;QAAE;QAC/BP,OAAO,EAAE;UACP,YAAY,EAAE,aAAaN,cAAc,EAAE;UAC3C,GAAGM;;OAEN,CAAC;MAEFI,EAAE,CAACI,gBAAgB,CAAC,MAAM,EAAE,MAAK;QAC/B,OAAON,OAAO,CAAC,IAAIL,sBAAsB,CAACO,EAAE,CAAC,CAAC;MAChD,CAAC,CAAC;MACFA,EAAE,CAACI,gBAAgB,CAAC,OAAO,EAAEL,MAAM,CAAC;IACtC,CAAC,CAAC;EACJ;EAMAM,YAAYL,EAAiB;IAAAM,0BAAA,OAAAf,GAAA;IAAAgB,eAAA;IAAAA,eAAA;IAC3BC,qBAAA,CAAAjB,GAAA,MAAI,EAAOS,EAAE;IACbS,qBAAA,CAAAlB,GAAA,MAAI,EAAKa,gBAAgB,CAAC,SAAS,EAAEM,KAAK,IAAG;MAC3CC,YAAY,CAAC,MAAK;QAChB,IAAI,IAAI,CAACC,SAAS,EAAE;UAClB,IAAI,CAACA,SAAS,CAACC,IAAI,CAAC,IAAI,EAAEH,KAAK,CAACI,IAAI,CAAC;QACvC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IACFL,qBAAA,CAAAlB,GAAA,MAAI,EAAKa,gBAAgB,CAAC,OAAO,EAAE,MAAK;MACtCO,YAAY,CAAC,MAAK;QAChB,IAAI,IAAI,CAACI,OAAO,EAAE;UAChB,IAAI,CAACA,OAAO,CAACF,IAAI,CAAC,IAAI,CAAC;QACzB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IACF;IACAJ,qBAAA,CAAAlB,GAAA,MAAI,EAAKa,gBAAgB,CAAC,OAAO,EAAE,MAAK,CAAE,CAAC,CAAC;EAC9C;EAEAY,IAAIA,CAACC,OAAe;IAClBR,qBAAA,CAAAlB,GAAA,MAAI,EAAKyB,IAAI,CAACC,OAAO,CAAC;EACxB;EAEAC,KAAKA,CAAA;IACHT,qBAAA,CAAAlB,GAAA,MAAI,EAAK2B,KAAK,EAAE;EAClB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}