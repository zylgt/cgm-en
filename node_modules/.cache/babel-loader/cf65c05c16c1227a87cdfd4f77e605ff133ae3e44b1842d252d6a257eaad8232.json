{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar _classPrivateMethodInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateMethodInitSpec.js\").default;\nvar _defineProperty = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/defineProperty.js\").default;\nvar _classPrivateFieldInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldInitSpec.js\").default;\nvar _classPrivateFieldSet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldSet2.js\").default;\nvar _classPrivateGetter = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateGetter.js\").default;\nvar _classPrivateFieldGet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldGet2.js\").default;\nvar _assertClassBrand = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/assertClassBrand.js\").default;\nrequire(\"core-js/modules/es.array.push.js\");\nvar __runInitializers = this && this.__runInitializers || function (thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n    value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\nvar __esDecorate = this && this.__esDecorate || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) {\n    if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\");\n    return f;\n  }\n  var kind = contextIn.kind,\n    key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _,\n    done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n    var context = {};\n    for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n    for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n    context.addInitializer = function (f) {\n      if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\");\n      extraInitializers.push(accept(f || null));\n    };\n    var result = (0, decorators[i])(kind === \"accessor\" ? {\n      get: descriptor.get,\n      set: descriptor.set\n    } : descriptor[key], context);\n    if (kind === \"accessor\") {\n      if (result === void 0) continue;\n      if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n      if (_ = accept(result.get)) descriptor.get = _;\n      if (_ = accept(result.set)) descriptor.set = _;\n      if (_ = accept(result.init)) initializers.unshift(_);\n    } else if (_ = accept(result)) {\n      if (kind === \"field\") initializers.unshift(_);else descriptor[key] = _;\n    }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserPrompt = void 0;\nconst EventEmitter_js_1 = require(\"../../common/EventEmitter.js\");\nconst decorators_js_1 = require(\"../../util/decorators.js\");\nconst disposable_js_1 = require(\"../../util/disposable.js\");\n/**\n * @internal\n */\nlet UserPrompt = ((_ref, _UserPrompt, _reason, _result, _disposables, _UserPrompt_brand) => {\n  let _classSuper = EventEmitter_js_1.EventEmitter;\n  let _instanceExtraInitializers = [];\n  let _dispose_decorators;\n  let _handle_decorators;\n  return _reason = /*#__PURE__*/new WeakMap(), _result = /*#__PURE__*/new WeakMap(), _disposables = /*#__PURE__*/new WeakMap(), _UserPrompt_brand = /*#__PURE__*/new WeakSet(), _ref = (_dispose_decorators = [decorators_js_1.inertIfDisposed], _handle_decorators = [(0, decorators_js_1.throwIfDisposed)(prompt => {\n    // SAFETY: Disposal implies this exists.\n    return _classPrivateFieldGet(_reason, prompt);\n  })], disposable_js_1.disposeSymbol), (_UserPrompt = class UserPrompt extends _classSuper {\n    static from(browsingContext, info) {\n      const userPrompt = new UserPrompt(browsingContext, info);\n      _assertClassBrand(_UserPrompt_brand, userPrompt, _initialize).call(userPrompt);\n      return userPrompt;\n    }\n    constructor(context, info) {\n      super();\n      _classPrivateMethodInitSpec(this, _UserPrompt_brand);\n      _classPrivateFieldInitSpec(this, _reason, (__runInitializers(this, _instanceExtraInitializers), void 0));\n      _classPrivateFieldInitSpec(this, _result, void 0);\n      _classPrivateFieldInitSpec(this, _disposables, new disposable_js_1.DisposableStack());\n      _defineProperty(this, \"browsingContext\", void 0);\n      _defineProperty(this, \"info\", void 0);\n      this.browsingContext = context;\n      this.info = info;\n    }\n    get closed() {\n      return _classPrivateFieldGet(_reason, this) !== undefined;\n    }\n    get disposed() {\n      return this.closed;\n    }\n    get handled() {\n      return _classPrivateFieldGet(_result, this) !== undefined;\n    }\n    get result() {\n      return _classPrivateFieldGet(_result, this);\n    }\n    dispose(reason) {\n      _classPrivateFieldSet(_reason, this, reason);\n      this[disposable_js_1.disposeSymbol]();\n    }\n    async handle(options = {}) {\n      await _classPrivateGetter(_UserPrompt_brand, this, _get_session).send('browsingContext.handleUserPrompt', {\n        ...options,\n        context: this.info.context\n      });\n      // SAFETY: `handled` is triggered before the above promise resolved.\n      return _classPrivateFieldGet(_result, this);\n    }\n    [_ref]() {\n      _classPrivateFieldGet(_reason, this) ?? _classPrivateFieldSet(_reason, this, 'User prompt already closed, probably because the associated browsing context was destroyed.');\n      this.emit('closed', {\n        reason: _classPrivateFieldGet(_reason, this)\n      });\n      _classPrivateFieldGet(_disposables, this).dispose();\n      super[disposable_js_1.disposeSymbol]();\n    }\n  }, (() => {\n    const _metadata = typeof Symbol === \"function\" && Symbol.metadata ? Object.create(_classSuper[Symbol.metadata] ?? null) : void 0;\n    __esDecorate(_UserPrompt, null, _dispose_decorators, {\n      kind: \"method\",\n      name: \"dispose\",\n      static: false,\n      private: false,\n      access: {\n        has: obj => \"dispose\" in obj,\n        get: obj => obj.dispose\n      },\n      metadata: _metadata\n    }, null, _instanceExtraInitializers);\n    __esDecorate(_UserPrompt, null, _handle_decorators, {\n      kind: \"method\",\n      name: \"handle\",\n      static: false,\n      private: false,\n      access: {\n        has: obj => \"handle\" in obj,\n        get: obj => obj.handle\n      },\n      metadata: _metadata\n    }, null, _instanceExtraInitializers);\n    if (_metadata) Object.defineProperty(_UserPrompt, Symbol.metadata, {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: _metadata\n    });\n  })(), _UserPrompt);\n  function _initialize() {\n    const browserContextEmitter = _classPrivateFieldGet(_disposables, this).use(new EventEmitter_js_1.EventEmitter(this.browsingContext));\n    browserContextEmitter.once('closed', ({\n      reason\n    }) => {\n      this.dispose(`User prompt already closed: ${reason}`);\n    });\n    const sessionEmitter = _classPrivateFieldGet(_disposables, this).use(new EventEmitter_js_1.EventEmitter(_classPrivateGetter(_UserPrompt_brand, this, _get_session)));\n    sessionEmitter.on('browsingContext.userPromptClosed', parameters => {\n      if (parameters.context !== this.browsingContext.id) {\n        return;\n      }\n      _classPrivateFieldSet(_result, this, parameters);\n      this.emit('handled', parameters);\n      this.dispose('User prompt already handled.');\n    });\n  }\n  function _get_session(_this) {\n    return _this.browsingContext.userContext.browser.session;\n  }\n})();\nexports.UserPrompt = UserPrompt;","map":{"version":3,"names":["_classPrivateMethodInitSpec","require","default","_defineProperty","_classPrivateFieldInitSpec","_classPrivateFieldSet","_classPrivateGetter","_classPrivateFieldGet","_assertClassBrand","EventEmitter_js_1","decorators_js_1","disposable_js_1","UserPrompt","_ref","_UserPrompt","_reason","_result","_disposables","_UserPrompt_brand","EventEmitter","_dispose_decorators","inertIfDisposed","_handle_decorators","throwIfDisposed","prompt","disposeSymbol","_classSuper","from","browsingContext","info","userPrompt","_initialize","call","constructor","context","__runInitializers","_instanceExtraInitializers","DisposableStack","closed","undefined","disposed","handled","result","dispose","reason","handle","options","_get_session","send","emit","__esDecorate","kind","name","static","private","access","has","obj","get","metadata","_metadata","browserContextEmitter","use","once","sessionEmitter","on","parameters","id","_this","userContext","browser","session","exports"],"sources":["../../../../../src/bidi/core/UserPrompt.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}