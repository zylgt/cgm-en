{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2024 Google LLC.\n * Copyright (c) Microsoft Corporation.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _classPrivateFieldInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldInitSpec.js\").default;\nvar _classPrivateFieldGet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldGet2.js\").default;\nvar _classPrivateFieldSet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldSet2.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WorkerRealm = void 0;\nconst Realm_js_1 = require(\"./Realm.js\");\nvar _realmType = /*#__PURE__*/new WeakMap();\nvar _ownerRealms = /*#__PURE__*/new WeakMap();\nclass WorkerRealm extends Realm_js_1.Realm {\n  constructor(cdpClient, eventManager, executionContextId, logger, origin, ownerRealms, realmId, realmStorage, realmType) {\n    super(cdpClient, eventManager, executionContextId, logger, origin, realmId, realmStorage);\n    _classPrivateFieldInitSpec(this, _realmType, void 0);\n    _classPrivateFieldInitSpec(this, _ownerRealms, void 0);\n    _classPrivateFieldSet(_ownerRealms, this, ownerRealms);\n    _classPrivateFieldSet(_realmType, this, realmType);\n    this.initialize();\n  }\n  get associatedBrowsingContexts() {\n    return _classPrivateFieldGet(_ownerRealms, this).flatMap(realm => realm.associatedBrowsingContexts);\n  }\n  get realmType() {\n    return _classPrivateFieldGet(_realmType, this);\n  }\n  get source() {\n    return {\n      realm: this.realmId,\n      // This is a hack to make Puppeteer able to track workers.\n      // TODO: remove after Puppeteer tracks workers by owners and use the base version.\n      context: this.associatedBrowsingContexts[0]?.id\n    };\n  }\n  get realmInfo() {\n    const owners = _classPrivateFieldGet(_ownerRealms, this).map(realm => realm.realmId);\n    const {\n      realmType\n    } = this;\n    switch (realmType) {\n      case 'dedicated-worker':\n        {\n          const owner = owners[0];\n          if (owner === undefined || owners.length !== 1) {\n            throw new Error('Dedicated worker must have exactly one owner');\n          }\n          return {\n            ...this.baseInfo,\n            type: realmType,\n            owners: [owner]\n          };\n        }\n      case 'service-worker':\n      case 'shared-worker':\n        {\n          return {\n            ...this.baseInfo,\n            type: realmType\n          };\n        }\n    }\n  }\n}\nexports.WorkerRealm = WorkerRealm;","map":{"version":3,"names":["_classPrivateFieldInitSpec","require","default","_classPrivateFieldGet","_classPrivateFieldSet","Realm_js_1","_realmType","WeakMap","_ownerRealms","WorkerRealm","Realm","constructor","cdpClient","eventManager","executionContextId","logger","origin","ownerRealms","realmId","realmStorage","realmType","initialize","associatedBrowsingContexts","flatMap","realm","source","context","id","realmInfo","owners","map","owner","undefined","length","Error","baseInfo","type","exports"],"sources":["../../../../../src/bidiMapper/modules/script/WorkerRealm.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;;AAAA,IAAAA,0BAAA,GAAAC,OAAA,8GAAAC,OAAA;AAAA,IAAAC,qBAAA,GAAAF,OAAA,0GAAAC,OAAA;AAAA,IAAAE,qBAAA,GAAAH,OAAA,0GAAAC,OAAA;;;;;AAyBA,MAAAG,UAAA,GAAAJ,OAAA;AAAiC,IAAAK,UAAA,oBAAAC,OAAA;AAAA,IAAAC,YAAA,oBAAAD,OAAA;AAUjC,MAAaE,WAAY,SAAQJ,UAAA,CAAAK,KAAK;EAIpCC,YACEC,SAAoB,EACpBC,YAA0B,EAC1BC,kBAAuD,EACvDC,MAA4B,EAC5BC,MAAc,EACdC,WAAoB,EACpBC,OAAqB,EACrBC,YAA0B,EAC1BC,SAA0B;IAE1B,KAAK,CACHR,SAAS,EACTC,YAAY,EACZC,kBAAkB,EAClBC,MAAM,EACNC,MAAM,EACNE,OAAO,EACPC,YAAY,CACb;IAACnB,0BAAA,OAAAM,UAAA;IAAAN,0BAAA,OAAAQ,YAAA;IAEFJ,qBAAA,CAAAI,YAAA,MAAI,EAAgBS,WAAW;IAC/Bb,qBAAA,CAAAE,UAAA,MAAI,EAAcc,SAAS;IAE3B,IAAI,CAACC,UAAU,EAAE;EACnB;EAEA,IAAaC,0BAA0BA,CAAA;IACrC,OAAOnB,qBAAA,CAAAK,YAAA,MAAI,EAAce,OAAO,CAC7BC,KAAK,IAAKA,KAAK,CAACF,0BAA0B,CAC5C;EACH;EAEA,IAAaF,SAASA,CAAA;IACpB,OAAAjB,qBAAA,CAAAG,UAAA,EAAO,IAAI;EACb;EAEA,IAAamB,MAAMA,CAAA;IACjB,OAAO;MACLD,KAAK,EAAE,IAAI,CAACN,OAAO;MACnB;MACA;MACAQ,OAAO,EAAE,IAAI,CAACJ,0BAA0B,CAAC,CAAC,CAAC,EAAEK;KAC9C;EACH;EAEA,IAAaC,SAASA,CAAA;IACpB,MAAMC,MAAM,GAAG1B,qBAAA,CAAAK,YAAA,MAAI,EAAcsB,GAAG,CAAEN,KAAK,IAAKA,KAAK,CAACN,OAAO,CAAC;IAC9D,MAAM;MAACE;IAAS,CAAC,GAAG,IAAI;IACxB,QAAQA,SAAS;MACf,KAAK,kBAAkB;QAAE;UACvB,MAAMW,KAAK,GAAGF,MAAM,CAAC,CAAC,CAAC;UACvB,IAAIE,KAAK,KAAKC,SAAS,IAAIH,MAAM,CAACI,MAAM,KAAK,CAAC,EAAE;YAC9C,MAAM,IAAIC,KAAK,CAAC,8CAA8C,CAAC;UACjE;UACA,OAAO;YACL,GAAG,IAAI,CAACC,QAAQ;YAChBC,IAAI,EAAEhB,SAAS;YACfS,MAAM,EAAE,CAACE,KAAK;WACf;QACH;MACA,KAAK,gBAAgB;MACrB,KAAK,eAAe;QAAE;UACpB,OAAO;YACL,GAAG,IAAI,CAACI,QAAQ;YAChBC,IAAI,EAAEhB;WACP;QACH;IACF;EACF;;AAzEFiB,OAAA,CAAA5B,WAAA,GAAAA,WAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}