{"ast":null,"code":"import { configs, saveInfo, getInfo } from '@/api/api';\nimport Cookies from \"js-cookie\";\nimport maskPhoneNumber from '@/utils/phone';\nexport default {\n  data() {\n    return {\n      formData: {\n        diabetes_type: null,\n        treatment_regimen: [],\n        comorbidities: [],\n        complications: [],\n        birthdate: null,\n        weight: null,\n        height: null,\n        gender: null,\n        diagnosis_date: null,\n        nickname: maskPhoneNumber(Cookies.get(\"username\")),\n        avatar: null\n      },\n      loading: false,\n      pageLoading: true,\n      defaultBirthday: new Date().setFullYear(new Date().getFullYear() - 40),\n      configList: [],\n      pickerOptions: {\n        disabledDate(time) {\n          return time.getTime() > new Date().setFullYear(new Date().getFullYear() - 4) || time.getTime() < new Date('1900-01-01');\n        }\n      },\n      diagnosisPickerOptions: {\n        disabledDate(time) {\n          return time.getTime() < new Date('1900-01-01') || time.getTime() > new Date();\n        }\n      }\n    };\n  },\n  computed: {\n    diagnosisShow() {\n      return this.formData.diabetes_type && this.formData.diabetes_type != 0;\n    }\n  },\n  created() {\n    this.getConfig();\n    this.getInfo();\n  },\n  methods: {\n    // 获取配置项\n    getConfig() {\n      configs({}).then(response => {\n        console.log(response);\n        if (response.code == 1000) {\n          this.configList = response.data;\n        } else {\n          this.$message({\n            type: 'error',\n            message: response.msg\n          });\n        }\n      }).catch(res => {\n        console.log(res);\n        this.$message({\n          type: 'error',\n          message: res.message\n        });\n      });\n    },\n    // 多选改单选\n    handelSelect(item_key, config_key) {\n      if (item_key == 0) {\n        this.formData[config_key] = [0];\n      } else {\n        this.formData[config_key] = this.formData[config_key].filter(item => item != 0);\n      }\n    },\n    // 保存用户配置\n    saveSubmit() {\n      this.loading = true;\n      this.formData.height = Number(this.formData.height);\n      this.formData.weight = Number(this.formData.weight);\n      this.formData.gender = Number(this.formData.gender);\n      saveInfo(this.formData).then(response => {\n        this.loading = false;\n        if (response.code == 1000) {\n          this.$message({\n            type: 'success',\n            message: '保存成功'\n          });\n          this.getInfo();\n        } else {\n          this.$message({\n            type: 'error',\n            message: response.msg\n          });\n        }\n      }).catch(res => {\n        this.$message({\n          type: 'error',\n          message: res.message\n        });\n      });\n    },\n    // 获取用户配置\n    getInfo() {\n      getInfo().then(response => {\n        this.pageLoading = false;\n        if (response.code == 1000) {\n          this.formData = response.data;\n        } else {\n          this.$message({\n            type: 'error',\n            message: response.msg\n          });\n        }\n      }).catch(res => {\n        this.pageLoading = false;\n        this.$message({\n          type: 'error',\n          message: res.message\n        });\n      });\n    }\n  }\n};","map":{"version":3,"names":["configs","saveInfo","getInfo","Cookies","maskPhoneNumber","data","formData","diabetes_type","treatment_regimen","comorbidities","complications","birthdate","weight","height","gender","diagnosis_date","nickname","get","avatar","loading","pageLoading","defaultBirthday","Date","setFullYear","getFullYear","configList","pickerOptions","disabledDate","time","getTime","diagnosisPickerOptions","computed","diagnosisShow","created","getConfig","methods","then","response","console","log","code","$message","type","message","msg","catch","res","handelSelect","item_key","config_key","filter","item","saveSubmit","Number"],"sources":["src/views/userInfo/userInfo.vue"],"sourcesContent":["<template>\n    <div class='userInfo' id='userInfo' v-loading='pageLoading'>\n        <div class='userInfo-title' >\n            <div class='userInfo-label' >个人信息</div>\n            <div class='userInfo-jump' @click=\"saveSubmit\" >跳过</div>\n        </div>\n        <div class='userInfo-tips' >填写您的健康信息，将为您制定个性化管理方案！</div>\n        <el-form ref=\"formData\"  label-width=\"150px\" label-position=\"left\" :model=\"formData\" >\n               \n            <el-form-item  v-for='item in configList' :key='item.config_key' :label=\"item.config_name+'：'\"  prop=\"order\">\n                    <el-radio-group v-model=\"formData[item.config_key]\" v-if='item.config_key==\"diabetes_type\"' >\n                        <el-radio v-for='ele in item.items' :key='ele.item_key' :label='ele.item_key'>{{ele.item_name}}</el-radio>\n                    </el-radio-group>\n                     <el-checkbox-group v-model=\"formData[item.config_key]\" v-else >\n                        <el-checkbox  v-for='ele in item.items' :key='ele.item_key' :label=\"ele.item_key\" name=\"type\" @change=\"handelSelect(ele.item_key,item.config_key)\" >{{ele.item_name}}</el-checkbox>\n                    </el-checkbox-group>\n            </el-form-item>\n            <el-form-item label=\"出生日期\" >\n                <el-date-picker v-model=\"formData.birthdate\" type=\"date\"  placeholder=\"选择日期\"\n                :picker-options=\"pickerOptions\"\n                :default-value='defaultBirthday'\n                value-format=\"yyyy-MM-dd\"\t></el-date-picker>\n            </el-form-item>\n            <el-form-item label=\"性别\"  >\n                <el-radio-group v-model=\"formData.gender\">\n                    <el-radio :label='0'>男</el-radio>\n                    <el-radio :label='1'>女</el-radio>\n                </el-radio-group>\n            </el-form-item>\n            <el-form-item label=\"身高\" >\n                <el-input v-model=\"formData.height\" >\n                    <span slot='suffix' >cm</span>\n                </el-input>\n            </el-form-item>\n            <el-form-item label=\"体重\" >\n                <el-input v-model=\"formData.weight\" >\n                    <span slot='suffix' >kg</span>\n                </el-input>\n            </el-form-item>\n             <el-form-item label=\"确诊日期\" v-if='diagnosisShow'>\n                <el-date-picker v-model=\"formData.diagnosis_date\" type=\"date\" value-format=\"yyyy-MM-dd\" placeholder=\"选择日期\" :picker-options=\"diagnosisPickerOptions\"></el-date-picker>\n            </el-form-item>\n            <div class='flex record-btn'  >\n                <el-button type=\"primary\" round  class='userInfo-btn' @click='saveSubmit' :loading=\"loading\"  >完成设置</el-button>\n            </div>\n        </el-form>\n    </div>\n</template>\n<script>\nimport {configs,saveInfo,getInfo} from '@/api/api'\nimport Cookies from \"js-cookie\"\nimport maskPhoneNumber from '@/utils/phone'\nexport default {\n    data(){\n        return{\n            formData:{\n                diabetes_type:null,\n                treatment_regimen:[],\n                comorbidities:[],\n                complications:[],\n                birthdate:null,\n                weight:null,\n                height:null,\n                gender:null,\n                diagnosis_date:null,\n                nickname:maskPhoneNumber(Cookies.get(\"username\")),\n                avatar:null\n            },\n            loading:false,\n            pageLoading:true,\n            defaultBirthday:new Date().setFullYear(new Date().getFullYear()-40),\n            configList:[],\n            pickerOptions:{\n                disabledDate (time) {\n                        return time.getTime() > new Date().setFullYear(new Date().getFullYear()-4)||time.getTime()<new Date('1900-01-01')\n                }\n                    \n            },\n            diagnosisPickerOptions:{\n                disabledDate (time) {\n                        return time.getTime()<new Date('1900-01-01')||time.getTime() > new Date()\n                }\n            }\n        }\n    },\n    computed:{\n        diagnosisShow(){\n            return this.formData.diabetes_type&&this.formData.diabetes_type!=0\n        }\n    },\n    created(){\n        this.getConfig()\n        this.getInfo()\n    },\n    methods:{\n         // 获取配置项\n        getConfig(){\n            configs({}).then(response => {\n                console.log(response)\n                    if(response.code == 1000){\n                       this.configList = response.data\n                       \n                    }else{\n                        this.$message({\n                            type: 'error',\n                            message: response.msg\n                        });\n                    }\n            }).catch((res) => {\n                console.log(res)\n                    this.$message({\n                        type: 'error',\n                        message: res.message\n                    });\n            })\n        },\n        // 多选改单选\n        handelSelect(item_key,config_key){\n            if(item_key==0){\n                this.formData[config_key] = [0]\n            }else{\n                this.formData[config_key]=this.formData[config_key].filter(item=>item!=0)\n            }\n        },\n        // 保存用户配置\n        saveSubmit(){\n            this.loading = true\n            this.formData.height = Number(this.formData.height)\n            this.formData.weight = Number(this.formData.weight)\n            this.formData.gender = Number(this.formData.gender)\n            saveInfo(this.formData).then(response => {\n                    this.loading = false\n                    if(response.code == 1000){\n                        this.$message({\n                            type: 'success',\n                            message: '保存成功'\n                        });\n                        this.getInfo()\n                    }else{\n                        this.$message({\n                            type: 'error',\n                            message: response.msg\n                        });\n                    }\n            }).catch((res) => {\n                    this.$message({\n                        type: 'error',\n                        message: res.message\n                    });\n            })\n        },\n        // 获取用户配置\n        getInfo(){\n            getInfo().then(response => {\n                    this.pageLoading = false\n                    if(response.code == 1000){\n                        this.formData = response.data\n                    }else{\n                        this.$message({\n                            type: 'error',\n                            message: response.msg\n                        });\n                    }\n            }).catch((res) => {\n                this.pageLoading = false\n                    this.$message({\n                        type: 'error',\n                        message: res.message\n                    });\n            })\n        }\n    }\n}\n</script>\n<style >\n    .userInfo{\n        background:#fff;\n        height:100%;\n        padding:30px 60px;\n    }\n    .userInfo-title{\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom:20px;\n    }\n    .userInfo-label{\n        font-size:24px;\n        color:#333;\n        font-weight: 700;\n    }\n    .userInfo-jump{\n        font-size:14px;\n        color: var(--color-primary);\n    }\n    .userInfo-tips{\n         font-size:14px;\n        color:#999;\n        margin-bottom:30px;\n    }\n    #userInfo .el-form-item__label{\n        font-weight: 500;\n        font-size:16px;\n    }\n    #userInfo .el-radio-group{\n        line-height:40px;\n    }\n    #userInfo .el-input{\n        width:220px;\n    }\n    #userInfo .record-btn{\n        display: flex;\n        justify-content: center;\n        margin-top:40px;\n    }\n    #userInfo .userInfo-btn{\n        width:300px;\n    }\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}