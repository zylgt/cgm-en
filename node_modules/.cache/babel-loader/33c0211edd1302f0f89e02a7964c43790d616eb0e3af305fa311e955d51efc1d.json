{"ast":null,"code":"\"use strict\";\n\nvar _classPrivateMethodInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateMethodInitSpec.js\").default;\nvar _defineProperty = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/defineProperty.js\").default;\nvar _classPrivateFieldInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldInitSpec.js\").default;\nvar _classPrivateFieldGet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldGet2.js\").default;\nvar _classPrivateFieldSet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldSet2.js\").default;\nvar _assertClassBrand = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/assertClassBrand.js\").default;\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getExtensionDescription = exports.ExplorerBase = void 0;\nconst env_paths_1 = __importDefault(require(\"env-paths\"));\nconst os_1 = __importDefault(require(\"os\"));\nconst path_1 = __importDefault(require(\"path\"));\nconst util_js_1 = require(\"./util.js\");\n/**\n * @internal\n */\nvar _loadingMetaConfig = /*#__PURE__*/new WeakMap();\nvar _ExplorerBase_brand = /*#__PURE__*/new WeakSet();\nclass ExplorerBase {\n  constructor(options) {\n    _classPrivateMethodInitSpec(this, _ExplorerBase_brand);\n    _classPrivateFieldInitSpec(this, _loadingMetaConfig, false);\n    _defineProperty(this, \"config\", void 0);\n    _defineProperty(this, \"loadCache\", void 0);\n    _defineProperty(this, \"searchCache\", void 0);\n    this.config = options;\n    if (options.cache) {\n      this.loadCache = new Map();\n      this.searchCache = new Map();\n    }\n    _assertClassBrand(_ExplorerBase_brand, this, _validateConfig).call(this);\n  }\n  set loadingMetaConfig(value) {\n    _classPrivateFieldSet(_loadingMetaConfig, this, value);\n  }\n  clearLoadCache() {\n    if (this.loadCache) {\n      this.loadCache.clear();\n    }\n  }\n  clearSearchCache() {\n    if (this.searchCache) {\n      this.searchCache.clear();\n    }\n  }\n  clearCaches() {\n    this.clearLoadCache();\n    this.clearSearchCache();\n  }\n  toCosmiconfigResult(filepath, config) {\n    if (config === null) {\n      return null;\n    }\n    if (config === undefined) {\n      return {\n        filepath,\n        config: undefined,\n        isEmpty: true\n      };\n    }\n    if (this.config.applyPackagePropertyPathToConfiguration || _classPrivateFieldGet(_loadingMetaConfig, this)) {\n      const packageProp = this.config.packageProp ?? this.config.moduleName;\n      config = (0, util_js_1.getPropertyByPath)(config, packageProp);\n    }\n    if (config === undefined) {\n      return {\n        filepath,\n        config: undefined,\n        isEmpty: true\n      };\n    }\n    return {\n      config,\n      filepath\n    };\n  }\n  validateImports(containingFilePath, imports, importStack) {\n    const fileDirectory = path_1.default.dirname(containingFilePath);\n    for (const importPath of imports) {\n      if (typeof importPath !== 'string') {\n        throw new Error(`${containingFilePath}: Key $import must contain a string or a list of strings`);\n      }\n      const fullPath = path_1.default.resolve(fileDirectory, importPath);\n      if (fullPath === containingFilePath) {\n        throw new Error(`Self-import detected in ${containingFilePath}`);\n      }\n      const idx = importStack.indexOf(fullPath);\n      if (idx !== -1) {\n        throw new Error(`Circular import detected:\n${[...importStack, fullPath].map((path, i) => `${i + 1}. ${path}`).join('\\n')} (same as ${idx + 1}.)`);\n      }\n    }\n  }\n  getSearchPlacesForDir(dir, globalConfigPlaces) {\n    return (dir.isGlobalConfig ? globalConfigPlaces : this.config.searchPlaces).map(place => path_1.default.join(dir.path, place));\n  }\n  getGlobalConfigDir() {\n    return (0, env_paths_1.default)(this.config.moduleName, {\n      suffix: ''\n    }).config;\n  }\n  *getGlobalDirs(startDir) {\n    const stopDir = path_1.default.resolve(this.config.stopDir ?? os_1.default.homedir());\n    yield {\n      path: startDir,\n      isGlobalConfig: false\n    };\n    let currentDir = startDir;\n    while (currentDir !== stopDir) {\n      const parentDir = path_1.default.dirname(currentDir);\n      /* istanbul ignore if -- @preserve */\n      if (parentDir === currentDir) {\n        // we're probably at the root of the directory structure\n        break;\n      }\n      yield {\n        path: parentDir,\n        isGlobalConfig: false\n      };\n      currentDir = parentDir;\n    }\n    yield {\n      path: this.getGlobalConfigDir(),\n      isGlobalConfig: true\n    };\n  }\n}\nfunction _validateConfig() {\n  const config = this.config;\n  for (const place of config.searchPlaces) {\n    const extension = path_1.default.extname(place);\n    const loader = this.config.loaders[extension || 'noExt'] ?? this.config.loaders['default'];\n    if (loader === undefined) {\n      throw new Error(`Missing loader for ${getExtensionDescription(place)}.`);\n    }\n    if (typeof loader !== 'function') {\n      throw new Error(`Loader for ${getExtensionDescription(place)} is not a function: Received ${typeof loader}.`);\n    }\n  }\n}\nexports.ExplorerBase = ExplorerBase;\n/**\n * @internal\n */\nfunction getExtensionDescription(extension) {\n  /* istanbul ignore next -- @preserve */\n  return extension ? `extension \"${extension}\"` : 'files without extensions';\n}\nexports.getExtensionDescription = getExtensionDescription;","map":{"version":3,"names":["env_paths_1","__importDefault","require","os_1","path_1","util_js_1","_loadingMetaConfig","WeakMap","_ExplorerBase_brand","WeakSet","ExplorerBase","constructor","options","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","_defineProperty","config","cache","loadCache","Map","searchCache","_assertClassBrand","_validateConfig","call","loadingMetaConfig","value","_classPrivateFieldSet","clearLoadCache","clear","clearSearchCache","clearCaches","toCosmiconfigResult","filepath","undefined","isEmpty","applyPackagePropertyPathToConfiguration","_classPrivateFieldGet","packageProp","moduleName","getPropertyByPath","validateImports","containingFilePath","imports","importStack","fileDirectory","default","dirname","importPath","Error","fullPath","resolve","idx","indexOf","map","path","i","join","getSearchPlacesForDir","dir","globalConfigPlaces","isGlobalConfig","searchPlaces","place","getGlobalConfigDir","suffix","getGlobalDirs","startDir","stopDir","homedir","currentDir","parentDir","extension","extname","loader","loaders","getExtensionDescription","exports"],"sources":["../src/ExplorerBase.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}