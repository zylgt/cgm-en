{"ast":null,"code":"\"use strict\";\n\nvar _classPrivateMethodInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateMethodInitSpec.js\").default;\nvar _classPrivateFieldInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldInitSpec.js\").default;\nvar _classPrivateFieldGet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldGet2.js\").default;\nvar _assertClassBrand = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/assertClassBrand.js\").default;\nvar _classPrivateFieldSet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldSet2.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CdpHTTPResponse = void 0;\nconst HTTPResponse_js_1 = require(\"../api/HTTPResponse.js\");\nconst Errors_js_1 = require(\"../common/Errors.js\");\nconst SecurityDetails_js_1 = require(\"../common/SecurityDetails.js\");\nconst Deferred_js_1 = require(\"../util/Deferred.js\");\n/**\n * @internal\n */\nvar _client = /*#__PURE__*/new WeakMap();\nvar _request = /*#__PURE__*/new WeakMap();\nvar _contentPromise = /*#__PURE__*/new WeakMap();\nvar _bodyLoadedDeferred = /*#__PURE__*/new WeakMap();\nvar _remoteAddress = /*#__PURE__*/new WeakMap();\nvar _status = /*#__PURE__*/new WeakMap();\nvar _statusText = /*#__PURE__*/new WeakMap();\nvar _url = /*#__PURE__*/new WeakMap();\nvar _fromDiskCache = /*#__PURE__*/new WeakMap();\nvar _fromServiceWorker = /*#__PURE__*/new WeakMap();\nvar _headers = /*#__PURE__*/new WeakMap();\nvar _securityDetails = /*#__PURE__*/new WeakMap();\nvar _timing = /*#__PURE__*/new WeakMap();\nvar _CdpHTTPResponse_brand = /*#__PURE__*/new WeakSet();\nclass CdpHTTPResponse extends HTTPResponse_js_1.HTTPResponse {\n  constructor(client, request, responsePayload, _extraInfo) {\n    super();\n    _classPrivateMethodInitSpec(this, _CdpHTTPResponse_brand);\n    _classPrivateFieldInitSpec(this, _client, void 0);\n    _classPrivateFieldInitSpec(this, _request, void 0);\n    _classPrivateFieldInitSpec(this, _contentPromise, null);\n    _classPrivateFieldInitSpec(this, _bodyLoadedDeferred, Deferred_js_1.Deferred.create());\n    _classPrivateFieldInitSpec(this, _remoteAddress, void 0);\n    _classPrivateFieldInitSpec(this, _status, void 0);\n    _classPrivateFieldInitSpec(this, _statusText, void 0);\n    _classPrivateFieldInitSpec(this, _url, void 0);\n    _classPrivateFieldInitSpec(this, _fromDiskCache, void 0);\n    _classPrivateFieldInitSpec(this, _fromServiceWorker, void 0);\n    _classPrivateFieldInitSpec(this, _headers, {});\n    _classPrivateFieldInitSpec(this, _securityDetails, void 0);\n    _classPrivateFieldInitSpec(this, _timing, void 0);\n    _classPrivateFieldSet(_client, this, client);\n    _classPrivateFieldSet(_request, this, request);\n    _classPrivateFieldSet(_remoteAddress, this, {\n      ip: responsePayload.remoteIPAddress,\n      port: responsePayload.remotePort\n    });\n    _classPrivateFieldSet(_statusText, this, _assertClassBrand(_CdpHTTPResponse_brand, this, _parseStatusTextFromExtraInfo).call(this, _extraInfo) || responsePayload.statusText);\n    _classPrivateFieldSet(_url, this, request.url());\n    _classPrivateFieldSet(_fromDiskCache, this, !!responsePayload.fromDiskCache);\n    _classPrivateFieldSet(_fromServiceWorker, this, !!responsePayload.fromServiceWorker);\n    _classPrivateFieldSet(_status, this, _extraInfo ? _extraInfo.statusCode : responsePayload.status);\n    const headers = _extraInfo ? _extraInfo.headers : responsePayload.headers;\n    for (const [key, value] of Object.entries(headers)) {\n      _classPrivateFieldGet(_headers, this)[key.toLowerCase()] = value;\n    }\n    _classPrivateFieldSet(_securityDetails, this, responsePayload.securityDetails ? new SecurityDetails_js_1.SecurityDetails(responsePayload.securityDetails) : null);\n    _classPrivateFieldSet(_timing, this, responsePayload.timing || null);\n  }\n  _resolveBody(err) {\n    if (err) {\n      return _classPrivateFieldGet(_bodyLoadedDeferred, this).reject(err);\n    }\n    return _classPrivateFieldGet(_bodyLoadedDeferred, this).resolve();\n  }\n  remoteAddress() {\n    return _classPrivateFieldGet(_remoteAddress, this);\n  }\n  url() {\n    return _classPrivateFieldGet(_url, this);\n  }\n  status() {\n    return _classPrivateFieldGet(_status, this);\n  }\n  statusText() {\n    return _classPrivateFieldGet(_statusText, this);\n  }\n  headers() {\n    return _classPrivateFieldGet(_headers, this);\n  }\n  securityDetails() {\n    return _classPrivateFieldGet(_securityDetails, this);\n  }\n  timing() {\n    return _classPrivateFieldGet(_timing, this);\n  }\n  buffer() {\n    if (!_classPrivateFieldGet(_contentPromise, this)) {\n      _classPrivateFieldSet(_contentPromise, this, _classPrivateFieldGet(_bodyLoadedDeferred, this).valueOrThrow().then(async () => {\n        try {\n          const response = await _classPrivateFieldGet(_client, this).send('Network.getResponseBody', {\n            requestId: _classPrivateFieldGet(_request, this).id\n          });\n          return Buffer.from(response.body, response.base64Encoded ? 'base64' : 'utf8');\n        } catch (error) {\n          if (error instanceof Errors_js_1.ProtocolError && error.originalMessage === 'No resource with given identifier found') {\n            throw new Errors_js_1.ProtocolError('Could not load body for this request. This might happen if the request is a preflight request.');\n          }\n          throw error;\n        }\n      }));\n    }\n    return _classPrivateFieldGet(_contentPromise, this);\n  }\n  request() {\n    return _classPrivateFieldGet(_request, this);\n  }\n  fromCache() {\n    return _classPrivateFieldGet(_fromDiskCache, this) || _classPrivateFieldGet(_request, this)._fromMemoryCache;\n  }\n  fromServiceWorker() {\n    return _classPrivateFieldGet(_fromServiceWorker, this);\n  }\n  frame() {\n    return _classPrivateFieldGet(_request, this).frame();\n  }\n}\nfunction _parseStatusTextFromExtraInfo(extraInfo) {\n  if (!extraInfo || !extraInfo.headersText) {\n    return;\n  }\n  const firstLine = extraInfo.headersText.split('\\r', 1)[0];\n  if (!firstLine) {\n    return;\n  }\n  const match = firstLine.match(/[^ ]* [^ ]* (.*)/);\n  if (!match) {\n    return;\n  }\n  const statusText = match[1];\n  if (!statusText) {\n    return;\n  }\n  return statusText;\n}\nexports.CdpHTTPResponse = CdpHTTPResponse;","map":{"version":3,"names":["HTTPResponse_js_1","require","Errors_js_1","SecurityDetails_js_1","Deferred_js_1","_client","WeakMap","_request","_contentPromise","_bodyLoadedDeferred","_remoteAddress","_status","_statusText","_url","_fromDiskCache","_fromServiceWorker","_headers","_securityDetails","_timing","_CdpHTTPResponse_brand","WeakSet","CdpHTTPResponse","HTTPResponse","constructor","client","request","responsePayload","extraInfo","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","Deferred","create","_classPrivateFieldSet","ip","remoteIPAddress","port","remotePort","_assertClassBrand","_parseStatusTextFromExtraInfo","call","statusText","url","fromDiskCache","fromServiceWorker","statusCode","status","headers","key","value","Object","entries","_classPrivateFieldGet","toLowerCase","securityDetails","SecurityDetails","timing","_resolveBody","err","reject","resolve","remoteAddress","buffer","valueOrThrow","then","response","send","requestId","id","Buffer","from","body","base64Encoded","error","ProtocolError","originalMessage","fromCache","_fromMemoryCache","frame","headersText","firstLine","split","match","exports"],"sources":["../../../../src/cdp/HTTPResponse.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}