{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.rewriteNavigationError = exports.createEvaluationError = void 0;\nconst Errors_js_1 = require(\"../common/Errors.js\");\nconst util_js_1 = require(\"../common/util.js\");\nconst Deserializer_js_1 = require(\"./Deserializer.js\");\n/**\n * @internal\n */\nfunction createEvaluationError(details) {\n  if (details.exception.type !== 'error') {\n    return Deserializer_js_1.BidiDeserializer.deserialize(details.exception);\n  }\n  const [name = '', ...parts] = details.text.split(': ');\n  const message = parts.join(': ');\n  const error = new Error(message);\n  error.name = name;\n  // The first line is this function which we ignore.\n  const stackLines = [];\n  if (details.stackTrace && stackLines.length < Error.stackTraceLimit) {\n    for (const frame of details.stackTrace.callFrames.reverse()) {\n      if (util_js_1.PuppeteerURL.isPuppeteerURL(frame.url) && frame.url !== util_js_1.PuppeteerURL.INTERNAL_URL) {\n        const url = util_js_1.PuppeteerURL.parse(frame.url);\n        stackLines.unshift(`    at ${frame.functionName || url.functionName} (${url.functionName} at ${url.siteString}, <anonymous>:${frame.lineNumber}:${frame.columnNumber})`);\n      } else {\n        stackLines.push(`    at ${frame.functionName || '<anonymous>'} (${frame.url}:${frame.lineNumber}:${frame.columnNumber})`);\n      }\n      if (stackLines.length >= Error.stackTraceLimit) {\n        break;\n      }\n    }\n  }\n  error.stack = [details.text, ...stackLines].join('\\n');\n  return error;\n}\nexports.createEvaluationError = createEvaluationError;\n/**\n * @internal\n */\nfunction rewriteNavigationError(message, ms) {\n  return error => {\n    if (error instanceof Errors_js_1.ProtocolError) {\n      error.message += ` at ${message}`;\n    } else if (error instanceof Errors_js_1.TimeoutError) {\n      error.message = `Navigation timeout of ${ms} ms exceeded`;\n    }\n    throw error;\n  };\n}\nexports.rewriteNavigationError = rewriteNavigationError;","map":{"version":3,"names":["require","Errors_js_1","util_js_1","Deserializer_js_1","createEvaluationError","details","exception","type","BidiDeserializer","deserialize","name","parts","text","split","message","join","error","Error","stackLines","stackTrace","length","stackTraceLimit","frame","callFrames","reverse","PuppeteerURL","isPuppeteerURL","url","INTERNAL_URL","parse","unshift","functionName","siteString","lineNumber","columnNumber","push","stack","exports","rewriteNavigationError","ms","ProtocolError","TimeoutError"],"sources":["../../../../src/bidi/util.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;AAAAA,OAAA;;;;;AAQA,MAAAC,WAAA,GAAAD,OAAA;AACA,MAAAE,SAAA,GAAAF,OAAA;AAEA,MAAAG,iBAAA,GAAAH,OAAA;AAEA;;;AAGA,SAAgBI,qBAAqBA,CACnCC,OAAqC;EAErC,IAAIA,OAAO,CAACC,SAAS,CAACC,IAAI,KAAK,OAAO,EAAE;IACtC,OAAOJ,iBAAA,CAAAK,gBAAgB,CAACC,WAAW,CAACJ,OAAO,CAACC,SAAS,CAAC;EACxD;EACA,MAAM,CAACI,IAAI,GAAG,EAAE,EAAE,GAAGC,KAAK,CAAC,GAAGN,OAAO,CAACO,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC;EACtD,MAAMC,OAAO,GAAGH,KAAK,CAACI,IAAI,CAAC,IAAI,CAAC;EAChC,MAAMC,KAAK,GAAG,IAAIC,KAAK,CAACH,OAAO,CAAC;EAChCE,KAAK,CAACN,IAAI,GAAGA,IAAI;EAEjB;EACA,MAAMQ,UAAU,GAAG,EAAE;EACrB,IAAIb,OAAO,CAACc,UAAU,IAAID,UAAU,CAACE,MAAM,GAAGH,KAAK,CAACI,eAAe,EAAE;IACnE,KAAK,MAAMC,KAAK,IAAIjB,OAAO,CAACc,UAAU,CAACI,UAAU,CAACC,OAAO,EAAE,EAAE;MAC3D,IACEtB,SAAA,CAAAuB,YAAY,CAACC,cAAc,CAACJ,KAAK,CAACK,GAAG,CAAC,IACtCL,KAAK,CAACK,GAAG,KAAKzB,SAAA,CAAAuB,YAAY,CAACG,YAAY,EACvC;QACA,MAAMD,GAAG,GAAGzB,SAAA,CAAAuB,YAAY,CAACI,KAAK,CAACP,KAAK,CAACK,GAAG,CAAC;QACzCT,UAAU,CAACY,OAAO,CAChB,UAAUR,KAAK,CAACS,YAAY,IAAIJ,GAAG,CAACI,YAAY,KAC9CJ,GAAG,CAACI,YACN,OAAOJ,GAAG,CAACK,UAAU,iBAAiBV,KAAK,CAACW,UAAU,IACpDX,KAAK,CAACY,YACR,GAAG,CACJ;MACH,CAAC,MAAM;QACLhB,UAAU,CAACiB,IAAI,CACb,UAAUb,KAAK,CAACS,YAAY,IAAI,aAAa,KAAKT,KAAK,CAACK,GAAG,IACzDL,KAAK,CAACW,UACR,IAAIX,KAAK,CAACY,YAAY,GAAG,CAC1B;MACH;MACA,IAAIhB,UAAU,CAACE,MAAM,IAAIH,KAAK,CAACI,eAAe,EAAE;QAC9C;MACF;IACF;EACF;EAEAL,KAAK,CAACoB,KAAK,GAAG,CAAC/B,OAAO,CAACO,IAAI,EAAE,GAAGM,UAAU,CAAC,CAACH,IAAI,CAAC,IAAI,CAAC;EACtD,OAAOC,KAAK;AACd;AA1CAqB,OAAA,CAAAjC,qBAAA,GAAAA,qBAAA;AA4CA;;;AAGA,SAAgBkC,sBAAsBA,CACpCxB,OAAe,EACfyB,EAAU;EAEV,OAAOvB,KAAK,IAAG;IACb,IAAIA,KAAK,YAAYf,WAAA,CAAAuC,aAAa,EAAE;MAClCxB,KAAK,CAACF,OAAO,IAAI,OAAOA,OAAO,EAAE;IACnC,CAAC,MAAM,IAAIE,KAAK,YAAYf,WAAA,CAAAwC,YAAY,EAAE;MACxCzB,KAAK,CAACF,OAAO,GAAG,yBAAyByB,EAAE,cAAc;IAC3D;IACA,MAAMvB,KAAK;EACb,CAAC;AACH;AAZAqB,OAAA,CAAAC,sBAAA,GAAAA,sBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}