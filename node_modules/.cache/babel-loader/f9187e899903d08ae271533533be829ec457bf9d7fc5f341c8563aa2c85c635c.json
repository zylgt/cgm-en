{"ast":null,"code":"import _defineProperty from \"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport \"core-js/modules/es.array.push.js\";\n/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar __addDisposableResource = this && this.__addDisposableResource || function (env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({\n      value: value,\n      dispose: dispose,\n      async: async\n    });\n  } else if (async) {\n    env.stack.push({\n      async: true\n    });\n  }\n  return value;\n};\nvar __disposeResources = this && this.__disposeResources || function (SuppressedError) {\n  return function (env) {\n    function fail(e) {\n      env.error = env.hasError ? new SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n      env.hasError = true;\n    }\n    function next() {\n      while (env.stack.length) {\n        var rec = env.stack.pop();\n        try {\n          var result = rec.dispose && rec.dispose.call(rec.value);\n          if (rec.async) return Promise.resolve(result).then(next, function (e) {\n            fail(e);\n            return next();\n          });\n        } catch (e) {\n          fail(e);\n        }\n      }\n      if (env.hasError) throw env.error;\n    }\n    return next();\n  };\n}(typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n});\nimport { _isElementHandle } from '../api/ElementHandleSymbol.js';\nimport { isErrorLike } from '../util/ErrorLike.js';\nimport { interpolateFunction, stringifyFunction } from '../util/Function.js';\nimport { transposeIterableHandle } from './HandleIterator.js';\nimport { LazyArg } from './LazyArg.js';\n/**\n * @internal\n */\nexport class QueryHandler {\n  static get _querySelector() {\n    if (this.querySelector) {\n      return this.querySelector;\n    }\n    if (!this.querySelectorAll) {\n      throw new Error('Cannot create default `querySelector`.');\n    }\n    return this.querySelector = interpolateFunction(async (node, selector, PuppeteerUtil) => {\n      const querySelectorAll = PLACEHOLDER('querySelectorAll');\n      const results = querySelectorAll(node, selector, PuppeteerUtil);\n      for await (const result of results) {\n        return result;\n      }\n      return null;\n    }, {\n      querySelectorAll: stringifyFunction(this.querySelectorAll)\n    });\n  }\n  static get _querySelectorAll() {\n    if (this.querySelectorAll) {\n      return this.querySelectorAll;\n    }\n    if (!this.querySelector) {\n      throw new Error('Cannot create default `querySelectorAll`.');\n    }\n    return this.querySelectorAll = interpolateFunction(async function* (node, selector, PuppeteerUtil) {\n      const querySelector = PLACEHOLDER('querySelector');\n      const result = await querySelector(node, selector, PuppeteerUtil);\n      if (result) {\n        yield result;\n      }\n    }, {\n      querySelector: stringifyFunction(this.querySelector)\n    });\n  }\n  /**\n   * Queries for multiple nodes given a selector and {@link ElementHandle}.\n   *\n   * Akin to {@link https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll | Document.querySelectorAll()}.\n   */\n  static async *queryAll(element, selector) {\n    const env_1 = {\n      stack: [],\n      error: void 0,\n      hasError: false\n    };\n    try {\n      const handle = __addDisposableResource(env_1, await element.evaluateHandle(this._querySelectorAll, selector, LazyArg.create(context => {\n        return context.puppeteerUtil;\n      })), false);\n      yield* transposeIterableHandle(handle);\n    } catch (e_1) {\n      env_1.error = e_1;\n      env_1.hasError = true;\n    } finally {\n      __disposeResources(env_1);\n    }\n  }\n  /**\n   * Queries for a single node given a selector and {@link ElementHandle}.\n   *\n   * Akin to {@link https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector}.\n   */\n  static async queryOne(element, selector) {\n    const env_2 = {\n      stack: [],\n      error: void 0,\n      hasError: false\n    };\n    try {\n      const result = __addDisposableResource(env_2, await element.evaluateHandle(this._querySelector, selector, LazyArg.create(context => {\n        return context.puppeteerUtil;\n      })), false);\n      if (!(_isElementHandle in result)) {\n        return null;\n      }\n      return result.move();\n    } catch (e_2) {\n      env_2.error = e_2;\n      env_2.hasError = true;\n    } finally {\n      __disposeResources(env_2);\n    }\n  }\n  /**\n   * Waits until a single node appears for a given selector and\n   * {@link ElementHandle}.\n   *\n   * This will always query the handle in the Puppeteer world and migrate the\n   * result to the main world.\n   */\n  static async waitFor(elementOrFrame, selector, options) {\n    const env_3 = {\n      stack: [],\n      error: void 0,\n      hasError: false\n    };\n    try {\n      let frame;\n      const element = __addDisposableResource(env_3, await (async () => {\n        if (!(_isElementHandle in elementOrFrame)) {\n          frame = elementOrFrame;\n          return;\n        }\n        frame = elementOrFrame.frame;\n        return await frame.isolatedRealm().adoptHandle(elementOrFrame);\n      })(), false);\n      const {\n        visible = false,\n        hidden = false,\n        timeout,\n        signal\n      } = options;\n      try {\n        const env_4 = {\n          stack: [],\n          error: void 0,\n          hasError: false\n        };\n        try {\n          signal?.throwIfAborted();\n          const handle = __addDisposableResource(env_4, await frame.isolatedRealm().waitForFunction(async (PuppeteerUtil, query, selector, root, visible) => {\n            const querySelector = PuppeteerUtil.createFunction(query);\n            const node = await querySelector(root ?? document, selector, PuppeteerUtil);\n            return PuppeteerUtil.checkVisibility(node, visible);\n          }, {\n            polling: visible || hidden ? 'raf' : 'mutation',\n            root: element,\n            timeout,\n            signal\n          }, LazyArg.create(context => {\n            return context.puppeteerUtil;\n          }), stringifyFunction(this._querySelector), selector, element, visible ? true : hidden ? false : undefined), false);\n          if (signal?.aborted) {\n            throw signal.reason;\n          }\n          if (!(_isElementHandle in handle)) {\n            return null;\n          }\n          return await frame.mainRealm().transferHandle(handle);\n        } catch (e_3) {\n          env_4.error = e_3;\n          env_4.hasError = true;\n        } finally {\n          __disposeResources(env_4);\n        }\n      } catch (error) {\n        if (!isErrorLike(error)) {\n          throw error;\n        }\n        if (error.name === 'AbortError') {\n          throw error;\n        }\n        error.message = `Waiting for selector \\`${selector}\\` failed: ${error.message}`;\n        throw error;\n      }\n    } catch (e_4) {\n      env_3.error = e_4;\n      env_3.hasError = true;\n    } finally {\n      __disposeResources(env_3);\n    }\n  }\n}\n// Either one of these may be implemented, but at least one must be.\n_defineProperty(QueryHandler, \"querySelectorAll\", void 0);\n_defineProperty(QueryHandler, \"querySelector\", void 0);","map":{"version":3,"names":["_isElementHandle","isErrorLike","interpolateFunction","stringifyFunction","transposeIterableHandle","LazyArg","QueryHandler","_querySelector","querySelector","querySelectorAll","Error","node","selector","PuppeteerUtil","PLACEHOLDER","results","result","_querySelectorAll","queryAll","element","handle","__addDisposableResource","env_1","evaluateHandle","create","context","puppeteerUtil","queryOne","env_2","move","waitFor","elementOrFrame","options","frame","env_3","isolatedRealm","adoptHandle","visible","hidden","timeout","signal","throwIfAborted","env_4","waitForFunction","query","root","createFunction","document","checkVisibility","polling","undefined","aborted","reason","mainRealm","transferHandle","error","name","message","_defineProperty"],"sources":["../../../../src/common/QueryHandler.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}