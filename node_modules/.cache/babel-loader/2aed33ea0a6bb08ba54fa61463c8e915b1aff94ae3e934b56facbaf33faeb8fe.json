{"ast":null,"code":"\"use strict\";\n\nvar _defineProperty = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/defineProperty.js\").default;\nvar _classPrivateFieldInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldInitSpec.js\").default;\nvar _classPrivateFieldGet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldGet2.js\").default;\nvar _classPrivateFieldSet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldSet2.js\").default;\nrequire(\"core-js/modules/web.immediate.js\");\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NodeWebSocketTransport = void 0;\n/**\n * @license\n * Copyright 2018 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nconst ws_1 = __importDefault(require(\"ws\"));\nconst version_js_1 = require(\"../generated/version.js\");\n/**\n * @internal\n */\nvar _ws = /*#__PURE__*/new WeakMap();\nclass NodeWebSocketTransport {\n  static create(url, headers) {\n    return new Promise((resolve, reject) => {\n      const ws = new ws_1.default(url, [], {\n        followRedirects: true,\n        perMessageDeflate: false,\n        maxPayload: 256 * 1024 * 1024,\n        // 256Mb\n        headers: {\n          'User-Agent': `Puppeteer ${version_js_1.packageVersion}`,\n          ...headers\n        }\n      });\n      ws.addEventListener('open', () => {\n        return resolve(new NodeWebSocketTransport(ws));\n      });\n      ws.addEventListener('error', reject);\n    });\n  }\n  constructor(ws) {\n    _classPrivateFieldInitSpec(this, _ws, void 0);\n    _defineProperty(this, \"onmessage\", void 0);\n    _defineProperty(this, \"onclose\", void 0);\n    _classPrivateFieldSet(_ws, this, ws);\n    _classPrivateFieldGet(_ws, this).addEventListener('message', event => {\n      setImmediate(() => {\n        if (this.onmessage) {\n          this.onmessage.call(null, event.data);\n        }\n      });\n    });\n    _classPrivateFieldGet(_ws, this).addEventListener('close', () => {\n      setImmediate(() => {\n        if (this.onclose) {\n          this.onclose.call(null);\n        }\n      });\n    });\n    // Silently ignore all errors - we don't know what to do with them.\n    _classPrivateFieldGet(_ws, this).addEventListener('error', () => {});\n  }\n  send(message) {\n    _classPrivateFieldGet(_ws, this).send(message);\n  }\n  close() {\n    _classPrivateFieldGet(_ws, this).close();\n  }\n}\nexports.NodeWebSocketTransport = NodeWebSocketTransport;","map":{"version":3,"names":["ws_1","__importDefault","require","version_js_1","_ws","WeakMap","NodeWebSocketTransport","create","url","headers","Promise","resolve","reject","ws","default","followRedirects","perMessageDeflate","maxPayload","packageVersion","addEventListener","constructor","_classPrivateFieldInitSpec","_defineProperty","_classPrivateFieldSet","_classPrivateFieldGet","event","setImmediate","onmessage","call","data","onclose","send","message","close","exports"],"sources":["../../../../src/node/NodeWebSocketTransport.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;AAAA;;;;;AAKA,MAAAA,IAAA,GAAAC,eAAA,CAAAC,OAAA;AAGA,MAAAC,YAAA,GAAAD,OAAA;AAEA;;;AAAA,IAAAE,GAAA,oBAAAC,OAAA;AAGA,MAAaC,sBAAsB;EACjC,OAAOC,MAAMA,CACXC,GAAW,EACXC,OAAgC;IAEhC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;MACrC,MAAMC,EAAE,GAAG,IAAIb,IAAA,CAAAc,OAAa,CAACN,GAAG,EAAE,EAAE,EAAE;QACpCO,eAAe,EAAE,IAAI;QACrBC,iBAAiB,EAAE,KAAK;QACxBC,UAAU,EAAE,GAAG,GAAG,IAAI,GAAG,IAAI;QAAE;QAC/BR,OAAO,EAAE;UACP,YAAY,EAAE,aAAaN,YAAA,CAAAe,cAAc,EAAE;UAC3C,GAAGT;;OAEN,CAAC;MAEFI,EAAE,CAACM,gBAAgB,CAAC,MAAM,EAAE,MAAK;QAC/B,OAAOR,OAAO,CAAC,IAAIL,sBAAsB,CAACO,EAAE,CAAC,CAAC;MAChD,CAAC,CAAC;MACFA,EAAE,CAACM,gBAAgB,CAAC,OAAO,EAAEP,MAAM,CAAC;IACtC,CAAC,CAAC;EACJ;EAMAQ,YAAYP,EAAiB;IAAAQ,0BAAA,OAAAjB,GAAA;IAAAkB,eAAA;IAAAA,eAAA;IAC3BC,qBAAA,CAAAnB,GAAA,MAAI,EAAOS,EAAE;IACbW,qBAAA,CAAApB,GAAA,MAAI,EAAKe,gBAAgB,CAAC,SAAS,EAAEM,KAAK,IAAG;MAC3CC,YAAY,CAAC,MAAK;QAChB,IAAI,IAAI,CAACC,SAAS,EAAE;UAClB,IAAI,CAACA,SAAS,CAACC,IAAI,CAAC,IAAI,EAAEH,KAAK,CAACI,IAAI,CAAC;QACvC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IACFL,qBAAA,CAAApB,GAAA,MAAI,EAAKe,gBAAgB,CAAC,OAAO,EAAE,MAAK;MACtCO,YAAY,CAAC,MAAK;QAChB,IAAI,IAAI,CAACI,OAAO,EAAE;UAChB,IAAI,CAACA,OAAO,CAACF,IAAI,CAAC,IAAI,CAAC;QACzB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IACF;IACAJ,qBAAA,CAAApB,GAAA,MAAI,EAAKe,gBAAgB,CAAC,OAAO,EAAE,MAAK,CAAE,CAAC,CAAC;EAC9C;EAEAY,IAAIA,CAACC,OAAe;IAClBR,qBAAA,CAAApB,GAAA,MAAI,EAAK2B,IAAI,CAACC,OAAO,CAAC;EACxB;EAEAC,KAAKA,CAAA;IACHT,qBAAA,CAAApB,GAAA,MAAI,EAAK6B,KAAK,EAAE;EAClB;;AArDFC,OAAA,CAAA5B,sBAAA,GAAAA,sBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}