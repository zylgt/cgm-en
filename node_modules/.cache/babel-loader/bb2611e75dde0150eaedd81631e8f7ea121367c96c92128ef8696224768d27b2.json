{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/web.url-search-params.delete.js\");\nrequire(\"core-js/modules/web.url-search-params.has.js\");\nrequire(\"core-js/modules/web.url-search-params.size.js\");\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sandbox = exports.createPacResolver = void 0;\nconst degenerator_1 = require(\"degenerator\");\n/**\n * Built-in PAC functions.\n */\nconst dateRange_1 = __importDefault(require(\"./dateRange\"));\nconst dnsDomainIs_1 = __importDefault(require(\"./dnsDomainIs\"));\nconst dnsDomainLevels_1 = __importDefault(require(\"./dnsDomainLevels\"));\nconst dnsResolve_1 = __importDefault(require(\"./dnsResolve\"));\nconst isInNet_1 = __importDefault(require(\"./isInNet\"));\nconst isPlainHostName_1 = __importDefault(require(\"./isPlainHostName\"));\nconst isResolvable_1 = __importDefault(require(\"./isResolvable\"));\nconst localHostOrDomainIs_1 = __importDefault(require(\"./localHostOrDomainIs\"));\nconst myIpAddress_1 = __importDefault(require(\"./myIpAddress\"));\nconst shExpMatch_1 = __importDefault(require(\"./shExpMatch\"));\nconst timeRange_1 = __importDefault(require(\"./timeRange\"));\nconst weekdayRange_1 = __importDefault(require(\"./weekdayRange\"));\n/**\n * Returns an asynchronous `FindProxyForURL()` function\n * from the given JS string (from a PAC file).\n */\nfunction createPacResolver(qjs, _str, _opts = {}) {\n  const str = Buffer.isBuffer(_str) ? _str.toString('utf8') : _str;\n  // The sandbox to use for the `vm` context.\n  const context = {\n    ...exports.sandbox,\n    ..._opts.sandbox\n  };\n  // Construct the array of async function names to add `await` calls to.\n  const names = Object.keys(context).filter(k => isAsyncFunction(context[k]));\n  const opts = {\n    filename: 'proxy.pac',\n    names,\n    ..._opts,\n    sandbox: context\n  };\n  // Compile the JS `FindProxyForURL()` function into an async function.\n  const resolver = (0, degenerator_1.compile)(qjs, str, 'FindProxyForURL', opts);\n  function FindProxyForURL(url, _host) {\n    const urlObj = typeof url === 'string' ? new URL(url) : url;\n    const host = _host || urlObj.hostname;\n    if (!host) {\n      throw new TypeError('Could not determine `host`');\n    }\n    return resolver(urlObj.href, host);\n  }\n  Object.defineProperty(FindProxyForURL, 'toString', {\n    value: () => resolver.toString(),\n    enumerable: false\n  });\n  return FindProxyForURL;\n}\nexports.createPacResolver = createPacResolver;\nexports.sandbox = Object.freeze({\n  alert: (message = '') => console.log('%s', message),\n  dateRange: dateRange_1.default,\n  dnsDomainIs: dnsDomainIs_1.default,\n  dnsDomainLevels: dnsDomainLevels_1.default,\n  dnsResolve: dnsResolve_1.default,\n  isInNet: isInNet_1.default,\n  isPlainHostName: isPlainHostName_1.default,\n  isResolvable: isResolvable_1.default,\n  localHostOrDomainIs: localHostOrDomainIs_1.default,\n  myIpAddress: myIpAddress_1.default,\n  shExpMatch: shExpMatch_1.default,\n  timeRange: timeRange_1.default,\n  weekdayRange: weekdayRange_1.default\n});\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction isAsyncFunction(v) {\n  if (typeof v !== 'function') return false;\n  // Native `AsyncFunction`\n  if (v.constructor.name === 'AsyncFunction') return true;\n  // TypeScript compiled\n  if (String(v).indexOf('__awaiter(') !== -1) return true;\n  // Legacy behavior - set `async` property on the function\n  return Boolean(v.async);\n}","map":{"version":3,"names":["degenerator_1","require","dateRange_1","__importDefault","dnsDomainIs_1","dnsDomainLevels_1","dnsResolve_1","isInNet_1","isPlainHostName_1","isResolvable_1","localHostOrDomainIs_1","myIpAddress_1","shExpMatch_1","timeRange_1","weekdayRange_1","createPacResolver","qjs","_str","_opts","str","Buffer","isBuffer","toString","context","exports","sandbox","names","Object","keys","filter","k","isAsyncFunction","opts","filename","resolver","compile","FindProxyForURL","url","_host","urlObj","URL","host","hostname","TypeError","href","defineProperty","value","enumerable","freeze","alert","message","console","log","dateRange","default","dnsDomainIs","dnsDomainLevels","dnsResolve","isInNet","isPlainHostName","isResolvable","localHostOrDomainIs","myIpAddress","shExpMatch","timeRange","weekdayRange","v","constructor","name","String","indexOf","Boolean","async"],"sources":["../src/index.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}