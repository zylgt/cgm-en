{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar _classPrivateFieldInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldInitSpec.js\").default;\nvar _classPrivateFieldGet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldGet2.js\").default;\nvar _classPrivateFieldSet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldSet2.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CdpBrowserContext = void 0;\nconst Browser_js_1 = require(\"../api/Browser.js\");\nconst BrowserContext_js_1 = require(\"../api/BrowserContext.js\");\nconst assert_js_1 = require(\"../util/assert.js\");\n/**\n * @internal\n */\nvar _connection = /*#__PURE__*/new WeakMap();\nvar _browser = /*#__PURE__*/new WeakMap();\nvar _id = /*#__PURE__*/new WeakMap();\nclass CdpBrowserContext extends BrowserContext_js_1.BrowserContext {\n  constructor(connection, browser, contextId) {\n    super();\n    _classPrivateFieldInitSpec(this, _connection, void 0);\n    _classPrivateFieldInitSpec(this, _browser, void 0);\n    _classPrivateFieldInitSpec(this, _id, void 0);\n    _classPrivateFieldSet(_connection, this, connection);\n    _classPrivateFieldSet(_browser, this, browser);\n    _classPrivateFieldSet(_id, this, contextId);\n  }\n  get id() {\n    return _classPrivateFieldGet(_id, this);\n  }\n  targets() {\n    return _classPrivateFieldGet(_browser, this).targets().filter(target => {\n      return target.browserContext() === this;\n    });\n  }\n  async pages() {\n    const pages = await Promise.all(this.targets().filter(target => {\n      return target.type() === 'page' || target.type() === 'other' && _classPrivateFieldGet(_browser, this)._getIsPageTargetCallback()?.(target);\n    }).map(target => {\n      return target.page();\n    }));\n    return pages.filter(page => {\n      return !!page;\n    });\n  }\n  isIncognito() {\n    return !!_classPrivateFieldGet(_id, this);\n  }\n  async overridePermissions(origin, permissions) {\n    const protocolPermissions = permissions.map(permission => {\n      const protocolPermission = Browser_js_1.WEB_PERMISSION_TO_PROTOCOL_PERMISSION.get(permission);\n      if (!protocolPermission) {\n        throw new Error('Unknown permission: ' + permission);\n      }\n      return protocolPermission;\n    });\n    await _classPrivateFieldGet(_connection, this).send('Browser.grantPermissions', {\n      origin,\n      browserContextId: _classPrivateFieldGet(_id, this) || undefined,\n      permissions: protocolPermissions\n    });\n  }\n  async clearPermissionOverrides() {\n    await _classPrivateFieldGet(_connection, this).send('Browser.resetPermissions', {\n      browserContextId: _classPrivateFieldGet(_id, this) || undefined\n    });\n  }\n  newPage() {\n    return _classPrivateFieldGet(_browser, this)._createPageInContext(_classPrivateFieldGet(_id, this));\n  }\n  browser() {\n    return _classPrivateFieldGet(_browser, this);\n  }\n  async close() {\n    (0, assert_js_1.assert)(_classPrivateFieldGet(_id, this), 'Non-incognito profiles cannot be closed!');\n    await _classPrivateFieldGet(_browser, this)._disposeContext(_classPrivateFieldGet(_id, this));\n  }\n}\nexports.CdpBrowserContext = CdpBrowserContext;","map":{"version":3,"names":["_classPrivateFieldInitSpec","require","default","_classPrivateFieldGet","_classPrivateFieldSet","Browser_js_1","BrowserContext_js_1","assert_js_1","_connection","WeakMap","_browser","_id","CdpBrowserContext","BrowserContext","constructor","connection","browser","contextId","id","targets","filter","target","browserContext","pages","Promise","all","type","_getIsPageTargetCallback","map","page","isIncognito","overridePermissions","origin","permissions","protocolPermissions","permission","protocolPermission","WEB_PERMISSION_TO_PROTOCOL_PERMISSION","get","Error","send","browserContextId","undefined","clearPermissionOverrides","newPage","_createPageInContext","close","assert","_disposeContext","exports"],"sources":["../../../../src/cdp/BrowserContext.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}