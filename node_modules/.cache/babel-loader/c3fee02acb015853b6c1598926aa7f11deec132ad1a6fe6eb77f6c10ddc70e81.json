{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { formatDate, formatTime } from '@/utils/formatTime';\nimport { AGPUtils } from \"@/utils/algorithm/AGP\";\nimport { TIRUtils } from \"@/utils/algorithm/TIR\";\nimport { GlucoseUtils } from \"@/utils/algorithm/Glucose\";\nimport TIR from '@/views/components/Chart/TIR';\nimport TIPCOPY from '@/views/components/Chart/TIR_COPY';\nimport AGP from '@/views/components/Chart/AGPchart';\nimport DayChart from '@/views/components/Chart/DayChart';\nimport mixin from \"./mixin\";\nexport default {\n  data() {\n    return {\n      agpDates: '',\n      loading: false,\n      tirVisible: false,\n      agpVisible: false,\n      dayVisible: false,\n      info: {\n        nickname: '',\n        diabetes_type: '',\n        age: '',\n        diabetes_year: '',\n        glucose_range_lower_limit: '',\n        device_mac: '',\n        phone_model: '',\n        nowdate: ''\n      },\n      nowdate: '',\n      agpdayList: [],\n      //每日血糖\n      tir: {},\n      //tir\n      agpList: {},\n      //agp\n      bgInfo: {} //血糖数据\n    };\n  },\n  mixins: [mixin],\n  components: {\n    TIR,\n    AGP,\n    DayChart\n  },\n  created() {},\n  mounted() {},\n  methods: {\n    // 打开解释弹窗\n    openPopover(key) {\n      switch (key) {\n        case 'tir':\n          this.tirVisible = true;\n          this.agpVisible = false;\n          this.dayVisible = false;\n          break;\n        case 'agp':\n          this.tirVisible = false;\n          this.dayVisible = false;\n          this.agpVisible = true;\n          break;\n        case 'day':\n          this.dayVisible = true;\n          this.tirVisible = false;\n          this.agpVisible = false;\n          break;\n      }\n    },\n    // 自组件需要的数据\n    handelTemplateDay(data) {\n      this.handelAgp(data);\n      this.handelTir(data);\n      this.handelDay(data);\n      this.handelBg(data);\n    },\n    // agp图谱\n    handelAgp(data) {\n      let datArray = _.cloneDeep(data);\n      let newArr = [];\n      datArray.forEach((item, index) => {\n        if (index == index % 1440) {\n          newArr.push([datArray[index].Value]);\n        } else {\n          newArr[index % 1440].push(datArray[index].Value);\n        }\n      });\n      function momentAgp05(val) {\n        val = _.compact(val);\n        return AGPUtils.calculateYValue(val) ? AGPUtils.calculateYValue(val).p05 : AGPUtils.calculateYValue(val);\n      }\n      function momentAgp25(val) {\n        val = _.compact(val);\n        return AGPUtils.calculateYValue(val) ? AGPUtils.calculateYValue(val).p25 : AGPUtils.calculateYValue(val);\n      }\n      function momentAgp50(val) {\n        val = _.compact(val);\n        return AGPUtils.calculateYValue(val) ? AGPUtils.calculateYValue(val).p50 : AGPUtils.calculateYValue(val);\n      }\n      function momentAgp75(val) {\n        val = _.compact(val);\n        return AGPUtils.calculateYValue(val) ? AGPUtils.calculateYValue(val).p75 : AGPUtils.calculateYValue(val);\n      }\n      function momentAgp95(val) {\n        val = _.compact(val);\n        return AGPUtils.calculateYValue(val) ? AGPUtils.calculateYValue(val).p95 : AGPUtils.calculateYValue(val);\n      }\n      let xData = Array.from({\n        length: 60 * 24\n      }, (item, index) => index);\n      let agp05 = _.map(newArr, momentAgp05);\n      let agp25 = _.map(newArr, momentAgp25);\n      let agp50 = _.map(newArr, momentAgp50);\n      let agp75 = _.map(newArr, momentAgp75);\n      let agp95 = _.map(newArr, momentAgp95);\n      let params = {\n        xData: xData,\n        agp05: agp05,\n        agp25: agp25,\n        agp50: agp50,\n        agp75: agp75,\n        agp95: agp95\n      };\n      this.agpList = params;\n    },\n    // tir\n    handelTir(data) {\n      let datArray = _.cloneDeep(data);\n      let new_data = _.uniqBy(datArray, 'DataTs');\n      let v_data = _.map(new_data, 'Value');\n      let result = TIRUtils.getTIRResult(v_data);\n      this.tir = result;\n    },\n    // 每日血糖\n    handelDay(data) {\n      let datArray = _.cloneDeep(data);\n      let singleDay = _.chunk(datArray, 60 * 24);\n      let max = _.maxBy(datArray, 'Value').Value > 400 ? 400 : _.maxBy(datArray, 'Value').Value;\n      let dayList = new Array();\n      singleDay.forEach(item => {\n        let value = _.map(item, 'Value');\n        dayList.push({\n          day: formatDate(item[0].DataTs * 1000, 'mm.dd'),\n          week: formatDate(item[0].DataTs * 1000, 'WW'),\n          value: value,\n          max: max,\n          tir: TIRUtils.getTIRResult(value) ? (Number(TIRUtils.getTIRResult(value).normalRate) * 100).toFixed(1) : ''\n        });\n      });\n      this.agpdayList = dayList;\n    },\n    // 血糖数据\n    handelBg(data) {\n      let datArray = _.cloneDeep(data);\n      let bgInfo = GlucoseUtils.calculateMeanCvGmi(_.map(datArray, 'Value'));\n      bgInfo.mean = Math.round(bgInfo.mean);\n      let unit = this.unit;\n      if (unit == 'mmol/L') {\n        bgInfo.mean = GlucoseUtils.mgdlToMmol(bgInfo.mean);\n      }\n      let filteredArray = dataArray.filter(val => val >= 40 && val <= 400);\n      bgInfo.effective = _.round(filteredArray.length / dataArray.length * 100, 1);\n      this.bgInfo = bgInfo;\n      console.loh(this.bgInfo);\n    }\n  }\n};","map":{"version":3,"names":["formatDate","formatTime","AGPUtils","TIRUtils","GlucoseUtils","TIR","TIPCOPY","AGP","DayChart","mixin","data","agpDates","loading","tirVisible","agpVisible","dayVisible","info","nickname","diabetes_type","age","diabetes_year","glucose_range_lower_limit","device_mac","phone_model","nowdate","agpdayList","tir","agpList","bgInfo","mixins","components","created","mounted","methods","openPopover","key","handelTemplateDay","handelAgp","handelTir","handelDay","handelBg","datArray","_","cloneDeep","newArr","forEach","item","index","push","Value","momentAgp05","val","compact","calculateYValue","p05","momentAgp25","p25","momentAgp50","p50","momentAgp75","p75","momentAgp95","p95","xData","Array","from","length","agp05","map","agp25","agp50","agp75","agp95","params","new_data","uniqBy","v_data","result","getTIRResult","singleDay","chunk","max","maxBy","dayList","value","day","DataTs","week","Number","normalRate","toFixed","calculateMeanCvGmi","mean","Math","round","unit","mgdlToMmol","filteredArray","dataArray","filter","effective","console","loh"],"sources":["src/views/report/AGP.vue"],"sourcesContent":["<template>\n    <div class='agp' v-loading='loading'>\n        <div class='agp-main' >\n            <div class='agp-top' >\n                <div class='agp-top-fl' >\n                    <div class='report-title'> {{$t('message.route.'+$route.meta.title)}}</div>\n                    \n                </div>\n                <div class='agp-fr' >\n                    <img src=\"~@/assets/image/printer.png\" alt=\"\" class='agp-icon' @click='print' >\n                    <img src=\"~@/assets/image/down-icon.png\" alt=\"\" class='agp-icon' @click='handleExport' >\n                    <img src=\"~@/assets/image/share.png\" alt=\"\" class='agp-icon agp-fr-icon'>\n                    <el-button type=\"primary\" @click=\"upload\">\n                        <img src=\"~@/assets/image/btn-upload.png\" alt=\"\" class='btn-upload' >\n                        上传数据\n                    </el-button>\n                </div>\n            </div>\n            <div class='report-agp-date' >\n                    <img src=\"~@/assets/image/date-calendar.png\" alt=\"\" class='agp-icon' >\n                    <div class='agp-date' >{{agpDate[0]}} — {{agpDate[1]}}（{{dayDate}}天）</div>\n                     <img src=\"~@/assets/image/select-icon.png\" alt=\"\" class='select-icon' >\n                    <el-date-picker\n                        class='agp-picker'\n                        v-model=\"agpDate\"\n                        type=\"daterange\"\n                        align=\"right\"\n                        unlink-panels\n                        range-separator=\"至\"\n                        start-placeholder=\"开始日期\"\n                        end-placeholder=\"结束日期\"\n                        value-format=\"yyyy-MM-dd\"\n                        format=\"yyyy-MM-dd\"\n                        @change=\"changeDate\"\n                        :picker-options=\"pickerOptions\">\n                    </el-date-picker>\n            </div>\n              <!-- 基本信息 -->\n            <div class='agp-cont-main'>\n                <div class='cgm-cont-title'><span class='title-border' ></span>基本信息</div>\n                <div class='report-base-user' >\n                    <div class='report-base-user-item' >\n                        <div class='report-base-user-label'>姓名：</div>\n                        <div class='report-base-user-value'>{{info.nickname?info.nickname:'--'}}</div>\n                    </div>  \n                    <div class='report-base-user-item' >\n                        <div class='report-base-user-label'>年龄：</div>\n                        <div class='report-base-user-value'>{{info.age?info.age:'--'}}</div>\n                    </div>  \n                    <div class='report-base-user-item' >\n                        <div class='report-base-user-label'>糖尿病类型：</div>\n                        <div class='report-base-user-value'>{{info.diabetes_type?info.diabetes_type:'--'}}</div>\n                    </div>  \n                    <div class='report-base-user-item' >\n                        <div class='report-base-user-label'>病程：</div>\n                        <div class='report-base-user-value'>{{info.diabetes_year?info.diabetes_year:'--'}}</div>\n                    </div>  \n                    <div class='report-base-user-item' >\n                        <div class='report-base-user-label'>葡萄糖目标范围：</div>\n                        <div class='report-base-user-value'>{{info.glucose_range_lower_limit}}-{{info.glucose_range_lupper_limit}}{{unit}}</div>\n                    </div>  \n                </div>\n                <div class='report-data-source'>\n                    <div class='report-base-user-item' >\n                        <div class='report-base-user-label'>传感器序列号</div>\n                    </div>  \n                    <div class='report-base-user-item1' >\n                        <div class='report-base-user-label'>数据来源</div>\n                    </div>  \n                    <div class='report-base-user-item2' >\n                        <div class='report-base-user-label'>同步时间</div>\n                    </div>  \n                </div>\n                 <div class='report-data-sources'>\n                    <div class='report-base-user-item' >\n                        <div class='report-base-user-value'>1234567</div>\n                    </div>  \n                    <div class='report-base-user-item1' >\n                        <div class='report-base-user-value'>iPhone13</div>\n                    </div>  \n                    <div class='report-base-user-item2' >\n                        <div class='report-base-user-value'>2023-09-17</div>\n                    </div>  \n                </div>\n            </div>\n            <div class='agp-cont' id='overviewpage'>\n                <el-row type=\"flex\" justify=\"space-between\">\n                    <el-col :span=\"12\" class='agp-cont-main agp-cont-main1' >\n                        <div class='cgm-cont-title'>  <span class='title-border' ></span>血糖数据</div>\n                        <!-- <div class='cgm-agp-info-box cgm-agp-info-box1'>\n                            <div class='cgm-agp-info'></div>\n                            <img src=\"~@/assets/image/reason-icon.png\" alt=\"\" class='reason-icon' >\n                        </div> -->\n                        <div class='bg-data-item' >\n                            <div class='bg-data-label' >\n                                <div>CGM佩戴天数</div>\n                                <div class='bg-data-tip' ></div>\n                            </div>\n                            <div class='bg-data-val' >2023-10-30</div>\n                        </div>\n                        <div class='bg-data-item' >\n                            <div class='bg-data-label' >\n                                <div>CGM有效记录的时间占比：</div>\n                                <div class='bg-data-tip' >目标值>70%才可得到有效数据分析</div>\n                            </div>\n                            <div class='bg-data-val' >{{bgInfo.effective}}</div>\n                        </div>\n                        <div class='bg-data-item' >\n                             <div class='bg-data-label' >\n                                <div>MG平均葡萄糖值：</div>\n                                <div class='bg-data-tip' >将通过系统通知提醒您</div>\n                            </div>\n                            <div class='bg-data-val' >{{bgInfo.mean}}</div>\n                        </div>\n                        <div class='bg-data-item' >\n                            <div class='bg-data-label' >\n                                <div>GMI葡萄糖管理指标：</div>\n                                <div class='bg-data-tip' >目标值＜7%</div>\n                            </div>\n                            <div class='bg-data-val' >{{bgInfo.GMI}}</div>\n                        </div>\n                        <div class='bg-data-item' >\n                             <div class='bg-data-label' >\n                                <div>CV变异系数：</div>\n                                <div class='bg-data-tip' >目标值＜33%</div>\n                            </div>\n                            <div class='bg-data-val' >{{bgInfo.CV}}</div>\n                        </div>\n                    </el-col>\n                    <el-col :span=\"12\" class='agp-cont-main agp-cont-main1'>\n                        <div class='cgm-cont-title'>  <span class='title-border' ></span>葡萄糖目标范围内时间</div>\n                        <div class='cgm-agp-info-box'>\n                            <div class='cgm-agp-info'>葡萄糖目标范围内占比越高，代表血糖控制的越好。</div>\n                            <img src=\"~@/assets/image/reason-icon.png\" alt=\"\" class='reason-icon'  v-popover:tirPopover @click='openPopover(\"tir\")' >\n                        </div>\n                        <TIR :dataList='tir'/>\n                        <!-- <TIPCOPY/> -->\n                    </el-col>\n                </el-row>\n                <div class='agp-cont-main' >\n                    <div class='cgm-cont-title'><span class='title-border' ></span>AGP图谱</div>\n                    <div class='cgm-agp-info-box'>\n                        <div class='cgm-agp-info'>中位数葡萄糖曲位于目标范围内，且越平坦，表示血糖稳定性越好。25%-75%区间（图中深蓝色区域）与5%-95%区间（图中浅蓝色区域）均显示日间血糖波动情况，区间越宽提示相应时间段血糖波动越大。其中影响 25%-75%区间的因素主要是是生理状态(如胰岛素抵抗等)和药物治疗等。影响5%-95%区间的因素主要是饮食，运动等。</div>\n                        <img src=\"~@/assets/image/reason-icon.png\" alt=\"\" class='reason-icon'  v-popover:agpPopover @click='openPopover(\"agp\")'>\n                    </div>\n                    <AGP  :dataList='agpList' :height='370'/>\n               </div>\n               <div class='agp-cont-main' >\n                    <div class='cgm-cont-title'><span class='title-border' ></span>每日血糖曲线</div>\n                    <div class='cgm-agp-info-box'>\n                        <div class='cgm-agp-info'>每日血糖展示了14天中每天的血糖变化情况。</div>\n                        <img src=\"~@/assets/image/reason-icon.png\" alt=\"\" class='reason-icon' v-popover:dayPopover @click='openPopover(\"day\")'>\n                    </div>\n                    <DayChart :dataList='agpdayList'/>\n               </div>\n            </div>\n        </div>\n        <!-- 解释弹窗 -->\n        <el-popover\n            ref=\"tirPopover\"\n            placement=\"top\"\n            width=\"550\"\n            v-model='tirVisible'\n            trigger=\"manual\">\n            <div class='slot-popover' >\n                <div class='slot-popover-title' >数据分析</div>\n                <div class='slot-popover-cont'>内容暂定</div>\n                <div class='slot-popover-btn'>\n                     <el-button type=\"primary\" @click='tirVisible=false' >我知道了</el-button>\n                </div>\n            </div>\n        </el-popover>\n        <el-popover\n            ref=\"agpPopover\"\n            placement=\"top\"\n            width=\"550\"\n            v-model='agpVisible'\n            trigger=\"manual\">\n            <div class='slot-popover' >\n                <div class='slot-popover-title' >AGP图谱</div>\n                <div class='slot-popover-cont'>\n                    1、AGP图谱又称动态葡萄糖图谱，是以1个标准日(24h)的形式将多天的血糖监测数据叠加在相应时间点呈现，由5个平滑曲线表示血糖监测系统的数据，1个葡萄糖目标范围协助判断血糖是否达标。<br/>\n                    2、中位数葡萄糖曲线反映了日内葡萄糖波动情况，曲线越平坦表示血糖稳定性越好。中位线葡萄糖曲线是否处于葡萄糖目标范围内，也进一步提示血糖控制达标情况。<br/>\n                    3、由第 25和第75百分位数两条曲线组成25%-75%区间由第5和 95 百分位数两条曲线组成的5%-95%区间，均显示日间血糖波动情况，区间越宽提示相应时间段血糖波动越大，其中影响 25%-75%区间的因素主要是是生理状态(如胰岛素抵抗等)和药物治疗等。影响5%-95%区间的因素主要是饮食，运动等。<br/>\n                </div>\n                <div class='slot-popover-btn'>\n                     <el-button type=\"primary\" @click='agpVisible=false' >我知道了</el-button>\n                </div>\n            </div>\n        </el-popover>\n        <el-popover\n            ref=\"dayPopover\"\n            placement=\"top\"\n            width=\"550\"\n            v-model='dayVisible'\n            trigger=\"manual\">\n            <div class='slot-popover' >\n                <div class='slot-popover-title' >每日血糖</div>\n                <div class='slot-popover-cont'>\n                    1、AGP图谱又称动态葡萄糖图谱，是以1个标准日(24h)的形式将多天的血糖监测数据叠加在相应时间点呈现，由5个平滑曲线表示血糖监测系统的数据，1个葡萄糖目标范围协助判断血糖是否达标。<br/>\n                    2、中位数葡萄糖曲线反映了日内葡萄糖波动情况，曲线越平坦表示血糖稳定性越好。中位线葡萄糖曲线是否处于葡萄糖目标范围内，也进一步提示血糖控制达标情况。<br/>\n                    3、由第 25和第75百分位数两条曲线组成25%-75%区间由第5和 95 百分位数两条曲线组成的5%-95%区间，均显示日间血糖波动情况，区间越宽提示相应时间段血糖波动越大，其中影响 25%-75%区间的因素主要是是生理状态(如胰岛素抵抗等)和药物治疗等。影响5%-95%区间的因素主要是饮食，运动等。<br/>\n                </div>\n                <div class='slot-popover-btn'>\n                     <el-button type=\"primary\" @click='dayVisible=false' >我知道了</el-button>\n                </div>\n            </div>\n        </el-popover>\n        <!-- 下载打印弹窗 -->\n        <el-dialog\n        :visible.sync=\"dialogVisible\"\n        :show-close=\"false\"\n        :title='dialogType==\"print\"?\"打印报告\":\"下载报告\"'\n        width=\"1060\"\n        >\n            <div class='slot-popover'  id='popover'>\n                <div class='slot-popover-cont slot-popover-conts'>\n                    <div class='report-agp-date report-agp-dates' >\n                            <img src=\"~@/assets/image/date-calendar.png\" alt=\"\" class='agp-icon' >\n                            <div class='agp-date' >{{agpDate[0]}} — {{agpDate[1]}}（4天）</div>\n                            <img src=\"~@/assets/image/select-icon.png\" alt=\"\" class='select-icon' >\n                            <el-date-picker\n                                class='agp-picker'\n                                v-model=\"agpDate\"\n                                type=\"daterange\"\n                                align=\"right\"\n                                unlink-panels\n                                range-separator=\"至\"\n                                start-placeholder=\"开始日期\"\n                                end-placeholder=\"结束日期\"\n                                value-format=\"yyyy-MM-dd\"\n                                format=\"yyyy-MM-dd\"\n                                @change=\"changeDate\"\n                                :picker-options=\"pickerOptions\">\n                            </el-date-picker>\n                    </div>\n                    <div class='popover-cont-label' >\n                        <div class='popover-cont-label-label' v-if='dialogType==\"print\"'>请选择您想要打印的报告内容：</div>\n                        <div class='popover-cont-label-label' v-else>请选择您想要下载的报告内容：</div>\n                         <el-checkbox :indeterminate=\"isIndeterminate\" v-model=\"checkAll\" @change=\"handleCheckAllChange\">全选</el-checkbox>\n                    </div>\n                    <el-checkbox-group v-model=\"checkedDowns\" @change=\"handleCheckedCitiesChange\">\n                        <el-checkbox v-for=\"item in downloadList\" :label=\"item\" :key=\"item\">{{item}}</el-checkbox>\n                    </el-checkbox-group>\n                </div>\n                <div class='slot-popover-btn'>\n                    <el-button type=\"primary\" v-if='dialogType==\"print\"'>打印报告</el-button>\n                    <el-button type=\"primary\" v-else>下载报告</el-button>\n                </div>\n            </div>\n            <img src=\"~@/assets/image/close-icon.png\" alt=\"\" class='dialog-close' @click='dialogVisible=false' >\n        </el-dialog>\n    </div>\n</template>\n<script>\nimport {formatDate,formatTime} from '@/utils/formatTime'\nimport { AGPUtils } from \"@/utils/algorithm/AGP\";\nimport { TIRUtils } from \"@/utils/algorithm/TIR\";\nimport { GlucoseUtils } from \"@/utils/algorithm/Glucose\";\nimport TIR from '@/views/components/Chart/TIR'\nimport TIPCOPY from '@/views/components/Chart/TIR_COPY'\nimport AGP from '@/views/components/Chart/AGPchart'\nimport DayChart from '@/views/components/Chart/DayChart'\nimport mixin from \"./mixin\"\nexport default {\n    data(){\n        return{\n            agpDates:'',\n            loading:false,\n            tirVisible:false,\n            agpVisible:false,\n            dayVisible:false,\n            info:{\n                nickname:'',\n                diabetes_type:'',\n                age:'',\n                diabetes_year:'',\n                glucose_range_lower_limit:'',\n                device_mac:'',\n                phone_model:'',\n                nowdate:''\n            },\n            nowdate:'',\n            agpdayList:[],//每日血糖\n            tir:{},//tir\n            agpList:{},//agp\n            bgInfo:{},//血糖数据\n        }\n    },\n     mixins: [mixin],\n    components: {\n        TIR,AGP,DayChart\n    },\n    created(){\n\n    },\n    mounted(){\n\n    },\n    methods:{\n        // 打开解释弹窗\n        openPopover(key){\n            switch(key){\n                case 'tir':\n                    this.tirVisible = true\n                    this.agpVisible = false\n                    this.dayVisible = false\n                    break;\n                case 'agp':\n                    this.tirVisible = false\n                    this.dayVisible = false\n                    this.agpVisible = true\n                    break;\n                case 'day':\n                    this.dayVisible = true\n                    this.tirVisible = false\n                    this.agpVisible = false\n                    break;\n            }\n        },\n        // 自组件需要的数据\n        handelTemplateDay(data){\n            this.handelAgp(data)\n            this.handelTir(data)\n            this.handelDay(data)\n            this.handelBg(data)\n        },\n        // agp图谱\n        handelAgp(data){\n            let datArray = _.cloneDeep(data)\n            let newArr = []\n            datArray.forEach((item,index)=>{\n                if(index == index%1440){\n                    newArr.push([datArray[index].Value])\n                }else{\n                    newArr[index%1440].push(datArray[index].Value)\n                }\n            })\n            function momentAgp05(val){\n                val = _.compact(val)\n                return AGPUtils.calculateYValue(val)?AGPUtils.calculateYValue(val).p05:AGPUtils.calculateYValue(val)\n            }\n            function momentAgp25(val){\n                val = _.compact(val)\n                return AGPUtils.calculateYValue(val)?AGPUtils.calculateYValue(val).p25:AGPUtils.calculateYValue(val)\n            }\n            function momentAgp50(val){\n                val = _.compact(val)\n                return AGPUtils.calculateYValue(val)?AGPUtils.calculateYValue(val).p50:AGPUtils.calculateYValue(val)\n            }\n            function momentAgp75(val){\n                val = _.compact(val)\n                return AGPUtils.calculateYValue(val)?AGPUtils.calculateYValue(val).p75:AGPUtils.calculateYValue(val)\n            }\n            function momentAgp95(val){\n                val = _.compact(val)\n                return AGPUtils.calculateYValue(val)?AGPUtils.calculateYValue(val).p95:AGPUtils.calculateYValue(val)\n            }\n            let xData =  Array.from({length:60*24},(item, index) => index)\n            let agp05 = _.map(newArr,momentAgp05)\n            let agp25 = _.map(newArr,momentAgp25)\n            let agp50 = _.map(newArr,momentAgp50)\n            let agp75 = _.map(newArr,momentAgp75)\n            let agp95 = _.map(newArr,momentAgp95)\n\n            let params = {\n                    xData:xData,\n                    agp05:agp05,\n                    agp25:agp25,\n                    agp50:agp50,\n                    agp75:agp75,\n                    agp95:agp95\n                }\n            this.agpList = params\n        },\n        // tir\n        handelTir(data){\n            let datArray = _.cloneDeep(data)\n            let new_data = _.uniqBy(datArray,'DataTs')\n            let v_data = _.map(new_data,'Value')\n            let result = TIRUtils.getTIRResult(v_data)\n            this.tir = result\n        },\n        // 每日血糖\n        handelDay(data){\n            let datArray = _.cloneDeep(data)\n            let singleDay  = _.chunk(datArray,60*24) ;\n            let max = _.maxBy(datArray,'Value').Value>400?400:_.maxBy(datArray,'Value').Value\n            let dayList = new Array()\n            singleDay.forEach(item=>{\n                let value = _.map(item, 'Value');\n                dayList.push({\n                    day: formatDate(item[0].DataTs*1000,'mm.dd'),\n                    week: formatDate(item[0].DataTs*1000,'WW'),\n                    value:value,\n                    max:max,\n                    tir:TIRUtils.getTIRResult(value)?(Number(TIRUtils.getTIRResult(value).normalRate)*100).toFixed(1):''\n                })\n            })\n\n            this.agpdayList =  dayList\n        },\n        // 血糖数据\n        handelBg(data){\n            let datArray = _.cloneDeep(data)\n            let bgInfo = GlucoseUtils.calculateMeanCvGmi(_.map(datArray,'Value'))\n            bgInfo.mean = Math.round(bgInfo.mean)\n            let unit = this.unit\n            if(unit=='mmol/L'){\n                bgInfo.mean = GlucoseUtils.mgdlToMmol(bgInfo.mean)\n            }\n            let filteredArray = dataArray.filter(val => val >= 40 && val <= 400);\n            bgInfo.effective = _.round((filteredArray.length/dataArray.length)*100,1)\n            this.bgInfo = bgInfo\n            console.loh(this.bgInfo)\n        }\n    }\n}\n</script>\n<style scoped>\n    @media print {\n        #overviewpage {\n            background-color: white !important;\n        }\n    }\n    .agp{\n        width:100%;\n        height:100%;\n    }\n    .agp-cont-main1{\n        height:450px;\n        position: relative;\n    }\n    .agp-cont-main1:nth-child(1){\n         margin-right:20px;\n    }\n    /* 基本信息 */\n    .report-main-base-info{\n        width:100%;\n        height:209px;\n    }\n    .report-base-user{\n        width:100%;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin:20px 0;\n        height:35px;\n        box-sizing: border-box;\n        padding:0px 20px 0px 10px;\n    }\n    .report-base-user-item{\n        display: flex;\n        align-items: center;\n        font-size:18px;\n        width:45%;\n    }\n     .report-base-user-item1{\n        font-size:18px;\n        flex-grow: 2;\n         width:45%;\n    }\n     .report-base-user-item2{\n        font-size:18px;\n        width:20%;\n    }\n    .report-base-user-label{\n        color:var(--color-black-60);\n    }\n    .report-base-user-value{\n        color:var(--color-black-100);\n    }\n    .report-data-source{\n        width:100%;\n        height:52px;\n        padding-left:20px;\n        padding-right:60px;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        background:#f7f7f7;\n    }\n      .report-data-sources{\n        width:100%;\n        height:52px;\n        padding-left:20px;\n        padding-right:60px;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n    }\n \n    /* 标准 */\n    .bg-data-item{\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        margin:0;\n        height:74px;\n        border-bottom:1px solid var(--color-black-10);\n    }\n    .bg-data-item:last-child{\n        border: none;\n    }\n    .bg-data-label{\n        font-size:var(--fontSize-big);\n        color:var(--color-black-80);\n    }\n    .bg-data-tip{\n        font-size:var(--fontSize-default);\n        color:var(--color-black-40);\n    }\n    .bg-data-val{\n        font-size:var(--fontSize-big);\n        color:var(--color-black-80);\n    }\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}