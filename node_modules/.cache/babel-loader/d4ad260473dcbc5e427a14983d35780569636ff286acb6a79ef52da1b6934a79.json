{"ast":null,"code":"export default {\n  name: 'TIR',\n  data() {\n    return {\n      levels: [{\n        key: '2 级高血糖',\n        value: 40,\n        color: '#E98C41',\n        desc: '>13.9mmol/L'\n      }, {\n        key: '1 级高血糖',\n        value: 10,\n        color: '#F6C059',\n        desc: '10.1-13.9mmol/L'\n      }, {\n        key: '目标范围内',\n        value: 20,\n        color: '#32BAC0',\n        desc: '3.9~10.0mmol/L'\n      }, {\n        key: '1 级低血糖',\n        value: 5,\n        color: '#F43F31',\n        desc: '3.0~3.8mmol/L'\n      }, {\n        key: '2 级低血糖',\n        value: 5,\n        color: '#96251C',\n        desc: '<3.0mmol/L'\n      }]\n    };\n  },\n  mounted() {\n    this.drawTir();\n  },\n  methods: {\n    drawTir() {\n      const canvas = document.getElementById(\"myCanvas\");\n      const ctx = canvas.getContext(\"2d\");\n      const W = this.$refs.tir.offsetWidth * 2;\n      const H = this.$refs.tir.offsetHeight * 2;\n      canvas.width = W;\n      canvas.height = H;\n      ctx.scale(2, 2);\n      const barW = 40; //柱状图宽度\n      const splitInterval = 1; //间隔距离\n      const lineStart = barW + 5; //标识线x轴起点\n      const lineWidth = 15; //标识线x轴起点\n      let start_y = 0; //柱状图y轴起始点 \n      let labelLineIndex = 0; //标识线是否要弯折\n      for (var i = 0; i < this.levels.length; i++) {\n        let value = Number(this.levels[i].value) * 2;\n        ctx.fillStyle = this.levels[i].color;\n        ctx.fillRect(0, start_y, barW, value);\n        start_y = start_y + value + splitInterval;\n        ctx.lineWidth = \"1\";\n        ctx.strokeStyle = \"#e5e5e5\";\n        ctx.moveTo(lineStart, start_y - value / 2);\n        if (value < 20) {\n          labelLineIndex++;\n        } else {\n          labelLineIndex = 0;\n        }\n        let lineOneX = value > 20 ? lineStart + lineWidth : lineStart + (lineWidth - labelLineIndex * 3);\n        let lineOneY = start_y - value / 2;\n        let lineTwoX = lineOneX;\n        let lineTwoY = labelLineIndex > 1 || i == 3 && this.levels[2].value <= 20 ? start_y - value / 2 + labelLineIndex * 20 : lineOneY;\n        let lineThreeX = labelLineIndex > 1 || i == 3 && this.levels[2].value <= 20 ? lineStart + lineWidth : lineTwoX;\n        let lineThreeY = labelLineIndex > 1 || i == 3 && this.levels[2].value <= 20 ? start_y - value / 2 + labelLineIndex * 20 : lineTwoY;\n        ctx.lineTo(lineOneX, lineOneY);\n        ctx.lineTo(lineTwoX, lineTwoY);\n        ctx.lineTo(lineThreeX, lineThreeY);\n        ctx.stroke();\n        ctx.fillRect(lineThreeX + 5, lineThreeY - 4, 8, 8);\n        ctx.font = \"16px Arial\";\n        ctx.fillStyle = '#666';\n        ctx.fillText(this.levels[i].key, lineThreeX + 20, lineThreeY + 5);\n        const textWidth = ctx.measureText('this.levels[i].key,').width;\n        ctx.font = \"16px Arial\";\n        ctx.fillStyle = '#000';\n        ctx.fillText(this.levels[i].value, lineThreeX + textWidth + 10, lineThreeY + 5);\n        ctx.fillStyle = '#666';\n        ctx.fillText('%', lineThreeX + 130, lineThreeY + 5);\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","data","levels","key","value","color","desc","mounted","drawTir","methods","canvas","document","getElementById","ctx","getContext","W","$refs","tir","offsetWidth","H","offsetHeight","width","height","scale","barW","splitInterval","lineStart","lineWidth","start_y","labelLineIndex","i","length","Number","fillStyle","fillRect","strokeStyle","moveTo","lineOneX","lineOneY","lineTwoX","lineTwoY","lineThreeX","lineThreeY","lineTo","stroke","font","fillText","textWidth","measureText"],"sources":["src/views/components/Chart/TIR.vue"],"sourcesContent":["<template>\n    <div class='TIR' ref='tir'>\n        <canvas id='myCanvas' ref='canvas' class='canvas' ></canvas>\n    </div>\n</template>\n<script>\nexport default {\n    name:'TIR',\n    data(){\n        return{\n            levels: [\n                {key: '2 级高血糖', value: 40, color: '#E98C41', desc: '>13.9mmol/L'},\n                {\n                    key: '1 级高血糖',\n                    value: 10,\n                    color: '#F6C059',\n                    desc: '10.1-13.9mmol/L',\n                },\n                {\n                    key: '目标范围内',\n                    value: 20,\n                    color: '#32BAC0',\n                    desc: '3.9~10.0mmol/L',\n                },\n                {key: '1 级低血糖', value: 5, color: '#F43F31', desc: '3.0~3.8mmol/L'},\n                {key: '2 级低血糖', value:5, color: '#96251C', desc: '<3.0mmol/L'},\n            ],\n        }\n    },\n    mounted(){\n        this.drawTir()\n    },\n    methods:{\n        drawTir(){\n            const canvas = document.getElementById(\"myCanvas\");\n            const ctx = canvas.getContext(\"2d\")\n            const W = this.$refs.tir.offsetWidth*2\n            const H = this.$refs.tir.offsetHeight*2\n            canvas.width = W\n            canvas.height = H\n            ctx.scale(2, 2)\n            const barW = 40 //柱状图宽度\n            const splitInterval = 1 //间隔距离\n            const lineStart = barW+5 //标识线x轴起点\n            const lineWidth =15//标识线x轴起点\n            let  start_y = 0 //柱状图y轴起始点 \n            let labelLineIndex = 0 //标识线是否要弯折\n            for(var i=0;i<this.levels.length;i++){\n                let value = Number(this.levels[i].value)*2\n                ctx.fillStyle = this.levels[i].color\n                ctx.fillRect(0,start_y,barW,value)\n                start_y = start_y + value + splitInterval\n                ctx.lineWidth=\"1\";\n                ctx.strokeStyle=\"#e5e5e5\";\n                ctx.moveTo(lineStart,start_y-(value/2));\n                \n                if(value<20){\n                    labelLineIndex++\n                }else{\n                    labelLineIndex = 0\n                }\n               \n                let  lineOneX = value>20 ? lineStart+lineWidth : lineStart+(lineWidth-labelLineIndex*3)\n                let  lineOneY = start_y-(value/2)\n                let  lineTwoX = lineOneX\n                let  lineTwoY = labelLineIndex>1||(i==3&&this.levels[2].value<=20)?start_y-(value/2)+labelLineIndex*20:lineOneY\n                let  lineThreeX = labelLineIndex>1||(i==3&&this.levels[2].value<=20)?lineStart+lineWidth:lineTwoX\n                let  lineThreeY = labelLineIndex>1||(i==3&&this.levels[2].value<=20)?start_y-(value/2)+labelLineIndex*20:lineTwoY\n\n                ctx.lineTo(lineOneX,lineOneY);\n                ctx.lineTo(lineTwoX,lineTwoY);\n                ctx.lineTo(lineThreeX,lineThreeY);\n                ctx.stroke();\n\n                ctx.fillRect(lineThreeX+5,lineThreeY-4,8,8)\n                \n                ctx.font=\"16px Arial\";\n                ctx.fillStyle = '#666'\n                ctx.fillText(this.levels[i].key,lineThreeX+20,lineThreeY+5);\n\n                const textWidth= ctx.measureText('this.levels[i].key,').width;\n                ctx.font=\"16px Arial\";\n                ctx.fillStyle = '#000'\n                ctx.fillText(this.levels[i].value,lineThreeX+textWidth+10,lineThreeY+5);\n\n                ctx.fillStyle = '#666'\n                ctx.fillText('%',lineThreeX+130,lineThreeY+5);\n            }\n\n        }\n    }\n}\n</script>\n<style scoped>\n    .TIR{\n        height:300px;\n    }\n    .canvas{\n        height:300px;\n    }\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}