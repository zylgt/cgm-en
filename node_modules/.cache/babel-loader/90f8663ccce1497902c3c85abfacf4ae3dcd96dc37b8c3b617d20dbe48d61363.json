{"ast":null,"code":"import { openProcedure } from \"@/utils/monitoringApp\";\nimport { eventBus } from '@/utils/eventBus';\nimport Abnormal from \"./abnormal\";\nexport default {\n  data() {\n    return {\n      errorShow: true,\n      step: 1,\n      focus: true,\n      abnormalStatus: 0 //驱动异常值 0启动中 1未安装 2启动失败 3更新\n    };\n  },\n  components: {\n    Abnormal\n  },\n  created() {\n    eventBus.$on('socketStatusChange', val => {\n      if (val == 3) {\n        //连接失败\n        this.abnormalStatus = 2;\n      }\n    });\n    this.onblur();\n    this.onfocus();\n  },\n  mounted() {\n    window.addEventListener('mousedown', this.handleMousedown);\n    setInterval(function () {\n      console.log('暂停？');\n    }, 3000);\n  },\n  methods: {\n    firing() {\n      let self = this;\n      this.step = 2;\n      this.abnormalStatus = 0;\n      let appUri = 'Clashx://'; // 应用程序的地址(注册表应用名称)\n      let timeoutDuration = 1000;\n      let openAppFailure = () => {\n        //未检测到驱动，需要下载\n        self.abnormalStatus = 1;\n      };\n      let openAppSuccess = () => {\n        console.log('成功打开本地应用程序');\n        console.log(window);\n        // this.$websocket.reset();\n        // this.$websocket.initwebSocket();\n      };\n      openProcedure(appUri, openAppFailure, openAppSuccess, timeoutDuration);\n    },\n    // 下载\n    downLoad() {\n      console.log('下载驱动');\n      this.abnormalStatus = 0;\n      this.step = 1;\n      // window.location.href='https://dldir1.qq.com/weixin/mac/WeChatMac.dmg'\n    },\n    // 失去焦点\n    onblur(e) {\n      console.log('失去焦点');\n    },\n    onfocus(e) {\n      console.log('或得焦点');\n    },\n    handleMousedown(e) {\n      console.log(e);\n    }\n  }\n};","map":{"version":3,"names":["openProcedure","eventBus","Abnormal","data","errorShow","step","focus","abnormalStatus","components","created","$on","val","onblur","onfocus","mounted","window","addEventListener","handleMousedown","setInterval","console","log","methods","firing","self","appUri","timeoutDuration","openAppFailure","openAppSuccess","downLoad","e"],"sources":["src/views/Procedure/upLoad.vue"],"sourcesContent":["<template>\n    <div class='upLoad' >\n        <div class='run-procedure'  v-if='abnormalStatus==0'>\n            <div class='step-box step1' v-if='step==1'>\n                 <div class='title' >运行驱动程序</div>\n                <div class='procedure_img' >\n                    <div class='procedure_img_item' >1</div>\n                    <div class='procedure_img_item' >2</div>\n                    <div class='procedure_img_item' >3</div>\n                    <div class='procedure_img_item' >4</div>\n                </div>\n                <div class='btn-box' >\n                    <el-button type=\"primary\"  @click='downLoad'> 下载驱动</el-button>\n                    <el-button type=\"primary\"  @click='firing'>启动驱动</el-button>\n                </div>\n            </div>\n           <div class='step-box step2' v-if='step==2' >\n                <i class=\"el-icon-loading loading-icon \"></i>\n                <div class='unistall-text' >正在启动中......</div>\n           </div>\n        </div>\n        <el-input v-model=\"inputs\" placeholder=\"请输入内容\" :autofocus=\"focus\" @blur='onblur' @focus='onfocus'></el-input>\n        <Abnormal v-if='abnormalStatus!=0' :type='abnormalStatus' @downLoad='downLoad' @firing='firing' />\n    </div>\n</template>\n<script>\nimport { openProcedure } from \"@/utils/monitoringApp\";\nimport {eventBus} from '@/utils/eventBus'\nimport Abnormal from \"./abnormal\"\nexport default {\n    data(){\n        return{\n            errorShow:true,\n            step:1,\n            focus:true,\n            abnormalStatus:0, //驱动异常值 0启动中 1未安装 2启动失败 3更新\n        }\n    },\n    components:{\n        Abnormal\n    },\n    created(){\n        eventBus.$on('socketStatusChange',(val) => {\n            if(val==3){ //连接失败\n                this.abnormalStatus =  2\n            }\n        })\n        this.onblur()\n        this.onfocus()\n    }, \n    mounted(){\n        window.addEventListener('mousedown', this.handleMousedown)\n        setInterval(function(){\n            console.log('暂停？')\n        },3000)\n    },\n    methods:{\n        firing(){\n            let self = this\n            this.step = 2\n            this.abnormalStatus = 0\n            let appUri = 'Clashx://'; // 应用程序的地址(注册表应用名称)\n            let timeoutDuration = 1000;\n            let openAppFailure = () => { //未检测到驱动，需要下载\n                self.abnormalStatus = 1\n            };\n\n            let openAppSuccess = () => {\n                console.log('成功打开本地应用程序');\n                console.log(window)\n                // this.$websocket.reset();\n                // this.$websocket.initwebSocket();\n            };\n            openProcedure(appUri, openAppFailure, openAppSuccess, timeoutDuration);\n        },\n        // 下载\n        downLoad(){\n            console.log('下载驱动')\n            this.abnormalStatus = 0\n            this.step = 1\n            // window.location.href='https://dldir1.qq.com/weixin/mac/WeChatMac.dmg'\n        },\n        // 失去焦点\n        onblur(e){\n            console.log('失去焦点')\n        },\n        onfocus(e){\n             console.log('或得焦点')\n        },\n        handleMousedown(e){\n            console.log(e)\n        }\n    }\n}\n</script>\n<style scoped>\n    .upLoad{\n        width:100%;\n        height:100%;\n        padding:30px 60px;\n        background:#fff;\n    }\n    .run-procedure{\n         height:100%;\n    }\n    /* 步骤一 */\n    .step1{\n        position: relative;\n        height:100%;\n        width:100%;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-between;\n    }\n     .title{\n        font-size:24px;\n        color:#333;\n        font-weight: 700;\n        margin-bottom:20px;\n    }\n    .procedure_img{\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n    }\n    .procedure_img_item{\n        flex-grow: 1;\n        height:460px;\n        margin:0 10px;\n        background:#d9d9d9;\n        text-align: center;\n        line-height: 460px;\n    }\n    .btn-box{\n        display: flex;\n        align-items: center;\n        justify-content:space-between;\n        \n    }\n    /* 步骤2 */\n     .step2{\n       display: flex;\n       align-items: center;\n       justify-content: center; \n       flex-direction: column;\n        height:100%;\n    }\n    .loading-icon{\n        font-size:60px;\n        color:var(--color-primary);\n    }\n    /* 未安装 */\n    .uninstall-procedure{\n        height:100%;\n        position: relative;\n    }\n     .unstall-tips{\n        display:flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        height:100%;\n    }\n    .waring-icon{\n        font-size:60px;\n        color:red;\n    }\n    .unistall-text{\n        margin-top:30px;\n        font-size:18px;\n        text-align: center;\n    }\n    .unistall-btn{\n        display: flex;\n        justify-content: flex-end;\n        position: absolute;\n        right:0;\n        bottom:0;\n    }\n   \n  \n</style>"],"mappings":"AA0BA,SAAAA,aAAA;AACA,SAAAC,QAAA;AACA,OAAAC,QAAA;AACA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,IAAA;MACAC,KAAA;MACAC,cAAA;IACA;EACA;EACAC,UAAA;IACAN;EACA;EACAO,QAAA;IACAR,QAAA,CAAAS,GAAA,uBAAAC,GAAA;MACA,IAAAA,GAAA;QAAA;QACA,KAAAJ,cAAA;MACA;IACA;IACA,KAAAK,MAAA;IACA,KAAAC,OAAA;EACA;EACAC,QAAA;IACAC,MAAA,CAAAC,gBAAA,mBAAAC,eAAA;IACAC,WAAA;MACAC,OAAA,CAAAC,GAAA;IACA;EACA;EACAC,OAAA;IACAC,OAAA;MACA,IAAAC,IAAA;MACA,KAAAlB,IAAA;MACA,KAAAE,cAAA;MACA,IAAAiB,MAAA;MACA,IAAAC,eAAA;MACA,IAAAC,cAAA,GAAAA,CAAA;QAAA;QACAH,IAAA,CAAAhB,cAAA;MACA;MAEA,IAAAoB,cAAA,GAAAA,CAAA;QACAR,OAAA,CAAAC,GAAA;QACAD,OAAA,CAAAC,GAAA,CAAAL,MAAA;QACA;QACA;MACA;MACAf,aAAA,CAAAwB,MAAA,EAAAE,cAAA,EAAAC,cAAA,EAAAF,eAAA;IACA;IACA;IACAG,SAAA;MACAT,OAAA,CAAAC,GAAA;MACA,KAAAb,cAAA;MACA,KAAAF,IAAA;MACA;IACA;IACA;IACAO,OAAAiB,CAAA;MACAV,OAAA,CAAAC,GAAA;IACA;IACAP,QAAAgB,CAAA;MACAV,OAAA,CAAAC,GAAA;IACA;IACAH,gBAAAY,CAAA;MACAV,OAAA,CAAAC,GAAA,CAAAS,CAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}