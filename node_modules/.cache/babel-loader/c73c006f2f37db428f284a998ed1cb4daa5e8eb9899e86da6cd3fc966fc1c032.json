{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Empty from '@/views/components/Empty/empty';\nimport WeekAnalysis from '@/views/report/components/weekAnalysis';\nimport { formatDate, formatTime } from '@/utils/formatTime';\nimport { getAgpData } from '@/api/dataApi';\nimport { mapGetters } from \"vuex\";\nimport { TIRUtils } from \"@/utils/algorithm/TIR\";\nimport { GlucoseUtils } from \"@/utils/algorithm/Glucose\";\nexport default {\n  data() {\n    return {\n      agpDate: ['2024-05-01', '2024-05-08'],\n      pickerOptions: {\n        shortcuts: [{\n          text: '最近7天',\n          onClick(picker) {\n            const end = new Date();\n            const start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\n            picker.$emit('pick', [start, end]);\n          }\n        }, {\n          text: '最近14天',\n          onClick(picker) {\n            const end = new Date();\n            const start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 14);\n            picker.$emit('pick', [start, end]);\n          }\n        }, {\n          text: '最近30天',\n          onClick(picker) {\n            const end = new Date();\n            const start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\n            picker.$emit('pick', [start, end]);\n          }\n        }, {\n          text: '最近90天',\n          onClick(picker) {\n            const end = new Date();\n            const start = new Date();\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\n            picker.$emit('pick', [start, end]);\n          }\n        }]\n      },\n      dialogVisible: false,\n      dialogType: \"\",\n      downloadList: ['AGP报告', '每日分析', '多日血糖分析', '报告解读', '饮食分析'],\n      checkedDowns: [],\n      checkAll: false,\n      isIndeterminate: true,\n      empty: true,\n      dayDate: 14,\n      //天数\n      list: []\n    };\n  },\n  components: {\n    WeekAnalysis,\n    Empty\n  },\n  mounted() {\n    let end_ts = new Date();\n    let start_ts = new Date().setDate(end_ts.getDate() - 13);\n    let s_date = new Date(start_ts).setHours(0, 0, 0) / 1000;\n    let e_date = end_ts.setHours(23, 59, 59) / 1000;\n    let oneDay = 24 * 60 * 60 * 1000; // 每天的毫秒数\n    let diff = Math.abs(s_date - e_date); // 计算差值的绝对值\n    this.dayDate = Math.ceil(diff / oneDay);\n    this.agpDate = [formatDate(start_ts, \"YYYY-mm-dd\"), formatDate(end_ts, \"YYYY-mm-dd\")];\n  },\n  methods: {\n    upload() {\n      this.$router.push('/upLoad');\n    },\n    // 选择下载。打印的内容\n    handleCheckedCitiesChange(val) {\n      let checkedCount = val.length;\n      this.checkAll = checkedCount === this.downloadList.length;\n      this.isIndeterminate = checkedCount > 0 && checkedCount < this.downloadList.length;\n    },\n    // 全选\n    handleCheckAllChange(val) {\n      this.checkedDowns = val ? this.downloadList : [];\n      this.isIndeterminate = false;\n    },\n    // 打印\n    async print() {\n      this.dialogVisible = true;\n      this.dialogType = 'print';\n    },\n    // 导出pdf\n    handleExport() {\n      this.dialogVisible = true;\n      this.dialogType = 'export';\n    },\n    // 选择时间\n    changeDate(e) {\n      console.log(e);\n      let date1 = new Date(e[0]);\n      let date2 = new Date(e[1]);\n      let s_date = date1.setHours(0, 0, 0) / 1000;\n      let e_date = date2.setHours(23, 59, 59) / 1000;\n      let oneDay = 24 * 60 * 60; // 每天的毫秒数\n      let diff = Math.abs(s_date - e_date); // 计算差值的绝对值\n      this.dayDate = Math.ceil(diff / oneDay);\n      if (_.indexOf(this.$store.state.report.chooseDateList, this.agpDate.join('/')) == -1) {\n        this.getData();\n      } else {\n        let result = this.$store.state.report.day[this.agpDate.join('/')];\n        // this.list = result\n        this.addWeek(result);\n        if (result.length > 0) {\n          this.empty = false;\n        } else {\n          this.empty = true;\n        }\n      }\n    },\n    // 从云拉取数据\n    getData() {\n      let s = new Date(this.agpDate[0]);\n      let e = new Date(this.agpDate[1]);\n      let start_ts = s.setHours(0, 0, 0) / 1000;\n      let end_ts = e.setHours(23, 59, 59) / 1000;\n      this.loading = true;\n      getAgpData({\n        start_ts: start_ts,\n        end_ts: end_ts\n      }).then(response => {\n        if (response.code == 1000) {\n          let arrayData = response.data;\n          this.loading = false;\n          if (arrayData.length > 0) {\n            console.log(formatTime(new Date()), '得到数据');\n            this.empty = false;\n            this.handelDay([this.agpDate.join('/'), arrayData]);\n            this.$store.dispatch('setChooseDateList', this.agpDate.join('/'));\n          } else {\n            this.empty = true;\n          }\n        } else {\n          this.loading = false;\n          this.$message({\n            type: 'error',\n            message: response.msg\n          });\n        }\n      }).catch(res => {\n        console.log(res);\n      });\n    },\n    processArray(arr, interval) {\n      let result = [];\n      for (let i = 0; i < arr.length - 1; i++) {\n        result.push(arr[i]);\n        let diff = arr[i + 1].DataTs - arr[i].DataTs;\n        let addTs = arr[i].DataTs + interval;\n        while (diff > interval) {\n          result.push({\n            DataTs: addTs,\n            value: undefined\n          });\n          diff = arr[i + 1].DataTs - addTs;\n          addTs += interval;\n        }\n      }\n      result.push(arr[arr.length - 1]);\n      return result;\n    },\n    filterArray(data) {\n      const result = [];\n      const seenTimes = new Set();\n      let levelLowInvalidMg = 20;\n      let levelHighInvalidMg = 800;\n      let levelTooLowMg = 40;\n      let levelTooHighMg = 400;\n      data.forEach(item => {\n        const timeStr = formatDate(item.DataTs * 1000, 'YYYY-mm-dd HH:MM');\n        if (!seenTimes.has(timeStr)) {\n          seenTimes.add(timeStr);\n          if (item.value > levelLowInvalidMg || item.value < levelHighInvalidMg) {\n            result.push({\n              ...item,\n              value: undefined\n            });\n          } else if (item.value < levelTooLowMg) {\n            result.push({\n              ...item,\n              value: levelTooLowMg\n            });\n          } else if (item.value > levelTooHighMg) {\n            result.push({\n              ...item,\n              value: levelTooHighMg\n            });\n          } else {\n            result.push(item);\n          }\n        }\n      });\n      return result;\n    },\n    handleData(objects, s_ts, e_ts) {\n      let measuringInterval = 60;\n      objects = this.processArray(objects, measuringInterval);\n      objects = this.filterArray(objects);\n      let startTs = objects[0].DataTs;\n      while (startTs - measuringInterval >= s_ts) {\n        objects.unshift({\n          DataTs: startTs - measuringInterval,\n          value: undefined\n        });\n        startTs = startTs - measuringInterval;\n      }\n      let endTs = objects[objects.length - 1].DataTs;\n      while (endTs + measuringInterval < e_ts) {\n        objects.push({\n          DataTs: endTs + measuringInterval,\n          value: undefined\n        });\n        endTs = endTs + measuringInterval;\n      }\n      return objects;\n    },\n    // 分割成每日血糖\n    handelDay(data) {\n      data = _.cloneDeep(data);\n      let s = new Date(data[0].split('/')[0]);\n      let e = new Date(data[0].split('/')[1]);\n      let s_date = s.setHours(0, 0, 0) / 1000;\n      let e_date = e.setHours(23, 59, 59) / 1000;\n      let datArray = this.handleData(data[1], s_date, e_date);\n      let singleDay = _.chunk(datArray, 60 * 24);\n      let max = _.maxBy(datArray, 'Value').Value > 400 ? 400 : _.maxBy(datArray, 'Value').Value;\n      let dayList = new Array();\n      singleDay.forEach(item => {\n        let value = _.map(item, 'Value');\n        dayList.push({\n          day: formatDate(item[0].DataTs * 1000, 'mm.dd'),\n          week: formatDate(item[0].DataTs * 1000, 'WW'),\n          value: value,\n          max: max,\n          tir: TIRUtils.getTIRResult(value) ? (Number(TIRUtils.getTIRResult(value).normalRate) * 100).toFixed(1) : ''\n        });\n      });\n      this.addWeek(dayList);\n      this.$store.dispatch('setDay', {\n        key: data[0],\n        value: dayList\n      }); //处理完数据存vuex\n    },\n    // 合并7天血糖\n    addWeek(data) {\n      let list = _.reverse(_.clone(data));\n      let newList = _.chunk(list, 7);\n      let newArr = [];\n      function handelDay(n) {\n        return formatDate(n.day, 'mm月dd日');\n      }\n      newList.forEach(item => {\n        let handelValue = _.compact(_.flatten(_.map(item, 'value')));\n        let max = _.max(handelValue) > 400 ? 400 : _.max(handelValue);\n        newArr.push({\n          day: _.map(item, handelDay),\n          value: _.map(item, 'value'),\n          max: max,\n          tir: TIRUtils.getTIRResult(handelValue) ? (Number(TIRUtils.getTIRResult(handelValue).normalRate) * 100).toFixed(1) : '',\n          info: GlucoseUtils.calculateMeanCvGmi(handelValue)\n        });\n      });\n      console.log(newArr);\n      this.list = newArr;\n    }\n  }\n};","map":{"version":3,"names":["Empty","WeekAnalysis","formatDate","formatTime","getAgpData","mapGetters","TIRUtils","GlucoseUtils","data","agpDate","pickerOptions","shortcuts","text","onClick","picker","end","Date","start","setTime","getTime","$emit","dialogVisible","dialogType","downloadList","checkedDowns","checkAll","isIndeterminate","empty","dayDate","list","components","mounted","end_ts","start_ts","setDate","getDate","s_date","setHours","e_date","oneDay","diff","Math","abs","ceil","methods","upload","$router","push","handleCheckedCitiesChange","val","checkedCount","length","handleCheckAllChange","print","handleExport","changeDate","e","console","log","date1","date2","_","indexOf","$store","state","report","chooseDateList","join","getData","result","day","addWeek","s","loading","then","response","code","arrayData","handelDay","dispatch","$message","type","message","msg","catch","res","processArray","arr","interval","i","DataTs","addTs","value","undefined","filterArray","seenTimes","Set","levelLowInvalidMg","levelHighInvalidMg","levelTooLowMg","levelTooHighMg","forEach","item","timeStr","has","add","handleData","objects","s_ts","e_ts","measuringInterval","startTs","unshift","endTs","cloneDeep","split","datArray","singleDay","chunk","max","maxBy","Value","dayList","Array","map","week","tir","getTIRResult","Number","normalRate","toFixed","key","reverse","clone","newList","newArr","n","handelValue","compact","flatten","info","calculateMeanCvGmi"],"sources":["src/views/report/weekReport.vue"],"sourcesContent":["<template>\n    <div>\n         <div class='agp-top' >\n            <div class='agp-top-fl' >\n                <div class='report-title'> {{$t('message.route.'+$route.meta.title)}}</div>\n                \n            </div>\n            <div class='agp-fr' >\n                <img src=\"~@/assets/image/printer.png\" alt=\"\" class='agp-icon' @click='print' >\n                <img src=\"~@/assets/image/down-icon.png\" alt=\"\" class='agp-icon' @click='handleExport' >\n                <img src=\"~@/assets/image/share.png\" alt=\"\" class='agp-icon agp-fr-icon'>\n                <el-button type=\"primary\" @click=\"upload\">\n                    <img src=\"~@/assets/image/btn-upload.png\" alt=\"\" class='btn-upload' >\n                    上传数据\n                </el-button>\n            </div>\n        </div>\n        <div class='report-agp-date' >\n                <img src=\"~@/assets/image/date-calendar.png\" alt=\"\" class='agp-icon' >\n                <div class='agp-date' >{{agpDate[0]}} — {{agpDate[1]}}（{{dayDate}}天）</div>\n                    <img src=\"~@/assets/image/select-icon.png\" alt=\"\" class='select-icon' >\n                <el-date-picker\n                    class='agp-picker'\n                    v-model=\"agpDate\"\n                    type=\"daterange\"\n                    align=\"right\"\n                    unlink-panels\n                    range-separator=\"至\"\n                    start-placeholder=\"开始日期\"\n                    end-placeholder=\"结束日期\"\n                    value-format=\"yyyy-MM-dd\"\n                    format=\"yyyy-MM-dd\"\n                    @change=\"changeDate\"\n                    :picker-options=\"pickerOptions\">\n                </el-date-picker>\n        </div>\n        <!-- 图表 -->\n        <Empty v-if='empty' style='height:600px;' />\n        <div class='week-bg-main' v-else v-for='(item,index) in list' :key='index'>\n            <div  class='week-bg-title' >\n                <div class='week-bg-date' >{{item.day[0]}} - {{item.day[item.day.length-1]}}</div>\n                 <img src=\"~@/assets/image/reason-icon.png\" alt=\"\" class='reason-icon'>\n            </div>\n            <Empty v-if='!item.max' style='height:450px'/>\n            <WeekAnalysis :dataList='item' v-else />\n        </div>\n         <!-- 下载打印弹窗 -->\n        <el-dialog  :visible.sync=\"dialogVisible\"  :show-close=\"false\" :title='dialogType==\"print\"?\"打印报告\":\"下载报告\"'\n         width=\"1060\" >\n            <div class='slot-popover'  id='popover'>\n                <div class='slot-popover-cont slot-popover-conts'>\n                    <div class='report-agp-date report-agp-dates' >\n                            <img src=\"~@/assets/image/date-calendar.png\" alt=\"\" class='agp-icon' >\n                            <div class='agp-date' >{{agpDate[0]}} — {{agpDate[1]}}（4天）</div>\n                            <img src=\"~@/assets/image/select-icon.png\" alt=\"\" class='select-icon' >\n                            <el-date-picker\n                                class='agp-picker'\n                                v-model=\"agpDate\"\n                                type=\"daterange\"\n                                align=\"right\"\n                                unlink-panels\n                                range-separator=\"至\"\n                                start-placeholder=\"开始日期\"\n                                end-placeholder=\"结束日期\"\n                                value-format=\"yyyy-MM-dd\"\n                                format=\"yyyy-MM-dd\"\n                                @change=\"changeDate\"\n                                :picker-options=\"pickerOptions\">\n                            </el-date-picker>\n                    </div>\n                    <div class='popover-cont-label' >\n                        <div class='popover-cont-label-label' v-if='dialogType==\"print\"'>请选择您想要打印的报告内容：</div>\n                        <div class='popover-cont-label-label' v-else>请选择您想要下载的报告内容：</div>\n                        <el-checkbox :indeterminate=\"isIndeterminate\" v-model=\"checkAll\" @change=\"handleCheckAllChange\">全选</el-checkbox>\n                    </div>\n                    <el-checkbox-group v-model=\"checkedDowns\" @change=\"handleCheckedCitiesChange\">\n                        <el-checkbox v-for=\"item in downloadList\" :label=\"item\" :key=\"item\">{{item}}</el-checkbox>\n                    </el-checkbox-group>\n                </div>\n                <div class='slot-popover-btn'>\n                    <el-button type=\"primary\" v-if='dialogType==\"print\"'>打印报告</el-button>\n                    <el-button type=\"primary\" v-else>下载报告</el-button>\n                </div>\n            </div>\n            <img src=\"~@/assets/image/close-icon.png\" alt=\"\" class='dialog-close' @click='dialogVisible=false' >\n        </el-dialog>\n    </div>\n</template>\n<script>\nimport Empty from '@/views/components/Empty/empty'\nimport WeekAnalysis from '@/views/report/components/weekAnalysis'\nimport {formatDate,formatTime} from '@/utils/formatTime'\nimport {getAgpData} from '@/api/dataApi'\nimport {mapGetters} from \"vuex\"\nimport { TIRUtils } from \"@/utils/algorithm/TIR\";\nimport { GlucoseUtils } from \"@/utils/algorithm/Glucose\";\nexport default {\n    data(){\n        return{\n            agpDate:['2024-05-01','2024-05-08'],\n            pickerOptions: {\n                shortcuts: [{\n                    text: '最近7天',\n                    onClick(picker) {\n                    const end = new Date();\n                    const start = new Date();\n                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);\n                    picker.$emit('pick', [start, end]);\n                    }\n                },{\n                    text: '最近14天',\n                    onClick(picker) {\n                    const end = new Date();\n                    const start = new Date();\n                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 14);\n                    picker.$emit('pick', [start, end]);\n                    }\n                }, {\n                    text: '最近30天',\n                    onClick(picker) {\n                    const end = new Date();\n                    const start = new Date();\n                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);\n                    picker.$emit('pick', [start, end]);\n                    }\n                }, {\n                    text: '最近90天',\n                    onClick(picker) {\n                    const end = new Date();\n                    const start = new Date();\n                    start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);\n                    picker.$emit('pick', [start, end]);\n                    }\n                }]\n            },\n            dialogVisible:false,\n            dialogType:\"\",\n            downloadList:['AGP报告','每日分析','多日血糖分析','报告解读','饮食分析'],\n            checkedDowns:[],\n            checkAll:false,\n            isIndeterminate: true,\n            empty:true,\n            dayDate:14,//天数\n            list:[]\n        }\n    },\n    components: {\n        WeekAnalysis,Empty\n    },\n    mounted(){\n        let end_ts = new Date()\n        let start_ts = new Date().setDate(end_ts.getDate() - 13)\n        let s_date =  new Date(start_ts).setHours(0,0,0)/1000\n        let e_date = end_ts.setHours(23,59,59)/1000\n        let oneDay = 24 * 60 * 60 * 1000 ; // 每天的毫秒数\n        let diff = Math.abs(s_date - e_date); // 计算差值的绝对值\n        this.dayDate  = Math.ceil(diff / oneDay)\n        this.agpDate = [formatDate(start_ts,\"YYYY-mm-dd\"), formatDate(end_ts,\"YYYY-mm-dd\")] \n    },\n    methods:{\n        upload(){\n            this.$router.push('/upLoad')\n        },\n          // 选择下载。打印的内容\n        handleCheckedCitiesChange(val){\n            let checkedCount = val.length;\n            this.checkAll = checkedCount === this.downloadList.length;\n            this.isIndeterminate = checkedCount > 0 && checkedCount < this.downloadList.length;\n        },\n        // 全选\n        handleCheckAllChange(val){\n            this.checkedDowns = val ? this.downloadList : [];\n            this.isIndeterminate = false;\n        },\n          // 打印\n        async print(){\n            this.dialogVisible = true\n            this.dialogType='print'\n        },\n        // 导出pdf\n        handleExport() {\n            this.dialogVisible = true\n            this.dialogType='export'\n        },\n        // 选择时间\n        changeDate(e){\n            console.log(e)\n            let date1 = new Date(e[0])\n            let date2 = new Date(e[1])\n            let s_date = date1.setHours(0,0,0)/1000\n            let e_date = date2.setHours(23,59,59)/1000\n            let oneDay = 24 * 60 * 60 ; // 每天的毫秒数\n            let diff = Math.abs(s_date - e_date); // 计算差值的绝对值\n            this.dayDate  = Math.ceil(diff / oneDay)\n            if( _.indexOf(this.$store.state.report.chooseDateList,this.agpDate.join('/'))==-1){\n                this.getData()\n            }else{\n                let result  = this.$store.state.report.day[this.agpDate.join('/')]\n                // this.list = result\n                this.addWeek(result)\n                if( result.length>0){\n                    this.empty = false\n                }else{\n                    this.empty = true\n                }\n            }\n        },\n        // 从云拉取数据\n        getData(){\n            let s = new Date(this.agpDate[0])\n            let e = new Date(this.agpDate[1])\n            let start_ts = s.setHours(0,0,0)/1000\n            let end_ts = e.setHours(23,59,59)/1000\n            this.loading = true\n            getAgpData({start_ts:start_ts,end_ts:end_ts}).then(response => {\n\t\t\t\t\t\t\tif(response.code == 1000){\n                                let arrayData = response.data\n                                this.loading = false\n                                if(arrayData.length>0){\n                                    console.log(formatTime(new Date()),'得到数据')   \n                                    this.empty = false\n                                    this.handelDay([this.agpDate.join('/'),arrayData])\n                                    this.$store.dispatch('setChooseDateList',this.agpDate.join('/'))\n                                }else{\n                                    this.empty = true\n                                }\n\t\t\t\t\t\t\t}else{\n                                this.loading = false\n\t\t\t\t\t\t\t\tthis.$message({\n                                    type: 'error',\n                                    message: response.msg\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n            }).catch((res) => {\n                console.log(res)\n            })\n        },\n        processArray(arr, interval) {\n            let result = [];\n\n            for (let i = 0; i < arr.length - 1; i++) {\n                result.push(arr[i]);\n\n                let diff = arr[i + 1].DataTs - arr[i].DataTs;\n                let addTs = arr[i].DataTs + interval;\n                while (diff > interval) {\n                result.push({DataTs: addTs, value: undefined});\n                diff = arr[i + 1].DataTs - addTs;\n                addTs += interval;\n                }\n            }\n            result.push(arr[arr.length - 1]);\n\n            return result;\n        },\n\n        filterArray  (data) {\n            const result = [];\n\n            const seenTimes = new Set();\n            let levelLowInvalidMg = 20\n            let levelHighInvalidMg = 800\n            let levelTooLowMg = 40\n            let levelTooHighMg = 400\n            data.forEach(item => {\n                const timeStr = formatDate(item.DataTs*1000,'YYYY-mm-dd HH:MM')\n\n                if (!seenTimes.has(timeStr)) {\n                seenTimes.add(timeStr);\n                if (item.value > levelLowInvalidMg || item.value < levelHighInvalidMg) {\n                    result.push({...item, value: undefined});\n                } else if (item.value < levelTooLowMg) {\n                    result.push({\n                    ...item,\n                    value: levelTooLowMg,\n                    });\n                } else if (item.value > levelTooHighMg) {\n                    result.push({\n                    ...item,\n                    value: levelTooHighMg,\n                    });\n                } else {\n                    result.push(item);\n                }\n                }\n            });\n\n            return result;\n        },\n\n        handleData (objects, s_ts, e_ts)  {\n            let measuringInterval = 60\n            objects = this.processArray(objects, measuringInterval);\n            objects = this.filterArray(objects);\n\n            let startTs = objects[0].DataTs;\n            while (startTs - measuringInterval >= s_ts) {\n                objects.unshift({\n                DataTs: startTs - measuringInterval,\n                value: undefined,\n                });\n                startTs = startTs - measuringInterval;\n            }\n\n            let endTs = objects[objects.length - 1].DataTs;\n            while (endTs + measuringInterval < e_ts) {\n                objects.push({\n                DataTs: endTs + measuringInterval,\n                value: undefined,\n                });\n                endTs = endTs + measuringInterval;\n            }\n            return objects;\n        },\n        // 分割成每日血糖\n        handelDay(data){\n            data = _.cloneDeep(data)\n            let s = new Date(data[0].split('/')[0])\n            let e = new Date(data[0].split('/')[1])\n            let s_date = s.setHours(0,0,0)/1000\n            let e_date = e.setHours(23,59,59)/1000\n            let datArray = this.handleData(data[1],s_date,e_date)\n            let singleDay  = _.chunk(datArray,60*24) ;\n            let max = _.maxBy(datArray,'Value').Value>400?400:_.maxBy(datArray,'Value').Value\n            let dayList = new Array()\n            singleDay.forEach(item=>{\n                let value = _.map(item, 'Value');\n                dayList.push({\n                    day: formatDate(item[0].DataTs*1000,'mm.dd'),\n                    week: formatDate(item[0].DataTs*1000,'WW'),\n                    value:value,\n                    max:max,\n                    tir:TIRUtils.getTIRResult(value)?(Number(TIRUtils.getTIRResult(value).normalRate)*100).toFixed(1):''\n                })\n            })\n            this.addWeek(dayList)\n            this.$store.dispatch('setDay',{key:data[0],value:dayList}) //处理完数据存vuex\n        },\n        // 合并7天血糖\n        addWeek(data){\n            let list = _.reverse(_.clone(data))\n            let newList = _.chunk(list,7)\n            let newArr = []\n            function handelDay(n){\n                return formatDate(n.day,'mm月dd日')\n            }\n            newList.forEach(item=>{\n                let handelValue = _.compact( _.flatten(_.map(item,'value')))\n                let max = _.max(handelValue)>400?400:_.max(handelValue)\n                newArr.push({\n                    day:_.map(item,handelDay),\n                    value:_.map(item,'value'),\n                    max:max,\n                    tir:TIRUtils.getTIRResult(handelValue)?(Number(TIRUtils.getTIRResult(handelValue).normalRate)*100).toFixed(1):'',\n                    info:GlucoseUtils.calculateMeanCvGmi(handelValue)\n                })\n            })\n            console.log(newArr)\n            this.list = newArr\n        }\n    }\n}\n</script>\n<style scoped>\n.week-bg-main{\n    width:100%;\n    height:605px;\n    background:#fff;\n    margin-bottom:20px;\n    border-radius:10px;\n    padding:20px;\n    box-sizing: border-box;\n}\n.week-bg-title{\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom:20px;\n}\n.week-bg-date{\n    font-size:var(--fontSize-max);\n    color:var(--color-black-100);\n    font-weight: 700;\n}\n.reason-icon{\n    width:24px;\n    height:24px;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}