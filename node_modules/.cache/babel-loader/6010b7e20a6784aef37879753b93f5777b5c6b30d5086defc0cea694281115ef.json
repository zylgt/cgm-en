{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright 2023 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nvar _defineProperty = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/defineProperty.js\").default;\nvar _classPrivateFieldInitSpec = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldInitSpec.js\").default;\nvar _classPrivateFieldGet = require(\"/Users/hexuemin/Desktop/jiuan/CGM/CGMWeb/node_modules/@babel/runtime/helpers/classPrivateFieldGet2.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.clearCustomQueryHandlers = exports.customQueryHandlerNames = exports.unregisterCustomQueryHandler = exports.registerCustomQueryHandler = exports.customQueryHandlers = exports.CustomQueryHandlerRegistry = void 0;\nconst assert_js_1 = require(\"../util/assert.js\");\nconst Function_js_1 = require(\"../util/Function.js\");\nconst QueryHandler_js_1 = require(\"./QueryHandler.js\");\nconst ScriptInjector_js_1 = require(\"./ScriptInjector.js\");\n/**\n * The registry of {@link CustomQueryHandler | custom query handlers}.\n *\n * @example\n *\n * ```ts\n * Puppeteer.customQueryHandlers.register('lit', { … });\n * const aHandle = await page.$('lit/…');\n * ```\n *\n * @internal\n */\nvar _handlers = /*#__PURE__*/new WeakMap();\nclass CustomQueryHandlerRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _handlers, new Map());\n  }\n  get(name) {\n    const handler = _classPrivateFieldGet(_handlers, this).get(name);\n    return handler ? handler[1] : undefined;\n  }\n  /**\n   * Registers a {@link CustomQueryHandler | custom query handler}.\n   *\n   * @remarks\n   * After registration, the handler can be used everywhere where a selector is\n   * expected by prepending the selection string with `<name>/`. The name is\n   * only allowed to consist of lower- and upper case latin letters.\n   *\n   * @example\n   *\n   * ```ts\n   * Puppeteer.customQueryHandlers.register('lit', { … });\n   * const aHandle = await page.$('lit/…');\n   * ```\n   *\n   * @param name - Name to register under.\n   * @param queryHandler - {@link CustomQueryHandler | Custom query handler} to\n   * register.\n   */\n  register(name, handler) {\n    var _Class;\n    (0, assert_js_1.assert)(!_classPrivateFieldGet(_handlers, this).has(name), `Cannot register over existing handler: ${name}`);\n    (0, assert_js_1.assert)(/^[a-zA-Z]+$/.test(name), `Custom query handler names may only contain [a-zA-Z]`);\n    (0, assert_js_1.assert)(handler.queryAll || handler.queryOne, `At least one query method must be implemented.`);\n    const Handler = (_Class = class Handler extends QueryHandler_js_1.QueryHandler {}, _defineProperty(_Class, \"querySelectorAll\", (0, Function_js_1.interpolateFunction)((node, selector, PuppeteerUtil) => {\n      return PuppeteerUtil.customQuerySelectors.get(PLACEHOLDER('name')).querySelectorAll(node, selector);\n    }, {\n      name: JSON.stringify(name)\n    })), _defineProperty(_Class, \"querySelector\", (0, Function_js_1.interpolateFunction)((node, selector, PuppeteerUtil) => {\n      return PuppeteerUtil.customQuerySelectors.get(PLACEHOLDER('name')).querySelector(node, selector);\n    }, {\n      name: JSON.stringify(name)\n    })), _Class);\n    const registerScript = (0, Function_js_1.interpolateFunction)(PuppeteerUtil => {\n      PuppeteerUtil.customQuerySelectors.register(PLACEHOLDER('name'), {\n        queryAll: PLACEHOLDER('queryAll'),\n        queryOne: PLACEHOLDER('queryOne')\n      });\n    }, {\n      name: JSON.stringify(name),\n      queryAll: handler.queryAll ? (0, Function_js_1.stringifyFunction)(handler.queryAll) : String(undefined),\n      queryOne: handler.queryOne ? (0, Function_js_1.stringifyFunction)(handler.queryOne) : String(undefined)\n    }).toString();\n    _classPrivateFieldGet(_handlers, this).set(name, [registerScript, Handler]);\n    ScriptInjector_js_1.scriptInjector.append(registerScript);\n  }\n  /**\n   * Unregisters the {@link CustomQueryHandler | custom query handler} for the\n   * given name.\n   *\n   * @throws `Error` if there is no handler under the given name.\n   */\n  unregister(name) {\n    const handler = _classPrivateFieldGet(_handlers, this).get(name);\n    if (!handler) {\n      throw new Error(`Cannot unregister unknown handler: ${name}`);\n    }\n    ScriptInjector_js_1.scriptInjector.pop(handler[0]);\n    _classPrivateFieldGet(_handlers, this).delete(name);\n  }\n  /**\n   * Gets the names of all {@link CustomQueryHandler | custom query handlers}.\n   */\n  names() {\n    return [..._classPrivateFieldGet(_handlers, this).keys()];\n  }\n  /**\n   * Unregisters all custom query handlers.\n   */\n  clear() {\n    for (const [registerScript] of _classPrivateFieldGet(_handlers, this)) {\n      ScriptInjector_js_1.scriptInjector.pop(registerScript);\n    }\n    _classPrivateFieldGet(_handlers, this).clear();\n  }\n}\nexports.CustomQueryHandlerRegistry = CustomQueryHandlerRegistry;\n/**\n * @internal\n */\nexports.customQueryHandlers = new CustomQueryHandlerRegistry();\n/**\n * @deprecated Import {@link Puppeteer} and use the static method\n * {@link Puppeteer.registerCustomQueryHandler}\n *\n * @public\n */\nfunction registerCustomQueryHandler(name, handler) {\n  exports.customQueryHandlers.register(name, handler);\n}\nexports.registerCustomQueryHandler = registerCustomQueryHandler;\n/**\n * @deprecated Import {@link Puppeteer} and use the static method\n * {@link Puppeteer.unregisterCustomQueryHandler}\n *\n * @public\n */\nfunction unregisterCustomQueryHandler(name) {\n  exports.customQueryHandlers.unregister(name);\n}\nexports.unregisterCustomQueryHandler = unregisterCustomQueryHandler;\n/**\n * @deprecated Import {@link Puppeteer} and use the static method\n * {@link Puppeteer.customQueryHandlerNames}\n *\n * @public\n */\nfunction customQueryHandlerNames() {\n  return exports.customQueryHandlers.names();\n}\nexports.customQueryHandlerNames = customQueryHandlerNames;\n/**\n * @deprecated Import {@link Puppeteer} and use the static method\n * {@link Puppeteer.clearCustomQueryHandlers}\n *\n * @public\n */\nfunction clearCustomQueryHandlers() {\n  exports.customQueryHandlers.clear();\n}\nexports.clearCustomQueryHandlers = clearCustomQueryHandlers;","map":{"version":3,"names":["_defineProperty","require","default","_classPrivateFieldInitSpec","_classPrivateFieldGet","assert_js_1","Function_js_1","QueryHandler_js_1","ScriptInjector_js_1","_handlers","WeakMap","CustomQueryHandlerRegistry","constructor","Map","get","name","handler","undefined","register","_Class","assert","has","test","queryAll","queryOne","Handler","QueryHandler","interpolateFunction","node","selector","PuppeteerUtil","customQuerySelectors","PLACEHOLDER","querySelectorAll","JSON","stringify","querySelector","registerScript","stringifyFunction","String","toString","set","scriptInjector","append","unregister","Error","pop","delete","names","keys","clear","exports","customQueryHandlers","registerCustomQueryHandler","unregisterCustomQueryHandler","customQueryHandlerNames","clearCustomQueryHandlers"],"sources":["../../../../src/common/CustomQueryHandler.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;AAAA,IAAAA,eAAA,GAAAC,OAAA,mGAAAC,OAAA;AAAA,IAAAC,0BAAA,GAAAF,OAAA,8GAAAC,OAAA;AAAA,IAAAE,qBAAA,GAAAH,OAAA,0GAAAC,OAAA;;;;;AAOA,MAAAG,WAAA,GAAAJ,OAAA;AACA,MAAAK,aAAA,GAAAL,OAAA;AAEA,MAAAM,iBAAA,GAAAN,OAAA;AAKA,MAAAO,mBAAA,GAAAP,OAAA;AAgBA;;;;;;;;;;;;AAAA,IAAAQ,SAAA,oBAAAC,OAAA;AAYA,MAAaC,0BAA0B;EAAAC,YAAA;IAAAT,0BAAA,OAAAM,SAAA,EACzB,IAAII,GAAG,EAGhB;EAAA;EAEHC,GAAGA,CAACC,IAAY;IACd,MAAMC,OAAO,GAAGZ,qBAAA,CAAAK,SAAA,MAAI,EAAWK,GAAG,CAACC,IAAI,CAAC;IACxC,OAAOC,OAAO,GAAGA,OAAO,CAAC,CAAC,CAAC,GAAGC,SAAS;EACzC;EAEA;;;;;;;;;;;;;;;;;;;EAmBAC,QAAQA,CAACH,IAAY,EAAEC,OAA2B;IAAA,IAAAG,MAAA;IAChD,IAAAd,WAAA,CAAAe,MAAM,EACJ,CAAChB,qBAAA,CAAAK,SAAA,MAAI,EAAWY,GAAG,CAACN,IAAI,CAAC,EACzB,0CAA0CA,IAAI,EAAE,CACjD;IACD,IAAAV,WAAA,CAAAe,MAAM,EACJ,aAAa,CAACE,IAAI,CAACP,IAAI,CAAC,EACxB,sDAAsD,CACvD;IACD,IAAAV,WAAA,CAAAe,MAAM,EACJJ,OAAO,CAACO,QAAQ,IAAIP,OAAO,CAACQ,QAAQ,EACpC,gDAAgD,CACjD;IAED,MAAMC,OAAO,IAAAN,MAAA,GAAG,MAAVM,OAAO,SAAiBlB,iBAAA,CAAAmB,YAAY,GAiBzC,EAAA1B,eAAA,CAAAmB,MAAA,sBAhBsD,IAAAb,aAAA,CAAAqB,mBAAmB,EACtE,CAACC,IAAI,EAAEC,QAAQ,EAAEC,aAAa,KAAI;MAChC,OAAOA,aAAa,CAACC,oBAAoB,CACtCjB,GAAG,CAACkB,WAAW,CAAC,MAAM,CAAC,CAAE,CACzBC,gBAAgB,CAACL,IAAI,EAAEC,QAAQ,CAAC;IACrC,CAAC,EACD;MAACd,IAAI,EAAEmB,IAAI,CAACC,SAAS,CAACpB,IAAI;IAAC,CAAC,CAC7B,GAAAf,eAAA,CAAAmB,MAAA,mBAC8C,IAAAb,aAAA,CAAAqB,mBAAmB,EAChE,CAACC,IAAI,EAAEC,QAAQ,EAAEC,aAAa,KAAI;MAChC,OAAOA,aAAa,CAACC,oBAAoB,CACtCjB,GAAG,CAACkB,WAAW,CAAC,MAAM,CAAC,CAAE,CACzBI,aAAa,CAACR,IAAI,EAAEC,QAAQ,CAAC;IAClC,CAAC,EACD;MAACd,IAAI,EAAEmB,IAAI,CAACC,SAAS,CAACpB,IAAI;IAAC,CAAC,CAC7B,GAAAI,MAAA,CACF;IACD,MAAMkB,cAAc,GAAG,IAAA/B,aAAA,CAAAqB,mBAAmB,EACvCG,aAA4B,IAAI;MAC/BA,aAAa,CAACC,oBAAoB,CAACb,QAAQ,CAACc,WAAW,CAAC,MAAM,CAAC,EAAE;QAC/DT,QAAQ,EAAES,WAAW,CAAC,UAAU,CAAC;QACjCR,QAAQ,EAAEQ,WAAW,CAAC,UAAU;OACjC,CAAC;IACJ,CAAC,EACD;MACEjB,IAAI,EAAEmB,IAAI,CAACC,SAAS,CAACpB,IAAI,CAAC;MAC1BQ,QAAQ,EAAEP,OAAO,CAACO,QAAQ,GACtB,IAAAjB,aAAA,CAAAgC,iBAAiB,EAACtB,OAAO,CAACO,QAAQ,CAAC,GACnCgB,MAAM,CAACtB,SAAS,CAAC;MACrBO,QAAQ,EAAER,OAAO,CAACQ,QAAQ,GACtB,IAAAlB,aAAA,CAAAgC,iBAAiB,EAACtB,OAAO,CAACQ,QAAQ,CAAC,GACnCe,MAAM,CAACtB,SAAS;KACrB,CACF,CAACuB,QAAQ,EAAE;IAEZpC,qBAAA,CAAAK,SAAA,MAAI,EAAWgC,GAAG,CAAC1B,IAAI,EAAE,CAACsB,cAAc,EAAEZ,OAAO,CAAC,CAAC;IACnDjB,mBAAA,CAAAkC,cAAc,CAACC,MAAM,CAACN,cAAc,CAAC;EACvC;EAEA;;;;;;EAMAO,UAAUA,CAAC7B,IAAY;IACrB,MAAMC,OAAO,GAAGZ,qBAAA,CAAAK,SAAA,MAAI,EAAWK,GAAG,CAACC,IAAI,CAAC;IACxC,IAAI,CAACC,OAAO,EAAE;MACZ,MAAM,IAAI6B,KAAK,CAAC,sCAAsC9B,IAAI,EAAE,CAAC;IAC/D;IACAP,mBAAA,CAAAkC,cAAc,CAACI,GAAG,CAAC9B,OAAO,CAAC,CAAC,CAAC,CAAC;IAC9BZ,qBAAA,CAAAK,SAAA,MAAI,EAAWsC,MAAM,CAAChC,IAAI,CAAC;EAC7B;EAEA;;;EAGAiC,KAAKA,CAAA;IACH,OAAO,CAAC,GAAG5C,qBAAA,CAAAK,SAAA,MAAI,EAAWwC,IAAI,EAAE,CAAC;EACnC;EAEA;;;EAGAC,KAAKA,CAAA;IACH,KAAK,MAAM,CAACb,cAAc,CAAC,IAAAjC,qBAAA,CAAAK,SAAA,EAAI,IAAI,GAAY;MAC7CD,mBAAA,CAAAkC,cAAc,CAACI,GAAG,CAACT,cAAc,CAAC;IACpC;IACAjC,qBAAA,CAAAK,SAAA,MAAI,EAAWyC,KAAK,EAAE;EACxB;;AAlHFC,OAAA,CAAAxC,0BAAA,GAAAA,0BAAA;AAqHA;;;AAGawC,OAAA,CAAAC,mBAAmB,GAAG,IAAIzC,0BAA0B,EAAE;AAEnE;;;;;;AAMA,SAAgB0C,0BAA0BA,CACxCtC,IAAY,EACZC,OAA2B;EAE3BmC,OAAA,CAAAC,mBAAmB,CAAClC,QAAQ,CAACH,IAAI,EAAEC,OAAO,CAAC;AAC7C;AALAmC,OAAA,CAAAE,0BAAA,GAAAA,0BAAA;AAOA;;;;;;AAMA,SAAgBC,4BAA4BA,CAACvC,IAAY;EACvDoC,OAAA,CAAAC,mBAAmB,CAACR,UAAU,CAAC7B,IAAI,CAAC;AACtC;AAFAoC,OAAA,CAAAG,4BAAA,GAAAA,4BAAA;AAIA;;;;;;AAMA,SAAgBC,uBAAuBA,CAAA;EACrC,OAAOJ,OAAA,CAAAC,mBAAmB,CAACJ,KAAK,EAAE;AACpC;AAFAG,OAAA,CAAAI,uBAAA,GAAAA,uBAAA;AAIA;;;;;;AAMA,SAAgBC,wBAAwBA,CAAA;EACtCL,OAAA,CAAAC,mBAAmB,CAACF,KAAK,EAAE;AAC7B;AAFAC,OAAA,CAAAK,wBAAA,GAAAA,wBAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}