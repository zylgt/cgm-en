"use strict";(self["webpackChunkCGM3"]=self["webpackChunkCGM3"]||[]).push([[789],{6209:function(t,e,i){i.d(e,{A:function(){return p}});var a=function(){var t=this,e=t._self._c;return e("div",[t.empty?e("div",{staticClass:"agp-chart-empty"},[e("img",{staticClass:"empty-icon",attrs:{src:i(2201),alt:""}}),e("div",{staticClass:"agp-chartempty-tips"},[t._v("至少需要五天数据才可显示AGP图谱")])]):e("div",[t._m(0),e("t-chart",{style:{width:t.tWidth+"%",height:t.height+"px"},attrs:{option:t.option,"init-options":t.initOptions,theme:"tduck-echarts-theme"}})],1)])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"agp-legend"},[e("div",{staticClass:"agp-legend-item"},[e("div",{staticClass:"apg-legend-shape1"},[t._v("—")]),e("div",{staticClass:"agp-legend-info"},[t._v("50%中位线")])]),e("div",{staticClass:"agp-legend-item"},[e("div",{staticClass:"apg-legend-shape2"}),e("div",{staticClass:"agp-legend-info"},[t._v("25%-75%区间")])]),e("div",{staticClass:"agp-legend-item"},[e("div",{staticClass:"apg-legend-shape3"}),e("div",{staticClass:"agp-legend-info"},[t._v("5%-95%区间")])]),e("div",{staticClass:"agp-legend-item"},[e("div",{staticClass:"apg-legend-shape4-box"},[e("p",{staticClass:"apg-legend-shape4"}),e("p",{staticClass:"apg-legend-shape4"})]),e("div",{staticClass:"agp-legend-info"},[t._v("目标范围")])])])}],l=i(65),o=i(2651),r=i(2523),n=i(1910),d={data(){return{initOptions:{renderer:"svg"},option:{grid:[{height:300,left:140,right:120,top:30}],xAxis:[{type:"category",gridIndex:0,boundaryGap:!1,axisTick:!1,splitLine:{show:!1,lineStyle:{color:"var(--color-black-60)"},interval:59},axisLine:{show:!0,lineStyle:{color:"var(--color-black-60)",width:1}},data:[],axisLabel:{formatter:function(t,e){if(e%360===0){let e=Math.floor(t/60)<10?"0"+Math.floor(t/60):Math.floor(t/60),i=t%60<10?"0"+t%60:t%60,a=e+":"+i;return a}if(e+1===1440)return"00:00"},interval:0,color:"var(--color-black-60)",fontSize:20,margin:14}}],yAxis:[{type:"value",gridIndex:0,min:0,max:15,interval:3,splitLine:{lineStyle:{color:"var(--color-black-60)"}},axisLabel:{formatter:"{value}",color:"var(--color-black-60)",fontSize:20,margin:14}}],series:[{name:"L",type:"line",data:[],lineStyle:{opacity:0},stack:"confidence-band",symbol:"none",silent:!0,emphasis:{disabled:!0},animation:!1},{name:"U",type:"line",data:[],lineStyle:{opacity:0},areaStyle:{color:"#D6F1F2"},stack:"confidence-band",symbol:"none",silent:!0,emphasis:{disabled:!0},animation:!1},{name:"U",type:"line",data:[],lineStyle:{opacity:0},areaStyle:{color:"#94DBDE"},stack:"confidence-band",symbol:"none",silent:!0,emphasis:{disabled:!0},animation:!1},{name:"U",type:"line",data:[],lineStyle:{opacity:0},areaStyle:{color:"#D6F1F2"},stack:"confidence-band",symbol:"none",silent:!0,emphasis:{disabled:!0},animation:!1},{type:"line",data:[],itemStyle:{color:"var(--color-primary)"},showSymbol:!1,lineStyle:{width:2},silent:!0,emphasis:{disabled:!0},animation:!1,markLine:{silent:!0,symbol:"none",animation:!1,data:[{type:"min",yAxis:70,lineStyle:{color:"var(--color-error)",width:2,type:"solid"},label:{color:"var(--color-error)",fontSize:20,distance:14,position:"start"}},{type:"max",yAxis:180,lineStyle:{color:"var(--color-warning)",width:2,type:"solid"},label:{color:"var(--color-warning)",fontSize:20,distance:14,position:"start"}}]}}]},empty:!0,tWidth:100,target:[3.9,13.9]}},props:{dataList:{type:Object},height:{type:Number}},components:{TChart:l.A},computed:{...(0,n.L8)(["unit","targetScope"])},created(){},mounted(){let t=this.dataList;_.compact(t.agp05).length>1&&_.compact(t.agp25).length>1&&_.compact(t.agp50).length>1&&_.compact(t.agp75).length>1&&_.compact(t.agp95).length>1?(this.renderIng(t),this.empty=!1):this.empty=!0},methods:{renderIng(t){let e=_.cloneDeep(t);this.option.xAxis[0].data=e.xData;let i=this.unit,a=3*Math.ceil(r.e.mgdlToMmol(_.maxBy(e.agp95))/3)<15?15:3*Math.ceil(r.e.mgdlToMmol(_.maxBy(e.agp95))/3);this.option.series[4].markLine.data[0].yAxis=this.targetScope[0],this.option.series[4].markLine.data[1].yAxis=this.targetScope[1],"mg/dL"!=i?(this.option.yAxis[0].max=a,this.option.series[0].data=e.agp05.map((t=>r.e.mgdlToMmol(t))),this.option.series[1].data=e.agp25.map(((t,i)=>r.e.mgdlToMmol(t-e.agp05[i]))),this.option.series[2].data=e.agp75.map(((t,i)=>r.e.mgdlToMmol(t-e.agp25[i]))),this.option.series[3].data=e.agp95.map(((t,i)=>r.e.mgdlToMmol(t-e.agp75[i]))),this.option.series[4].data=e.agp50.map((t=>r.e.mgdlToMmol(t)))):(this.option.yAxis[0].max=r.e.mmolToMgdl(a),this.option.yAxis[0].interval=54,this.option.series[0].data=e.agp05,this.option.series[1].data=e.agp25.map(((t,i)=>t-e.agp05[i])),this.option.series[2].data=e.agp75.map(((t,i)=>t-e.agp25[i])),this.option.series[3].data=e.agp95.map(((t,i)=>t-e.agp75[i])),this.option.series[4].data=e.agp50),this.$nextTick((()=>{console.log((0,o.fU)(new Date),"AGP渲染完成")}))}},watch:{dataList:function(t,e){console.log(t);let i=t;_.compact(i.agp05).length>1&&_.compact(i.agp25).length>1&&_.compact(i.agp50).length>1&&_.compact(i.agp75).length>1&&_.compact(i.agp95).length>1?(this.renderIng(i),this.empty=!1):this.empty=!0}}},h=d,c=i(1656),g=(0,c.A)(h,a,s,!1,null,"5a867ac2",null),p=g.exports},5749:function(t,e,i){i.d(e,{A:function(){return p}});var a=function(){var t=this,e=t._self._c;return e("div",[e("div",{ref:"day",staticClass:"day-box",attrs:{id:"day-box"}},[t.dayList.length>0?e("div",{staticClass:"day-item-box"},t._l(t.dayList,(function(i,a){return e("div",{key:a,staticClass:"day-item",style:{width:t.gridW+"px"}},[a<7?e("div",{staticClass:"day-week"},[t._v(t._s(i.week))]):t._e(),e("div",{staticClass:"day-grid-border"})])})),0):t._e(),e("t-chart",{style:{width:"100%",height:t.height+"px"},attrs:{option:t.option,"init-options":t.initOptions,theme:"tduck-echarts-theme"}})],1)])},s=[],l=(i(4114),i(65)),o=i(2651),r=i(2523),n=(i(4927),i(1910)),d={data(){return{initOptions:{renderer:"svg"},option:{tooltip:{show:!0,trigger:"axis",confine:!0},title:[],grid:[],xAxis:[],yAxis:[],visualMap:[],series:[]},dayList:[],week:[],gridW:0,height:510}},props:{dataList:{type:Array}},components:{TChart:l.A},created(){},computed:{...(0,n.L8)(["unit","targetScope"])},mounted(){this.getOption(this.dataList)},methods:{getOption(t){let e=_.cloneDeep(t);console.log(e),this.dayList=t,this.height=170*Math.ceil(t.length/7);let i=Math.floor((this.$refs.day.clientWidth-240)/7);this.gridW=i;let a=Array.from({length:1440},((t,e)=>e)),s=t[0].max;s=r.e.mgdlToMmol(s)<13.9?13.9:r.e.mgdlToMmol(s);let l=this.unit;this.option={tooltip:{show:!0,trigger:"axis",confine:!1,axisPointer:{type:"none",axis:"x",snap:!0},formatter(t){let i=Math.floor(Number(t[0].axisValue)/60)<10?"0"+Math.floor(Number(t[0].axisValue)/60):Math.floor(Number(t[0].axisValue)/60),a=Number(t[0].axisValue)%60<10?"0"+Number(t[0].axisValue)%60:Number(t[0].axisValue)%60,s=i+":"+a,o="<div class='tooltip-box' > <div class='tooltips-val'> <span class='tooltips-val-num'>"+t[0].value+"</span>"+l+"</div> <div class='tooltips-date'>"+e[t[0].axisIndex].day+" "+s+" </div> </div>";return t[0].value?o:""},extraCssText:"box-shadow: 0 2px 10px rgba(195,245,247,1);"},title:[],grid:[],xAxis:[],yAxis:[],visualMap:[],series:[]},e.forEach(((t,o)=>{"mg/dL"!=l&&(t.value=t.value.map((t=>r.e.mgdlToMmol(t))));let n=t.tir>70?"tir":"tirs";this.option.title.push({text:t.tir?["{date|"+t.day+"}{tirLable|TIR:}{"+n+"|"+t.tir+"%}"]:["{date|"+t.day+"}{tir|TIR:--}"],left:0==o?90:o<7&&o>0?o*(i+15)+90:o%7*(i+15)+90,top:o>=7?172*Math.floor(o/7):2,right:10,textStyle:{rich:{date:{fontSize:16,color:"#333",width:(i-10)/2-10,align:"left"},tirLable:{fontSize:20,width:30,color:"#333",align:"right"},tir:{fontSize:20,width:70,color:"#333",align:"left"},tirs:{fontSize:20,width:70,color:"#F43F31",align:"left"}}}}),this.option.grid.push({show:!1,left:0==o?90:o<7&&o>0?o*(i+15)+90:o%7*(i+15)+90,right:0,top:o>=7?170*Math.floor(o/7)+30:30,width:i,height:90,borderColor:"#666",borderWidth:1}),this.option.xAxis.push({type:"category",gridIndex:o,show:!0,axisLine:{show:!1},data:a,axisLabel:{formatter:function(i,a){return 0==a||o==e.length-1&&a==t.value.length-1||o%7==6&&a==t.value.length-1?"00:00":a==t.value.length/2-1?"12:00":void 0},interval:0,color:"var(--color-black-60)",fontSize:16,margin:15},axisTick:{show:!1}}),this.option.yAxis.push({type:"value",show:!1,gridIndex:o,min:0,max:"mg/dL"==l?r.e.mmolToMgdl(3*Math.ceil(s/3)):3*Math.ceil(s/3)}),this.option.visualMap.push({type:"piecewise",show:!1,pieces:[{gt:0,lt:"mg/dL"==this.unit?70:3.9,color:"var(--color-error)"},{gt:"mg/dL"==this.unit?180:10,color:"var(--color-warning"},{gt:"mg/dL"==this.unit?70:3.9,lt:"mg/dL"==this.unit?180:10,color:"var(--color-primary"}]}),this.option.series.push({type:"line",data:t.value,xAxisIndex:o,yAxisIndex:o,showSymbol:!(_.compact(t.value).length>1),symbolSize:1,symbol:"circle",emphasis:{disabled:!0},lineStyle:{width:1},markPoint:{symbol:"circle",symbolSize:1==_.compact(t.value).length?5:0,itemStyle:{color:"var(--color-primary)"},emphasis:{disabled:!0},data:[{coord:[_.indexOf(t.value,_.compact(t.value)[0]),_.compact(t.value)[0]]}]},markLine:{symbol:"none",data:[{yAxis:this.targetScope[0],lineStyle:{width:0},label:{show:o%7==0,position:"start",distance:14,fontSize:16,color:"#666"}},{yAxis:this.targetScope[1],lineStyle:{width:0},label:{show:o%7==0,position:"start",fontSize:16,distance:14,color:"#666"}}]},markArea:{data:[[{yAxis:"mg/dL"==this.unit?70:3.9},{yAxis:"mg/dL"==this.unit?180:10}]],itemStyle:{color:"rgba(50, 186, 192, 0.08)"}}})})),this.$nextTick((()=>{console.log((0,o.fU)(new Date),"每日血糖渲染完成")}))}},watch:{dataList:function(t,e){let i=t;this.getOption(i)}}},h=d,c=i(1656),g=(0,c.A)(h,a,s,!1,null,null,null),p=g.exports},6297:function(t,e,i){i.d(e,{A:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",{ref:"tir",staticClass:"TIR"},[e("canvas",{ref:"canvas",staticClass:"canvas",attrs:{id:"myCanvas"}}),e("div",{staticClass:"tir-info"},[e("div",{staticClass:"tir-key"},[t._l(t.tirList,(function(i){return e("div",{key:i.key},[0!=i.value?e("div",{ref:"tirInfo",refInFor:!0,staticClass:"tir-key-item",attrs:{"data-index":i.index}},[e("div",{staticClass:"tir-key-box"},[e("div",{ref:"legend",refInFor:!0,staticClass:"tir-key-legend",style:{backgroundColor:i.color},attrs:{"data-index":i.index}}),e("div",{staticClass:"tir-key-desc"},[e("div",{staticClass:"tir-key-key"},[t._v(t._s(i.key))]),e("div",{staticClass:"tir-key-range"},[t._v(t._s("mg/dL"==t.unit?i.descmg:i.desc))])])]),e("div",{staticClass:"tir-value"},[e("div",{staticClass:"tir-key-key"},[e("span",{class:[2==i.index?"active":"","tir-print-key"]},[t._v(t._s(i.value)+"%")]),t._v("("+t._s(i.duration[0])+"时"+t._s(i.duration[1])+"分)")]),(i.index,e("div",{staticClass:"tir-key-range"},[t._v("目标值＞"+t._s(i.target)+"%")]))])]):t._e()])})),0!=t.highTarget?e("div",{staticClass:"tir-all-1",style:{height:t.highTargetHeight+"px"}},[e("div",{staticClass:"tir-all-line"}),e("div",{staticClass:"tir-all-value"},[e("div",{staticClass:"tir-key-key"},[t._v(t._s(t.highTarget)+"%")]),e("div",{staticClass:"tir-key-range"},[t._v("目标值＜25%")])])]):t._e(),0!=t.lowTarget?e("div",{staticClass:"tir-all-2",style:{height:t.lowTargetHeight+"px"}},[e("div",{staticClass:"tir-all-line"}),e("div",{staticClass:"tir-all-value"},[e("div",{staticClass:"tir-key-key"},[t._v(t._s(t.lowTarget)+"%")]),e("div",{staticClass:"tir-key-range"},[t._v("目标值＜4%")])])]):t._e()],2)])])},s=[],l=i(2651),o=i(1910),r={name:"TIR",data(){return{levels:[{key:"血糖很高",value:1,duration:[],color:"#E98C41",desc:">13.9mmol/L",descmg:">250mg/dL",target:"5",index:0},{key:"血糖偏高",value:1,duration:[],color:"#F6C059",desc:"10.1-13.9mmol/L",descmg:"181-250mg/dL",target:"25",index:1},{key:"目标范围内",value:60,duration:[],color:"#32BAC0",desc:"3.9-10mmol/L",descmg:"70-180mg/dL",target:"70",index:2},{key:"血糖偏低",value:30,duration:[],color:"#F43F31",desc:"3.0~3.8mmol/L",descmg:"54-69mg/dL",target:"4",index:3},{key:"血糖很低",value:0,duration:[],color:"#96251C",desc:"<3.0mmol/L",descmg:"<54/dL",target:"1",index:4}],tirList:[],canvas:null,ctx:null,highTarget:0,lowTarget:0,highTargetHeight:0,lowTargetHeight:0}},props:{dataList:{type:Object}},created(){},computed:{...(0,o.L8)(["unit","targetScope"])},mounted(){this.renderData(this.dataList)},methods:{renderData(t){let e=_.clone(t);this.levels[0].value=_.round(Number(100*e.veryHighRate),1),this.levels[1].value=_.round(Number(100*e.highRate),1),this.levels[2].value=_.round(Number(100*e.normalRate),1),this.levels[3].value=_.round(Number(100*e.lowRate),1),this.levels[4].value=_.round(Number(100*e.veryLowRate),1),this.levels[0].duration=[Math.floor(e.veryHighDuration/60),e.veryHighDuration%60],this.levels[1].duration=[Math.floor(e.highDuration/60),e.highDuration%60],this.levels[2].duration=[Math.floor(e.normalDuration/60),e.normalDuration%60],this.levels[3].duration=[Math.floor(e.lowDuration/60),e.lowDuration%60],this.levels[4].duration=[Math.floor(e.veryLowDuration/60),e.veryLowDuration%60],this.levels[2].desc=this.targetScope[0]+"-"+this.targetScope[1]+"mmol/L",this.levels[2].descmg=this.targetScope[0]+"-"+this.targetScope[1]+"mg/dL",this.levels[1].desc=_.round(this.targetScope[1]+.1,1)+"-13.9mmol/L",this.levels[1].descmg=this.targetScope[1]+1+"-250mg/dL",this.levels[3].desc="3.0-"+_.round(this.targetScope[0]-.1,1)+"mmol/L",this.levels[3].descmg="54-"+(this.targetScope[0]-1)+"mg/dL",this.highTarget=this.levels[0].value&&this.levels[1].value?_.round(this.levels[0].value+this.levels[1].value,1):0,this.lowTarget=this.levels[3].value&&this.levels[4].value?_.round(this.levels[4].value+this.levels[4].value,1):0,this.tirList=_.filter(this.levels,(function(t){return t.value>0})),console.log(this.tirList),console.log((0,l.fU)(new Date),"TIR计算完成"),this.$nextTick((()=>{this.drawTir(),this.handelHeight()}))},handelHeight(){let t=_.sortBy(this.$refs.legend,["dataset.index"]);0!=this.highTarget&&(this.highTargetHeight=t[1].offsetTop-t[0].offsetTop),0!=this.lowTarget&&(this.lowTargetHeight=t[t.length-1].offsetTop-t[t.length-2].offsetTop)},drawTir(){const t=document.getElementById("myCanvas"),e=t.getContext("2d"),i=160,a=2*this.$refs.tir.offsetHeight;t.width=i,t.height=a,e.scale(2,2),e.clearRect(0,0,t.width,t.height);const s=40,o=1,r=s+5,n=30;let d=2,h=(this.$refs.tir.offsetTop,_.sortBy(this.$refs.legend,["dataset.index"])),c=1;for(var g=0;g<this.tirList.length;g++){let t=2.8*Number(this.tirList[g].value);e.fillStyle=this.tirList[g].color,e.fillRect(0,d,s,t);let i=null;h[g]&&(i=h[g].offsetTop+3);let a=0,l=0,p=0,m=0,v=0,u=0;i-d>10&&d+t-i>10?(a=r+n,l=i,p=a,m=l,v=a,u=l,c=1):(c++,a=i<d+t?r+n-(n-3*c):r+(n-3*c)-n/2,l=d+t/2,p=i<d+t?r+n-(n-3*c):r+(n-3*c)-n/2,m=i,v=r+n,u=i),0!=t&&(e.lineWidth="1",e.strokeStyle="#e5e5e5",e.beginPath(),e.moveTo(r,l),e.lineTo(a,l),e.lineTo(p,m),e.lineTo(v,u),e.stroke()),d=d+t+o}this.$nextTick((()=>{console.log((0,l.fU)(new Date),"TIR渲染完成")}))}},watch:{dataList:function(t,e){console.log(t);let i=t;this.renderData(i)}}},n=r,d=i(1656),h=(0,d.A)(n,a,s,!1,null,"13ad542b",null),c=h.exports}}]);
//# sourceMappingURL=789.d6f1bfb3.js.map