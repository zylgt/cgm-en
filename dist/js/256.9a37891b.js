"use strict";(self["webpackChunkCGM3"]=self["webpackChunkCGM3"]||[]).push([[256],{3256:function(t,e,i){i.r(e),i.d(e,{default:function(){return u}});var a=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"userinfo",attrs:{id:"old_userinfo"}},[e("div",{staticClass:"userinfo-title"},[t._m(0),e("div",{staticClass:"jump",on:{click:t.saveSubmit}},[t._v("跳过")])]),e("div",{staticClass:"tips"},[t._v("请填写您的健康信息，将为您制定个性化管理方案！")]),e("div",{staticClass:"step-box"},t._l(t.stepList,(function(i,a){return e("div",{key:a,class:[t.step>a?"active":"","step-item"]})})),0),e("div",{staticClass:"config"},[t.configs.length>t.step-1?e("div",t._l(t.configs,(function(a,s){return e("div",{key:a.config_key},[s+1==t.step?e("div",{staticClass:"config-title"},[t._v(t._s(a.config_name))]):t._e(),t._l(a.items,(function(a,n){return e("div",{key:a.item_key},[s+1==t.step?e("div",{staticClass:"config-item",on:{click:function(e){return t.changeConfig(s,n)}}},[e("div",{staticClass:"config-choose"},[a.checked?e("img",{staticClass:"choose-img",attrs:{src:i(1610),alt:""}}):e("img",{staticClass:"choose-img",attrs:{src:i(6264),alt:""}})]),e("div",{staticClass:"config-text"},[t._v(t._s(a.item_name))])]):t._e()])}))],2)})),0):e("div",{staticClass:"config-message"},[e("div",{staticClass:"config-title"},[t._v("基础信息")]),e("div",{staticClass:"message-box"},[e("el-form",{ref:"formData",attrs:{"label-width":"80px","label-position":"left",model:t.formData}},[e("el-form-item",{attrs:{label:"出生日期"}},[e("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","picker-options":t.pickerOptions,"default-value":t.defaultBirthday,"value-format":"yyyy-MM-dd"},model:{value:t.formData.birthdate,callback:function(e){t.$set(t.formData,"birthdate",e)},expression:"formData.birthdate"}})],1),e("el-form-item",{attrs:{label:"性别"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.gender,callback:function(e){t.$set(t.formData,"gender",e)},expression:"formData.gender"}},[e("el-option",{attrs:{label:"男",value:0}}),e("el-option",{attrs:{label:"女",value:1}})],1)],1),e("el-form-item",{attrs:{label:"身高"}},[e("el-input",{staticClass:"user-inp",model:{value:t.formData.height,callback:function(e){t.$set(t.formData,"height",e)},expression:"formData.height"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("cm")])])],1),e("el-form-item",{attrs:{label:"体重"}},[e("el-input",{staticClass:"user-inp",model:{value:t.formData.weight,callback:function(e){t.$set(t.formData,"weight",e)},expression:"formData.weight"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("kg")])])],1),t.diagnosisShow?e("el-form-item",{attrs:{label:"确诊日期"}},[e("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":t.diagnosisPickerOptions},model:{value:t.formData.diagnosis_date,callback:function(e){t.$set(t.formData,"diagnosis_date",e)},expression:"formData.diagnosis_date"}})],1):t._e()],1)],1)]),t.step>1?e("div",{staticClass:"config-btn"},[e("el-button",{attrs:{type:"info",round:""},on:{click:t.prevStep}},[t._v("上一步")]),t.step==t.configs.length+1?e("el-button",{attrs:{type:"primary",round:"",loading:t.loading},on:{click:t.saveSubmit}},[t._v("完成配置")]):e("el-button",{attrs:{type:"primary",round:"",loading:t.loading},on:{click:t.nextStep}},[t._v("下一步")])],1):t._e(),t.step<=1?e("div",{staticClass:"configs-btn"},[e("el-button",{attrs:{type:"primary",round:"",loading:t.loading},on:{click:t.nextStep}},[t._v("下一步")])],1):t._e()])])},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"userinfo-label"},[e("div",{staticClass:"userinf-diver"}),e("div",{staticClass:"userinfo-text"},[t._v("个人信息")])])}],n=(i(4114),i(9569)),o=i(5462),r=i(6265),l={data(){return{stepList:[],step:1,configs:[],loading:!1,pageLoading:!0,formData:{diabetes_type:null,treatment_regimen:[],comorbidities:[],complications:[],birthdate:null,weight:null,height:null,gender:null,diagnosis_date:null,nickname:(0,r.A)(o.A.get("username")),avatar:null},defaultBirthday:(new Date).setFullYear((new Date).getFullYear()-40),pickerOptions:{disabledDate(t){return t.getTime()>(new Date).setFullYear((new Date).getFullYear()-4)||t.getTime()<new Date("1900-01-01")}},diagnosisPickerOptions:{disabledDate(t){return t.getTime()<new Date("1900-01-01")||t.getTime()>new Date}}}},computed:{diagnosisShow(){return this.formData.diabetes_type&&0!=this.formData.diabetes_type}},created(){this.getConfig()},methods:{getConfig(){(0,n.Qx)({}).then((t=>{1e3==t.code?(this.stepList=t.data.length+1,this.configs=t.data,this.getInfo()):this.$message({type:"error",message:t.msg})})).catch((t=>{console.log(t)}))},changeConfig(t,e){let i=this.configs[t].items[e];this.formData;if("diabetes_type"==this.configs[t].config_key||0==i.item_key)this.configs[t].items.forEach((t=>{t.checked=!1})),i.checked=!0,"diabetes_type"==this.configs[t].config_key?this.formData.diabetes_type=i.item_key:this.formData[this.configs[t].config_key]=[0];else{i.checked=!i.checked,this.configs[t].items.forEach((t=>{0==t.item_key&&(t.checked=!1)}));let e=this.configs[t].items.filter((t=>t.checked)),a=[];e.forEach((t=>{a.push(t.item_key)})),this.formData[this.configs[t].config_key]=a}this.$set(this.configs[t].items,e,i)},nextStep(){this.step<this.configs.length+1&&(this.step+=1),this.saveSubmit()},prevStep(){this.step>=1&&(this.step-=1)},saveSubmit(){this.loading=!0,this.formData.height=this.formData.height?Number(this.formData.height):null,this.formData.weight=this.formData.weight?Number(this.formData.weight):null,this.formData.gender=this.formData.gender?Number(this.formData.gender):null,(0,n.M5)(this.formData).then((t=>{this.loading=!1,1e3==t.code||this.$message({type:"error",message:t.msg})})).catch((t=>{console.log(t)}))},getInfo(){let t=this.configs;(0,n.Vp)().then((e=>{this.pageLoading=!1,1e3==e.code?(this.formData=e.data,t.forEach(((t,i)=>{t.items.forEach((i=>{"diabetes_type"==t.config_key?i.item_key==e.data[t.config_key]&&(i.checked=!0):e.data[t.config_key].length>0&&e.data[t.config_key].forEach((t=>{t==i.item_key&&(i.checked=!0)}))})),this.$set(this.configs,i,t)}))):this.$message({type:"error",message:e.msg})})).catch((t=>{this.pageLoading=!1,console.log(t)}))}}},c=l,d=i(1656),f=(0,d.A)(c,a,s,!1,null,"03d252d1",null),u=f.exports},9569:function(t,e,i){i.d(e,{GQ:function(){return n},M5:function(){return g},Qx:function(){return u},TB:function(){return f},Vp:function(){return m},_E:function(){return l},_d:function(){return o},ct:function(){return s},fR:function(){return r},wO:function(){return c},xw:function(){return d}});var a=i(4751);function s(t){return(0,a.A)({url:"/webuser/login/account",method:"POST",data:t})}function n(t){return(0,a.A)({url:"/webuser/login/phone",method:"POST",data:t})}function o(t){return(0,a.A)({url:"/webuser/regist/phone",method:"POST",data:t})}function r(t){return(0,a.A)({url:"/user/sendsmscode",method:"POST",data:t})}function l(t){return(0,a.A)({url:"/user/verifysmscode",method:"POST",data:t})}function c(t){return(0,a.A)({url:"/user/changepassword",method:"POST",data:t})}function d(t){return(0,a.A)({url:"/user/resetpassword",method:"POST",data:t})}function f(t){return(0,a.A)({url:"/protocol/last",method:"POST",data:t})}function u(t){return(0,a.A)({url:"/user/profile/configs",method:"POST",data:t})}function g(t){return(0,a.A)({url:"/user/profile/save",method:"POST",data:t})}function m(t){return(0,a.A)({url:"/user/profile/get",method:"POST",data:t})}},6265:function(t,e){function i(t){return t.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")}e.A=i},6264:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAUCAYAAABiS3YzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADTSURBVHgBrZUJDoMwDAQ3BIR6/P+nPWgLqRfZKK0IlzzSqvfENYkJKBMljaSWVJIgSZJe85IMcz8MM+9RcFLZGhQ/dbGilNVdML9YCVZ7Q1Z1/BNedwqtMLbpA6240g/4eMZxrGXTC9Jmz49SaybRlouyhdaktmU8oCtQFuFLpNSrSiN4C0coHeBLorSHL71JE3wYT1Wlwg4+cMBMV744xnbw1vzsUbaBg2HvQIEW9IC2MZemg+LF0Wdf4F/YetLYtjtWhnQOz3Gjclsgv510KOyaL+goLybr/6pLAAAAAElFTkSuQmCC"},1610:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIFSURBVHgBtZW/UxNREMe/+4KjODBzWikZmaOyJAP25AqHsbCwxEYqKeU/IPwHWmoFDZQWFI5jcdAncLQ0nghRGwyTABlI7rF7w80k716O8Os7k+zdvt1P9t7b2xB6qPDVd9QQZhHRlCYUCHDFr4GQTUjQy1Eb68ErL7Tlkx2oPjBinikOLhNRafPl1GImuPDNd1WOfFxUdwWFUVt7ndXTLUCtcJV4bwgVxYXJVsrNgHxN/NhYgNauGTl8bwBvR/OYfOTEH9FOvYGV3T2sVf/Z4Q8xz7ZEF1vw04wYGXyAL5PjeMrWpupJE3OV7dgaqkVHekypHIq2xCxo8sOfOUaeypCjBjGrNOidufJ65EkmtBM+8yyf8nOvFxVZDmxmNI9+9eJxutVJ0bh0hWsuPB8eQr9KDtWQq3BHEnBoOiv/a+hXO42GzR0qfvcC01s+6B+88ms/5dMxuK03zIXV3X38aTZxmaocs1b9mwa39bKK7mOJr7tKrLdaeF/ezoQLdI5jemg9HkIT3/0Sj78FW4T0tLRf0ill3v/KwSFWf++hftZKJ2i9uDntlWJwwfcdOqUtohsNIWYi3Joujsl13G6B59V0pD1ZwDUlucJI7lODnt8a/6qVJ1DroO9U1p53AfnQSetP0TE+Bm+8rgagXklSPZsi5eIh5Xb+mfITBZG06QmWTGCicz80zzxVqvYSAAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=256.9a37891b.js.map