"use strict";(self["webpackChunkCGM3"]=self["webpackChunkCGM3"]||[]).push([[831],{3866:function(t,e,a){a.r(e),a.d(e,{default:function(){return x}});var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"agp-top"},[e("div",{staticClass:"agp-top-fl"},[e("div",{staticClass:"report-title"},[t._v(" "+t._s(t.$t("message.route."+t.$route.meta.title)))])]),e("div",{staticClass:"agp-fr"},[e("img",{staticClass:"agp-icon",attrs:{src:a(2620),alt:""},on:{click:t.print}}),e("img",{staticClass:"agp-icon",attrs:{src:a(3682),alt:""},on:{click:t.handleExport}}),e("img",{staticClass:"agp-icon agp-fr-icon",attrs:{src:a(7821),alt:""}}),e("el-button",{attrs:{type:"primary"},on:{click:t.upload}},[e("img",{staticClass:"btn-upload",attrs:{src:a(5108),alt:""}}),t._v(" 上传数据 ")])],1)]),e("div",{staticClass:"report-agp-date"},[e("img",{staticClass:"agp-icon",attrs:{src:a(947),alt:""}}),e("div",{staticClass:"agp-date"},[t._v(t._s(t.agpDate[0])+" — "+t._s(t.agpDate[1])+"（"+t._s(t.dayDate)+"天）")]),e("img",{staticClass:"select-icon",attrs:{src:a(4137),alt:""}}),e("el-date-picker",{staticClass:"agp-picker",attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd","picker-options":t.pickerOptions},on:{change:t.changeDate},model:{value:t.agpDate,callback:function(e){t.agpDate=e},expression:"agpDate"}})],1),t.progressShow?e("Progress",{attrs:{percentage:t.downProgress}}):e("div",[e("Empty",{directives:[{name:"show",rawName:"v-show",value:t.empty,expression:"empty"}],staticStyle:{height:"600px"}}),t._l(t.list,(function(i,s){return e("div",{directives:[{name:"show",rawName:"v-show",value:!t.empty,expression:"!empty"}],key:s,staticClass:"week-bg-main"},[e("div",{staticClass:"week-bg-title"},[e("div",{staticClass:"week-bg-date"},[t._v(t._s(i.day[0])+" - "+t._s(i.day[i.day.length-1]))]),e("img",{staticClass:"reason-icon",attrs:{src:a(8082),alt:""}})]),e("Empty",{directives:[{name:"show",rawName:"v-show",value:!i.info,expression:"!item.info"}],staticStyle:{height:"500px"}}),e("WeekAnalysis",{directives:[{name:"show",rawName:"v-show",value:i.info,expression:"item.info"}],attrs:{dataList:i}})],1)}))],2),e("el-dialog",{attrs:{visible:t.dialogVisible,"show-close":!1,title:"print"==t.dialogType?"打印报告":"下载报告",width:"1060"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"slot-popover",attrs:{id:"popover"}},[e("div",{staticClass:"slot-popover-cont slot-popover-conts"},[e("div",{staticClass:"report-agp-date report-agp-dates"},[e("img",{staticClass:"agp-icon",attrs:{src:a(947),alt:""}}),e("div",{staticClass:"agp-date"},[t._v(t._s(t.agpDate[0])+" — "+t._s(t.agpDate[1])+"（4天）")]),e("img",{staticClass:"select-icon",attrs:{src:a(4137),alt:""}}),e("el-date-picker",{staticClass:"agp-picker",attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd","picker-options":t.pickerOptions},on:{change:t.changeDate},model:{value:t.agpDate,callback:function(e){t.agpDate=e},expression:"agpDate"}})],1),e("div",{staticClass:"popover-cont-label"},["print"==t.dialogType?e("div",{staticClass:"popover-cont-label-label"},[t._v("请选择您想要打印的报告内容：")]):e("div",{staticClass:"popover-cont-label-label"},[t._v("请选择您想要下载的报告内容：")]),e("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")])],1),e("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.checkedDowns,callback:function(e){t.checkedDowns=e},expression:"checkedDowns"}},t._l(t.downloadList,(function(a){return e("el-checkbox",{key:a,attrs:{label:a}},[t._v(t._s(a))])})),1)],1),e("div",{staticClass:"slot-popover-btn"},["print"==t.dialogType?e("el-button",{attrs:{type:"primary"}},[t._v("打印报告")]):e("el-button",{attrs:{type:"primary"}},[t._v("下载报告")])],1)]),e("img",{staticClass:"dialog-close",attrs:{src:a(2564),alt:""},on:{click:function(e){t.dialogVisible=!1}}})])],1)},s=[],o=(a(4114),a(1370)),l=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"chart-box"},[e("div",{staticClass:"analysis-info"},[e("div",{staticClass:"analysis-info-item"},[e("div",{staticClass:"analysis-info-label"},[t._v("目标范围内占比")]),e("div",{class:[t.dayInfo.tir<70?"active":"","analysis-info-value"]},[t._v(t._s(t.dayInfo.tir)+"%")])]),e("div",{staticClass:"analysis-info-item"},[e("div",{staticClass:"analysis-info-label"},[t._v("平均葡萄糖值")]),"mg/dL"==t.unit?e("div",{class:[t.dayInfo.mean>118.8?"active":"","analysis-info-value"]},[t._v(t._s(t.dayInfo.mean)+" mg/dL ")]):e("div",{class:[t.dayInfo.mean>6.6?"active":"","analysis-info-value"]},[t._v(t._s(t.dayInfo.mean)+" mmol/L ")])]),e("div",{staticClass:"analysis-info-item"},[e("div",{staticClass:"analysis-info-label"},[t._v("预估HbA1c（GMI）")]),e("div",{class:[t.dayInfo.GMI>7?"active":"","analysis-info-value"]},[t._v(t._s(t.dayInfo.GMI)+"%")])]),e("div",{staticClass:"analysis-info-item"},[e("div",{staticClass:"analysis-info-label"},[t._v("变异系数（CV）")]),e("div",{class:[t.dayInfo.CV>33?"active":"","analysis-info-value"]},[t._v(t._s(t.dayInfo.CV)+"%")])])]),e("div",{staticClass:"t-chart"},[e("t-chart",{ref:"chart",staticStyle:{width:"100%",height:"450px"},attrs:{option:t.option,"init-options":t.initOptions,theme:"tduck-echarts-theme"}}),t.tooltipShow?e("div",{staticClass:"tooltip-box",style:{left:t.tooltipLeft+"px",top:t.tooltipTop+"px"}},[e("div",{staticClass:"tooltips-val"},[e("span",{staticClass:"tooltips-val-num"},[t._v(t._s(t.tooltipValue))]),t._v(t._s(t.unit)+" ")]),e("div",{staticClass:"tooltips-date"},[t._v(" "+t._s(t.tooltipDay)+" "+t._s(t.tooltipMoment)+" ")])]):t._e(),e("div",{staticClass:"date-box",attrs:{id:"dayAnalysis"}},[e("div",{staticClass:"date-item"},t._l(t.chartDate,(function(a,i){return e("div",{key:i,class:[a.diabled?"disDay":a.checked?"checkDay"+i:"noCheckDay","chart-day"],on:{click:function(e){return t.checkChart(i)}}},[t._v(t._s(a.day))])})),0),e("el-checkbox",{on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")])],1)],1)])])},n=[],r=a(65),c=a(1910),d=a(2523),p={data(){return{initOptions:{renderer:"svg"},option:{grid:[{left:60,right:30,top:10,bottom:50}],xAxis:[{type:"category",gridIndex:0,boundaryGap:!1,axisTick:!1,splitLine:{show:!1,lineStyle:{color:"var(--color-black-60)"},interval:59},axisLine:{show:!0,lineStyle:{color:"var(--color-black-60)",width:1}},data:[],axisLabel:{formatter:function(t,e){if(e%360===0){let e=Math.floor(t/60)<10?"0"+Math.floor(t/60):Math.floor(t/60),a=t%60<10?"0"+t%60:t%60,i=e+":"+a;return i}if(e+1===1440)return"00:00"},interval:0,color:"var(--color-black-60)",fontSize:20,margin:20}}],yAxis:[{type:"value",gridIndex:0,min:0,max:15,splitLine:{lineStyle:{color:"var(--color-black-60)"}},axisLabel:{formatter:"{value}",color:"var(--color-black-60)",fontSize:20,margin:14}}],series:[{type:"line",data:[],z:9,itemStyle:{color:"var(--color-primary)",opacity:0},showSymbol:!(_.compact(this.dataList.value).length>1),symbolSize:1,symbol:"circle",emphasis:{focus:"series",scale:!1},lineStyle:{width:3,opacity:1},animation:!1,triggerLineEvent:!0,markLine:{silent:!0,symbol:"none",animation:!1,data:[{type:"min",yAxis:3.9,lineStyle:{color:"var(--color-error)",width:2,type:"solid"},label:{color:"var(--color-error)",fontSize:20,distance:14,position:"start"}},{type:"max",yAxis:10,lineStyle:{color:"var(--color-warning)",width:2,type:"solid"},label:{color:"var(--color-warning)",fontSize:20,distance:14,position:"start"}}]},markArea:{silent:!0,data:[[{yAxis:3.9},{yAxis:10}]],itemStyle:{color:"rgba(72, 160, 220, 0.05)"}}}]},dayInfo:"",color:["#E5B769","#D191E1","#83B1E9","#D7796E","#B5D87F","#E9EB5C","#32BAC0"],checkAll:!0,chartDate:[],tooltipValue:0,tooltipDay:null,tooltipMoment:null,tooltipLeft:0,tooltipTop:0,tooltipShow:!1}},props:{dataList:{type:Object}},components:{TChart:r.A},computed:{...(0,c.L8)(["unit","targetScope"])},mounted(){this.handelOption(this.dataList),this.chartMouse()},methods:{handelOption(t){this.$refs.chart.clear(),this.option.series=[this.option.series[0]],this.option.series[0].lineStyle={opacity:1,width:3},this.checkAll=!0;let e=_.cloneDeep(t),a=this.unit;this.dayInfo=e,e.info&&(e.info.mean=Math.round(e.info.mean),this.dayInfo.mean="mg/dL"==a?e.info.mean:d.e.mgdlToMmol(e.info.mean),this.dayInfo.GMI=e.info.GMI,this.dayInfo.CV=e.info.CV);let i=Array.from({length:1440},((t,e)=>e)),s=d.e.mgdlToMmol(e.max)<13.9?13.9:d.e.mgdlToMmol(e.max),o=[],l=this.color;e.value.forEach(((t,n)=>{o.push({day:e.day[n],checked:!0,diabled:!(_.compact(t).length>1),color:l[n]}),"mg/dL"!=a&&(t=t.map((t=>d.e.mgdlToMmol(t)))),0==n?(this.option.xAxis[0].data=i,this.option.yAxis[0].max="mg/dL"==a?d.e.mmolToMgdl(3*Math.ceil(s/3)):3*Math.ceil(s/3),this.option.series[0].data=t,this.option.series[0].markLine.data[0].yAxis=this.targetScope[0],this.option.series[0].markLine.data[1].yAxis=this.targetScope[1],this.option.series[0].markArea.data[0][0].yAxis=this.targetScope[0],this.option.series[0].markArea.data[0][1].yAxis=this.targetScope[1],this.option.series[0].itemStyle={color:l[0]}):this.option.series.push({type:"line",data:t,z:9,itemStyle:{color:l[n],opacity:0},emphasis:{focus:"series",scale:!1},triggerLineEvent:!0,showSymbol:!(_.compact(t).length>1),symbolSize:1,symbol:"circle",lineStyle:{width:3,opacity:1},animation:!1})})),this.chartDate=o},checkChart(t){let e=this.chartDate;e[t].disabled||(e[t].checked=!e[t].checked,this.option.series[t].lineStyle={opacity:e[t].checked?1:0}),this.checkAll=_.every(e,"checked")},handleCheckAllChange(t){let e=this.chartDate;e.forEach((e=>e.checked=t)),this.option.series.forEach((e=>{e.lineStyle={opacity:t?1:0}}))},chartMouse(){let t=this.$refs.chart.chart;t.on("mousemove",(e=>{let a=[e.event.offsetX,e.event.offsetY],i=t.convertFromPixel({seriesIndex:e.seriesIndex},a),s=i[0],o=Math.floor(Number(s)/60)<10?"0"+Math.floor(Number(s)/60):Math.floor(Number(s)/60),l=Number(s)%60<10?"0"+Number(s)%60:Number(s)%60,n=o+":"+l;this.tooltipShow=!0,this.tooltipMoment=n,this.tooltipDay=_.words(this.chartDate[e.seriesIndex].day,/[^月|日 ]+/g).join("."),this.tooltipValue=this.option.series[e.seriesIndex].data[s],this.tooltipLeft=e.event.offsetX,this.tooltipTop=e.event.offsetY})),t.on("mouseout",(t=>{this.tooltipShow=!1}))}},watch:{dataList(t,e){this.handelOption(t)}}},h=p,m=a(1656),y=(0,m.A)(h,l,n,!1,null,"4c92036c",null),v=y.exports,u=a(2651),g=a(2216),f=a(1853),k={data(){return{list:[]}},mixins:[f.A],components:{WeekAnalysis:v,Empty:o.A},mounted(){},methods:{handelTemplateDay(t){let e=_.reverse(_.cloneDeep(t)),a=this.dayDate<7?24*this.dayDate*60:10080,i=_.chunk(e,a),s=_.maxBy(e,"Value").Value>400?400:_.maxBy(e,"Value").Value,o="mmol/L"==this.unit?[_.round(d.e.mmolToMgdl(this.targetScope[0]),1),_.round(d.e.mmolToMgdl(this.targetScope[1]),1)]:this.targetScope,l=new Array;function n(t){return(0,u.Yq)(1e3*t.DataTs,"mm月dd日")}i.forEach((t=>{let e=_.map(t,"Value"),a=_.flatten(e),i=_.compact(a),r=_.map(t,n);l.push({day:_.uniq(r),week:(0,u.Yq)(1e3*t[0].DataTs,"WW"),value:_.chunk(e,1440),max:s,tir:g.x.getTIRResult(i,o[1],o[0])?(100*Number(g.x.getTIRResult(i,o[1],o[0]).normalRate)).toFixed(1):"",info:d.e.calculateMeanCvGmi(i)})})),console.log(l),this.list=l},addWeek(t){let e=_.reverse(_.clone(t)),a=_.chunk(e,7),i=[];function s(t){return(0,u.Yq)(t.day,"mm月dd日")}a.forEach((t=>{let e=_.map(t,"value"),a=_.flatten(e),o=_.compact(a),l=_.max(o)>400?400:_.max(o);i.push({day:_.map(t,s),value:e,max:l,tir:g.x.getTIRResult(o)?(100*Number(g.x.getTIRResult(o).normalRate)).toFixed(1):"",info:d.e.calculateMeanCvGmi(o)})})),console.log(i,"newarr")}}},C=k,b=(0,m.A)(C,i,s,!1,null,"a3587a90",null),x=b.exports}}]);
//# sourceMappingURL=831.10303790.js.map